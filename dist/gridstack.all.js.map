{"version":3,"sources":["webpack://GridStack/webpack/universalModuleDefinition","webpack://GridStack/webpack/bootstrap","webpack://GridStack/./src/utils.ts","webpack://GridStack/external \"jQuery\"","webpack://GridStack/./src/gridstack-dd.ts","webpack://GridStack/./src/gridstack-engine.ts","webpack://GridStack/./src/jq/gridstack-dd-jqueryui.ts","webpack://GridStack/./src/jq/jquery-ui.js","webpack://GridStack/./src/gridstack.ts"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__1__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","obsolete","self","f","oldName","newName","rev","wrapper","console","warn","apply","args","obsoleteOpts","opts","undefined","obsoleteOptsDel","info","obsoleteAttr","el","oldAttr","getAttribute","setAttribute","isIntercepted","a","b","x","width","y","height","sort","nodes","dir","column","widths","map","Math","max","createStylesheet","id","parent","style","document","createElement","styleSheet","cssText","appendChild","createTextNode","insertBefore","firstChild","getElementsByTagName","sheet","removeStylesheet","querySelector","parentNode","removeChild","addCSSRule","selector","rules","addRule","insertRule","toBool","v","toLowerCase","Boolean","toNumber","length","Number","parseHeight","val","heightUnit","match","Error","parseFloat","unit","defaults","target","sources","forEach","source","clone","closestByClass","parentElement","classList","contains","Utils","throttle","callback","delay","isWaiting","setTimeout","removePositioningStyles","position","removeProperty","left","top","getScrollParent","scrollHeight","clientHeight","this","updateScrollPosition","distance","rect","getBoundingClientRect","innerHeightOrClientHeight","innerHeight","documentElement","bottom","offsetDiffDown","offsetDiffUp","scrollEl","prevScroll","scrollTop","offsetHeight","abs","grid","registerPlugin","pluginClass","GridStackDD","registeredPlugins","push","remove","draggable","resizable","gridstackNode","_initDD","dragIn","isDraggable","droppable","isDroppable","on","eventName","off","onchange","float","maxRow","addedNodes","removedNodes","getGridHeight","GridStackEngine","getRow","_float","batchUpdate","batchMode","_prevFloat","commit","_packNodes","_notify","_fixCollisions","node","_sortNodes","nn","hasLocked","find","locked","collisionNode","moveNode","isAreaEmpty","compact","copyNodes","noMove","autoPosition","addNode","_dirty","_updating","_packY","newY","box","slice","bn","canBeMoved","prepareNode","resizing","_id","_idSeq","noResize","isNaN","maxWidth","min","maxHeight","minWidth","minHeight","getDirtyNodes","verify","_origY","_origX","_origW","_origH","filter","removeDOM","dirtyNodes","Array","isArray","concat","cleanNodes","triggerAddEvent","floor","removeNode","triggerEvent","splice","findIndex","removeAll","_layouts","canMoveNode","isNodeChangedPosition","clonedNode","canMove","canBePlacedWithRespectToHeight","noPack","_lastTriedX","_lastTriedY","_lastTriedWidth","_lastTriedHeight","reduce","memo","beginUpdate","endUpdate","save","saveElement","widgets","w","layoutsNodesChange","_ignoreLayoutsNodeChange","layout","ratio","round","updateNodeWidths","oldColumn","copy","cacheNodes","lastIndex","cacheNode","j","newNodes","saveInitial","cleanupNode","prop","$el","data","handles","start","stop","resize","containment","_isNested","dragOut","drag","accept","_accept","event","ui","helper","GridStackDDJQueryUI","$","version","orig","widgetUuid","widgetSlice","cleanData","elems","events","elem","_data","triggerHandler","e","widget","base","existingConstructor","constructor","basePrototype","proxiedPrototype","namespace","split","fullName","Widget","extend","expr","options","element","_createWidget","arguments","_proto","_childConstructors","each","isFunction","_super","_superApply","returnValue","__super","__superApply","widgetEventPrefix","widgetName","widgetFullName","child","childPrototype","bridge","input","inputIndex","inputLength","isPlainObject","fn","isMethodCall","methodValue","instance","charAt","jquery","pushStack","error","option","_init","defaultElement","classes","disabled","uuid","eventNamespace","bindings","hoverable","focusable","classesElementLookup","_on","destroy","ownerDocument","defaultView","parentWindow","_getCreateOptions","_create","_setOptionDisabled","_trigger","_getCreateEventData","noop","that","_destroy","_removeClass","removeData","removeAttr","parts","curOption","shift","pop","_setOptions","_setOption","_setOptionClasses","classKey","elements","currentElements","addClass","_classes","keys","add","_toggleClass","enable","disable","full","processClassString","checkOption","current","unique","not","extra","join","_untrackClassesElement","inArray","_addClass","toggleClass","suppressDisabledCheck","handlers","delegateElement","handler","handlerProxy","hasClass","guid","_off","_delay","_hoverable","mouseenter","currentTarget","mouseleave","_focusable","focusin","focusout","type","Event","originalEvent","trigger","isDefaultPrevented","show","hide","method","defaultEffect","hasOptions","effect","effectName","duration","isEmptyObject","complete","effects","easing","queue","next","createPseudo","dataName","disableSelection","eventType","preventDefault","enableSelection","scrollParent","includeHidden","css","excludeStaticParent","overflowRegex","parents","test","eq","ie","exec","navigator","userAgent","mouseHandled","cancel","_mouseInit","_mouseDown","stopImmediatePropagation","started","_mouseDestroy","_mouseMoveDelegate","_mouseUpDelegate","_mouseMoved","_mouseStarted","_mouseUp","_mouseDownEvent","btnIsLeft","which","elIsCancel","nodeName","closest","_mouseCapture","mouseDelayMet","_mouseDelayTimer","_mouseDistanceMet","_mouseDelayMet","_mouseStart","_mouseMove","documentMode","button","altKey","ctrlKey","metaKey","shiftKey","ignoreMissingWhich","_mouseDrag","_mouseStop","clearTimeout","pageX","pageY","plugin","set","proto","plugins","allowDisconnected","nodeType","safeActiveElement","activeElement","body","safeBlur","mouse","addClasses","appendTo","axis","connectToSortable","cursor","cursorAt","handle","iframeFix","opacity","refreshPositions","revert","revertDuration","scope","scroll","scrollSensitivity","scrollSpeed","snap","snapMode","snapTolerance","stack","zIndex","_setPositionRelative","_setHandleClassName","_removeHandleClassName","is","destroyOnClear","_getHandle","_blurActiveElement","_blockFrames","iframeBlocks","iframe","outerWidth","outerHeight","offset","_unblockFrames","_createHelper","_cacheHelperProportions","ddmanager","_cacheMargins","cssPosition","offsetParent","hasFixedAncestor","positionAbs","_refreshOffsets","originalPosition","_generatePosition","originalPageX","originalPageY","_adjustOffsetFromHelper","_setContainment","_clear","dropBehaviour","prepareOffsets","dragStart","margins","_getParentOffset","relative","_getRelativeOffset","click","noPropagation","_convertPositionTo","_uiHash","dropped","drop","animate","parseInt","dragStop","handleElement","helperIsFunction","obj","helperProportions","right","_isRootNode","tagName","po","scrollLeft","scrollIsRootNode","isUserScrollable","ce","relativeContainer","scrollWidth","offsetWidth","pos","mod","constrainPosition","co","cancelHelperRemoval","uiSortable","item","sortables","sortable","isOver","_storedCSS","placeholder","_helper","innermostIntersecting","_intersectsWith","containerCache","_parent","currentItem","fromOutside","_revert","_cursor","_opacity","scrollParentNotHidden","overflowOffset","scrolled","snapElements","String","items","$t","$o","inst","ts","bs","ls","rs","first","x1","x2","y1","y2","snapping","release","snapItem","group","makeArray","_zIndex","greedy","tolerance","activate","deactivate","out","over","proportions","isover","isout","_addToManager","droppables","_splice","_activate","_addActiveClass","_deactivate","_removeActiveClass","_over","_addHoverClass","_out","_removeHoverClass","_drop","custom","childrenIntersection","intersect","isOverAxis","reference","size","toleranceMode","absolute","list","addBack","droppablesLoop","visible","parentsUntil","greedyChild","parentInstance","intersects","uiBackCompat","hoverClass","activeClass","removeClass","alsoResize","animateDuration","animateEasing","aspectRatio","autoHide","ghost","_num","_isNumber","_hasScroll","has","_aspectRatio","originalElement","_proportionallyResizeElements","wrap","elementIsWrapper","marginTop","marginRight","marginBottom","marginLeft","originalResizeStyle","zoom","display","_proportionallyResize","_setupHandles","_handles","exp","insertAfter","_removeHandles","hname","se","sw","ne","nw","trim","append","_renderAxis","padPos","padWrapper","children","className","capture","curleft","curtop","_renderProxy","originalSize","sizeDiff","originalMousePosition","_propagate","props","smp","dx","dy","_change","_updatePrevProperties","_updateVirtualBoundaries","_updateRatio","_respectSize","_updateCache","_applyChanges","pr","ista","soffseth","soffsetw","prevPosition","prevSize","forceAspectRatio","pMinWidth","pMaxWidth","pMinHeight","pMaxHeight","Infinity","_vBoundaries","cpos","csize","ismaxw","ismaxh","isminw","isminh","dw","dh","cw","ch","_getPaddingPlusBorderDimensions","borders","paddings","prel","outerDimensions","elementOffset","cs","step","oc","containerElement","containerOffset","containerPosition","parentData","containerSize","innerWidth","woset","hoset","isParent","isOffsetRelative","cp","pRatio","cop","continueResize","ho","h","os","op","delta","sum","margin","gridX","gridY","ox","oy","newWidth","newHeight","isMaxWidth","isMaxHeight","isMinWidth","isMinHeight","jQuery","_gsEventHandler","setGridWidth","GridStack","setColumn","row","minRow","rowAttr","itemClass","placeholderClass","placeholderText","handleClass","styleInHead","cellHeight","auto","staticGrid","_class","random","toFixed","alwaysShowResizeHandle","dragInOptions","disableDrag","disableResize","rtl","removable","removableOptions","removeTimeout","marginUnit","cellHeightUnit","disableOneColumnMode","oneColumnModeDomSort","initMargin","ddPlugin","dd","direction","_isAutoCellHeight","marginDiff","cellWidth","_setStaticClass","_updateStyles","engine","cbNodes","_writeAttrs","getGridItems","_prepareElement","setAnimation","placeholderChild","innerHTML","_updateContainerHeight","onParentResize","_setupDragIn","_setupRemoveDrop","_setupAcceptWidget","_updateWindowResizeEvent","init","elOrString","getGridElement","gridstack","initAll","grids","getGridElements","addWidget","els","opt","isGridStackWidget","content","doc","implementation","createHTMLDocument","domAttr","_readAttr","_writeAttr","makeWidget","saveContent","sub","load","addAndRemove","removed","removeWidget","update","getCellHeight","forcePixel","_resizeNestedGrids","_triggerRemoveEvent","_triggerAddEvent","_triggerChangeEvent","doNotPropagate","_prevColumn","domNodes","getColumn","from","matches","setStatic","_removeStylesheet","enableMove","enableResize","_triggerEvent","doEnable","includeNewWidgets","movable","getFloat","getCellFromPixel","useDocRelative","containerPos","offsetTop","offsetLeft","relativeLeft","relativeTop","columnWidth","rowHeight","getElements","removeAttribute","getElement","_updateAttr","_prepareDragDropByNode","move","_updateElement","indexOf","noData","detail","addEventListener","log","removeEventListener","doAnimate","getMargin","willItFit","skipLayoutChange","CustomEvent","bubbles","dispatchEvent","_styles","forceUpdate","prefix","styleLocation","_max","getHeight","rows","cssMinHeight","getComputedStyle","_setupRemovingTimeout","_removeTimeout","_isAboutToRemove","_clearRemovingTimeout","onStartMoving","_beforeDragX","_beforeDragY","_prevYPix","dragOrResize","dataset","inTrashZone","_added","_temporaryRemoved","onEndMoving","gridToNotify","querySelectorAll","resizeHandles","clientWidth","_oneColumnMode","forceRemove","workTodo","_windowResizeBind","trashZone","acceptWidgets","onDrag","newNode","_temporary","_isOutOfGrid","_gridstackNodeOrig","origNode","oGrid","cloneNode","attr","field","Engine"],"mappings":"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","file":"gridstack.all.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jQuery\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jQuery\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GridStack\"] = factory(require(\"jQuery\"));\n\telse\n\t\troot[\"GridStack\"] = factory(root[\"jQuery\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__1__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","// utils.ts 2.0.2 @preserve\r\n\r\n/**\r\n * https://gridstackjs.com/\r\n * (c) 2014-2020 Alain Dumesny, Dylan Weiss, Pavel Reznikov\r\n * gridstack.js may be freely distributed under the MIT license.\r\n*/\r\n\r\nimport { GridStackWidget, GridStackNode, GridStackOptions, numberOrString } from './types';\r\n\r\nexport interface HeightData {\r\n  height: number;\r\n  unit: string;\r\n}\r\n\r\n/** checks for obsolete method names */\r\nexport function obsolete(self, f, oldName: string, newName: string, rev: string) {\r\n  let wrapper = (...args) => {\r\n    console.warn('gridstack.js: Function `' + oldName + '` is deprecated in ' + rev + ' and has been replaced ' +\r\n    'with `' + newName + '`. It will be **completely** removed in v1.0');\r\n    return f.apply(self, args);\r\n  }\r\n  wrapper.prototype = f.prototype;\r\n  return wrapper;\r\n}\r\n\r\n/** checks for obsolete grid options (can be used for any fields, but msg is about options) */\r\nexport function obsoleteOpts(opts: GridStackOptions, oldName: string, newName: string, rev: string) {\r\n  if (opts[oldName] !== undefined) {\r\n    opts[newName] = opts[oldName];\r\n    console.warn('gridstack.js: Option `' + oldName + '` is deprecated in ' + rev + ' and has been replaced with `' +\r\n      newName + '`. It will be **completely** removed in v1.0');\r\n  }\r\n}\r\n\r\n/** checks for obsolete grid options which are gone */\r\nexport function obsoleteOptsDel(opts: GridStackOptions, oldName: string, rev: string, info: string) {\r\n  if (opts[oldName] !== undefined) {\r\n    console.warn('gridstack.js: Option `' + oldName + '` is deprecated in ' + rev + info);\r\n  }\r\n}\r\n\r\n/** checks for obsolete Jquery element attributes */\r\nexport function obsoleteAttr(el: HTMLElement, oldName: string, newName: string, rev: string) {\r\n  let oldAttr = el.getAttribute(oldName);\r\n  if (oldAttr !== null) {\r\n    el.setAttribute(newName, oldAttr);\r\n    console.warn('gridstack.js: attribute `' + oldName + '`=' + oldAttr + ' is deprecated on this object in ' + rev + ' and has been replaced with `' +\r\n      newName + '`. It will be **completely** removed in v1.0');\r\n  }\r\n}\r\n\r\n/**\r\n * Utility methods\r\n */\r\nexport class Utils {\r\n\r\n  /** returns true if a and b overlap */\r\n  static isIntercepted(a: GridStackWidget, b: GridStackWidget): boolean {\r\n    return !(a.x + a.width <= b.x || b.x + b.width <= a.x || a.y + a.height <= b.y || b.y + b.height <= a.y);\r\n  }\r\n\r\n  /**\r\n   * Sorts array of nodes\r\n   * @param nodes array to sort\r\n   * @param dir 1 for asc, -1 for desc (optional)\r\n   * @param width width of the grid. If undefined the width will be calculated automatically (optional).\r\n   **/\r\n  static sort(nodes: GridStackNode[], dir?: -1 | 1, column?: number): GridStackNode[] {\r\n    if (!column) {\r\n      let widths = nodes.map(n => n.x + n.width);\r\n      column = Math.max(...widths);\r\n    }\r\n\r\n    if (dir === -1)\r\n      return nodes.sort((a, b) => (b.x + b.y * column)-(a.x + a.y * column));\r\n    else\r\n      return nodes.sort((b, a) => (b.x + b.y * column)-(a.x + a.y * column));\r\n  }\r\n\r\n  /**\r\n   * creates a style sheet with style id under given parent\r\n   * @param id will set the 'data-gs-style-id' attribute to that id\r\n   * @param parent to insert the stylesheet as first child,\r\n   * if none supplied it will be appended to the document head instead.\r\n   */\r\n  static createStylesheet(id: string, parent?: HTMLElement): CSSStyleSheet {\r\n    let style: HTMLStyleElement = document.createElement('style');\r\n    style.setAttribute('type', 'text/css');\r\n    style.setAttribute('data-gs-style-id', id);\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    if ((style as any).styleSheet) { // TODO: only CSSImportRule have that and different beast ??\r\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n      (style as any).styleSheet.cssText = '';\r\n    } else {\r\n      style.appendChild(document.createTextNode('')); // WebKit hack\r\n    }\r\n    if (!parent) {\r\n      // default to head\r\n      parent = document.getElementsByTagName('head')[0];\r\n      parent.appendChild(style);\r\n    } else {\r\n      parent.insertBefore(style, parent.firstChild);\r\n    }\r\n    return style.sheet as CSSStyleSheet;\r\n  }\r\n\r\n  /** removed the given stylesheet id */\r\n  static removeStylesheet(id: string) {\r\n    let el = document.querySelector('STYLE[data-gs-style-id=' + id + ']');\r\n    if (!el || !el.parentNode) return;\r\n    el.parentNode.removeChild(el);\r\n  }\r\n\r\n  /** inserts a CSS rule */\r\n  static addCSSRule(sheet: CSSStyleSheet, selector: string, rules: string) {\r\n    if (typeof sheet.addRule === 'function') {\r\n      sheet.addRule(selector, rules);\r\n    } else if (typeof sheet.insertRule === 'function') {\r\n      sheet.insertRule(`${selector}{${rules}}`);\r\n    }\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  static toBool(v: any): boolean {\r\n    if (typeof v === 'boolean') {\r\n      return v;\r\n    }\r\n    if (typeof v === 'string') {\r\n      v = v.toLowerCase();\r\n      return !(v === '' || v === 'no' || v === 'false' || v === '0');\r\n    }\r\n    return Boolean(v);\r\n  }\r\n\r\n  static toNumber(value: null | string): number | null {\r\n    return (value === null || value.length === 0) ? null : Number(value);\r\n  }\r\n\r\n  static parseHeight(val: numberOrString): HeightData {\r\n    let height: number;\r\n    let heightUnit = 'px';\r\n    if (typeof val === 'string') {\r\n      let match = val.match(/^(-[0-9]+\\.[0-9]+|[0-9]*\\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw|%)?$/);\r\n      if (!match) {\r\n        throw new Error('Invalid height');\r\n      }\r\n      heightUnit = match[2] || 'px';\r\n      height = parseFloat(match[1]);\r\n    } else {\r\n      height = val;\r\n    }\r\n    return { height, unit: heightUnit }\r\n  }\r\n\r\n  /** copies unset fields in target to use the given default sources values */\r\n  static defaults(target, ...sources): {} {\r\n\r\n    sources.forEach(source => {\r\n      for (const key in source) {\r\n        if (!source.hasOwnProperty(key)) { return; }\r\n        if (target[key] === null || target[key] === undefined) {\r\n          target[key] = source[key];\r\n        } else if (typeof source[key] === 'object' && typeof target[key] === 'object') {\r\n          // property is an object, recursively add it's field over... #1373\r\n          this.defaults(target[key], source[key]);\r\n        }\r\n      }\r\n    });\r\n\r\n    return target;\r\n  }\r\n\r\n  /** makes a shallow copy of the passed json struct */\r\n  static clone(target: {}): {} {\r\n    return {...target}; // was $.extend({}, target)\r\n  }\r\n\r\n  /** return the closest parent matching the given class */\r\n  static closestByClass(el: HTMLElement, name: string): HTMLElement {\r\n    el = el.parentElement;\r\n    if (!el) return null;\r\n    if (el.classList.contains(name)) return el;\r\n    return Utils.closestByClass(el, name);\r\n  }\r\n\r\n  /** @internal */\r\n  static throttle(callback: () => void, delay: number) {\r\n    let isWaiting = false;\r\n\r\n    return (...args) => {\r\n      if (!isWaiting) {\r\n        callback.apply(this, args);\r\n        isWaiting = true;\r\n        setTimeout(() => isWaiting = false, delay);\r\n      }\r\n    }\r\n  }\r\n\r\n  static removePositioningStyles(el: HTMLElement) {\r\n    let style = el.style;\r\n    if (style.position) {\r\n      style.removeProperty('position');\r\n    }\r\n    if (style.left) {\r\n      style.removeProperty('left');\r\n    }\r\n    if (style.top) {\r\n      style.removeProperty('top');\r\n    }\r\n    if (style.width) {\r\n      style.removeProperty('width');\r\n    }\r\n    if (style.height) {\r\n      style.removeProperty('height');\r\n    }\r\n  }\r\n\r\n  /** @internal */\r\n  static getScrollParent(el: HTMLElement): HTMLElement {\r\n    let returnEl;\r\n    if (el === null) {\r\n      returnEl = null;\r\n    } else if (el.scrollHeight > el.clientHeight) {\r\n      returnEl = el;\r\n    } else {\r\n      returnEl = this.getScrollParent(el.parentElement);\r\n    }\r\n    return returnEl;\r\n  }\r\n\r\n  /** @internal */\r\n  static updateScrollPosition(el: HTMLElement, position: {top: number}, distance: number) {\r\n    // is widget in view?\r\n    let rect = el.getBoundingClientRect();\r\n    let innerHeightOrClientHeight = (window.innerHeight || document.documentElement.clientHeight);\r\n    if (rect.top < 0 ||\r\n      rect.bottom > innerHeightOrClientHeight\r\n    ) {\r\n      // set scrollTop of first parent that scrolls\r\n      // if parent is larger than el, set as low as possible\r\n      // to get entire widget on screen\r\n      let offsetDiffDown = rect.bottom - innerHeightOrClientHeight;\r\n      let offsetDiffUp = rect.top;\r\n      let scrollEl = this.getScrollParent(el);\r\n      if (scrollEl !== null) {\r\n        let prevScroll = scrollEl.scrollTop;\r\n        if (rect.top < 0 && distance < 0) {\r\n          // moving up\r\n          if (el.offsetHeight > innerHeightOrClientHeight) {\r\n            scrollEl.scrollTop += distance;\r\n          } else {\r\n            scrollEl.scrollTop += Math.abs(offsetDiffUp) > Math.abs(distance) ? distance : offsetDiffUp;\r\n          }\r\n        } else if (distance > 0) {\r\n          // moving down\r\n          if (el.offsetHeight > innerHeightOrClientHeight) {\r\n            scrollEl.scrollTop += distance;\r\n          } else {\r\n            scrollEl.scrollTop += offsetDiffDown > distance ? distance : offsetDiffDown;\r\n          }\r\n        }\r\n        // move widget y by amount scrolled\r\n        position.top += scrollEl.scrollTop - prevScroll;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","// gridstack-dd.ts 2.0.2 @preserve\r\n\r\n/**\r\n * https://gridstackjs.com/\r\n * (c) 2014-2020 Alain Dumesny, Dylan Weiss, Pavel Reznikov\r\n * gridstack.js may be freely distributed under the MIT license.\r\n*/\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\n\r\nimport { GridStack, GridStackElement } from './gridstack';\r\nimport { GridItemHTMLElement, DDDragInOpt } from './types';\r\n\r\n/** Drag&Drop drop options */\r\nexport type DDDropOpt = {\r\n  /** function or class type that this grid will accept as dropped items (see GridStackOptions.acceptWidgets) */\r\n  accept?: (el: GridItemHTMLElement) => boolean;\r\n}\r\n\r\n/** drag&drop options currently called from the main code, but others can be passed in grid options */\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport type DDOpts = 'enable' | 'disable' | 'destroy' | 'option' | string | {} | any;\r\nexport type DDKey = 'minWidth' | 'minHeight' | string;\r\nexport type DDValue = number | string;\r\n\r\n/** drag&drop events callbacks */\r\nexport type DDCallback = (event: Event, arg2: GridItemHTMLElement, helper?: GridItemHTMLElement) => void;\r\n\r\n/**\r\n * Base class for drag'n'drop plugin.\r\n */\r\nexport class GridStackDD {\r\n  protected grid: GridStack;\r\n  static registeredPlugins: typeof GridStackDD[] = [];\r\n\r\n  /** call this method to register your plugin instead of the default no-op one */\r\n  static registerPlugin(pluginClass: typeof GridStackDD) {\r\n    GridStackDD.registeredPlugins.push(pluginClass);\r\n  }\r\n\r\n  /** get the current registered plugin to use */\r\n  static get(): typeof GridStackDD {\r\n    return GridStackDD.registeredPlugins[0] || GridStackDD;\r\n  }\r\n\r\n  public constructor(grid: GridStack) {\r\n    this.grid = grid;\r\n  }\r\n\r\n  /** removes any drag&drop present (called during destroy) */\r\n  public remove(el: GridItemHTMLElement): GridStackDD {\r\n    this.draggable(el, 'destroy').resizable(el, 'destroy');\r\n    if (el.gridstackNode) {\r\n      delete el.gridstackNode._initDD; // reset our DD init flag\r\n    }\r\n    return this;\r\n  }\r\n\r\n  public resizable(el: GridItemHTMLElement, opts: DDOpts, key?: DDKey, value?: DDValue): GridStackDD {\r\n    return this;\r\n  }\r\n\r\n  public draggable(el: GridItemHTMLElement, opts: DDOpts, key?: DDKey, value?: DDValue): GridStackDD {\r\n    return this;\r\n  }\r\n\r\n  public dragIn(el: GridStackElement, opts: DDDragInOpt): GridStackDD {\r\n    return this;\r\n  }\r\n\r\n  public isDraggable(el: GridStackElement): boolean {\r\n    return false;\r\n  }\r\n\r\n  public droppable(el: GridItemHTMLElement, opts: DDOpts | DDDropOpt, key?: DDKey, value?: DDValue): GridStackDD {\r\n    return this;\r\n  }\r\n\r\n  public isDroppable(el: GridItemHTMLElement): boolean {\r\n    return false;\r\n  }\r\n\r\n  public on(el: GridItemHTMLElement, eventName: string, callback: DDCallback): GridStackDD {\r\n    return this;\r\n  }\r\n\r\n  public off(el: GridItemHTMLElement, eventName: string): GridStackDD {\r\n    return this;\r\n  }\r\n}\r\n","// gridstack-engine.ts 2.0.2 @preserve\r\n\r\n/**\r\n * https://gridstackjs.com/\r\n * (c) 2014-2020 Alain Dumesny, Dylan Weiss, Pavel Reznikov\r\n * gridstack.js may be freely distributed under the MIT license.\r\n*/\r\n\r\nimport { Utils, obsolete } from './utils';\r\nimport { GridStackNode, GridStackWidget } from './types';\r\n\r\nexport type onChangeCB = (nodes: GridStackNode[], removeDOM?: boolean) => void;\r\n\r\n/**\r\n * Defines the GridStack engine that does most no DOM grid manipulation.\r\n * See GridStack methods and vars for descriptions.\r\n *\r\n * NOTE: values should not be modified directly - call the main GridStack API instead\r\n */\r\nexport class GridStackEngine {\r\n  public column: number;\r\n  public maxRow: number;\r\n  public nodes: GridStackNode[];\r\n  public onchange: onChangeCB;\r\n  public addedNodes: GridStackNode[] = [];\r\n  public removedNodes: GridStackNode[] = [];\r\n  public batchMode: boolean;\r\n  /** @internal */\r\n  private _float: boolean;\r\n  /** @internal */\r\n  private _prevFloat: boolean;\r\n  /** @internal */\r\n  private _layouts?: Layout[][]; // maps column # to array of values nodes\r\n  /** @internal */\r\n  private _ignoreLayoutsNodeChange: boolean;\r\n  /** @internal */\r\n  private static _idSeq = 1;\r\n\r\n  public constructor(column = 12, onchange?: onChangeCB, float = false, maxRow = 0, nodes: GridStackNode[] = []) {\r\n    this.column = column;\r\n    this.onchange = onchange;\r\n    this._float = float;\r\n    this.maxRow = maxRow;\r\n    this.nodes = nodes;\r\n  }\r\n\r\n  public batchUpdate(): GridStackEngine {\r\n    if (this.batchMode) return this;\r\n    this.batchMode = true;\r\n    this._prevFloat = this._float;\r\n    this._float = true; // let things go anywhere for now... commit() will restore and possibly reposition\r\n    return this;\r\n  }\r\n\r\n  public commit(): GridStackEngine {\r\n    if (!this.batchMode) return this;\r\n    this.batchMode = false;\r\n    this._float = this._prevFloat;\r\n    delete this._prevFloat;\r\n    this._packNodes();\r\n    this._notify();\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _fixCollisions(node: GridStackNode): GridStackEngine {\r\n    this._sortNodes(-1);\r\n\r\n    let nn = node;\r\n    let hasLocked = Boolean(this.nodes.find(n => n.locked));\r\n    if (!this.float && !hasLocked) {\r\n      nn = {x: 0, y: node.y, width: this.column, height: node.height};\r\n    }\r\n    while (true) {\r\n      let collisionNode = this.nodes.find( n => n !== node && Utils.isIntercepted(n, nn), {node: node, nn: nn});\r\n      if (!collisionNode) { return this }\r\n      let moved;\r\n      if (collisionNode.locked) {\r\n        // if colliding with a locked item, move ourself instead\r\n        moved = this.moveNode(node, node.x, collisionNode.y + collisionNode.height,\r\n          node.width, node.height, true);\r\n      } else {\r\n        moved = this.moveNode(collisionNode, collisionNode.x, node.y + node.height,\r\n          collisionNode.width, collisionNode.height, true);\r\n      }\r\n      if (!moved) { return this } // break inf loop if we couldn't move after all (ex: maxRow, fixed)\r\n    }\r\n  }\r\n\r\n  public isAreaEmpty(x: number, y: number, width: number, height: number): boolean {\r\n    let nn = {x: x || 0, y: y || 0, width: width || 1, height: height || 1};\r\n    let collisionNode = this.nodes.find(n => {\r\n      return Utils.isIntercepted(n, nn);\r\n    });\r\n    return !collisionNode;\r\n  }\r\n\r\n  /** re-layout grid items to reclaim any empty space */\r\n  public compact(): GridStackEngine {\r\n    if (this.nodes.length === 0) { return this }\r\n    this.batchUpdate();\r\n    this._sortNodes();\r\n    let copyNodes = this.nodes;\r\n    this.nodes = []; // pretend we have no nodes to conflict layout to start with...\r\n    copyNodes.forEach(node => {\r\n      if (!node.noMove && !node.locked) {\r\n        node.autoPosition = true;\r\n      }\r\n      this.addNode(node, false); // 'false' for add event trigger\r\n      node._dirty = true; // force attr update\r\n    });\r\n    this.commit();\r\n    return this;\r\n  }\r\n\r\n  /** enable/disable floating widgets (default: `false`) See [example](http://gridstackjs.com/demo/float.html) */\r\n  public set float(val: boolean) {\r\n    if (this._float === val) { return; }\r\n    this._float = val || false;\r\n    if (!val) {\r\n      this._packNodes();\r\n      this._notify();\r\n    }\r\n  }\r\n\r\n  /** float getter method */\r\n  public get float(): boolean { return this._float || false; }\r\n\r\n  /** @internal */\r\n  private _sortNodes(dir?: -1 | 1): GridStackEngine {\r\n    this.nodes = Utils.sort(this.nodes, dir, this.column);\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _packNodes(): GridStackEngine {\r\n    this._sortNodes();\r\n\r\n    if (this.float) {\r\n      this.nodes.forEach((n, i) => {\r\n        if (n._updating || n._packY === undefined || n.y === n._packY) {\r\n          return this;\r\n        }\r\n        let newY = n.y;\r\n        while (newY >= n._packY) {\r\n          let box = {x: n.x, y: newY, width: n.width, height: n.height};\r\n          let collisionNode = this.nodes\r\n            .slice(0, i)\r\n            .find(bn => Utils.isIntercepted(box, bn), {n: n, newY: newY});\r\n          if (!collisionNode) {\r\n            n._dirty = true;\r\n            n.y = newY;\r\n          }\r\n          --newY;\r\n        }\r\n      });\r\n    } else {\r\n      this.nodes.forEach((n, i) => {\r\n        if (n.locked) { return this }\r\n        while (n.y > 0) {\r\n          let newY = n.y - 1;\r\n          let canBeMoved = i === 0;\r\n          let box = {x: n.x, y: newY, width: n.width, height: n.height};\r\n          if (i > 0) {\r\n            let collisionNode = this.nodes\r\n              .slice(0, i)\r\n              .find(bn => Utils.isIntercepted(box, bn), {n: n, newY: newY});\r\n            canBeMoved = collisionNode === undefined;\r\n          }\r\n\r\n          if (!canBeMoved) { break; }\r\n          // Note: must be dirty (from last position) for GridStack::OnChange CB to update positions\r\n          // and move items back. The user 'change' CB should detect changes from the original\r\n          // starting position instead.\r\n          n._dirty = (n.y !== newY);\r\n          n.y = newY;\r\n        }\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * given a random node, makes sure it's coordinates/values are valid in the current grid\r\n   * @param node to adjust\r\n   * @param resizing if out of bound, resize down or move into the grid to fit ?\r\n   */\r\n  public prepareNode(node: GridStackNode, resizing?: boolean): GridStackNode {\r\n    node = node || {};\r\n    node._id = node._id || GridStackEngine._idSeq++;\r\n\r\n    // if we're missing position, have the grid position us automatically (before we set them to 0,0)\r\n    if (node.x === undefined || node.y === undefined || node.x === null || node.y === null) {\r\n      node.autoPosition = true;\r\n    }\r\n\r\n    // assign defaults for missing required fields\r\n    let defaults = {width: 1, height: 1, x: 0, y: 0};\r\n    node = Utils.defaults(node, defaults);\r\n\r\n    node.autoPosition = node.autoPosition || false;\r\n    node.noResize = node.noResize || false;\r\n    node.noMove = node.noMove || false;\r\n\r\n    // check for NaN (in case messed up strings were passed. can't do parseInt() || defaults.x above as 0 is valid #)\r\n    if (Number.isNaN(node.x))      { node.x = defaults.x; node.autoPosition = true; }\r\n    if (Number.isNaN(node.y))      { node.y = defaults.y; node.autoPosition = true; }\r\n    if (Number.isNaN(node.width))  { node.width = defaults.width; }\r\n    if (Number.isNaN(node.height)) { node.height = defaults.height; }\r\n\r\n    if (node.maxWidth) { node.width = Math.min(node.width, node.maxWidth); }\r\n    if (node.maxHeight) { node.height = Math.min(node.height, node.maxHeight); }\r\n    if (node.minWidth) { node.width = Math.max(node.width, node.minWidth); }\r\n    if (node.minHeight) { node.height = Math.max(node.height, node.minHeight); }\r\n\r\n    if (node.width > this.column) {\r\n      node.width = this.column;\r\n    } else if (node.width < 1) {\r\n      node.width = 1;\r\n    }\r\n\r\n    if (this.maxRow && node.height > this.maxRow) {\r\n      node.height = this.maxRow;\r\n    } else if (node.height < 1) {\r\n      node.height = 1;\r\n    }\r\n\r\n    if (node.x < 0) {\r\n      node.x = 0;\r\n    }\r\n    if (node.y < 0) {\r\n      node.y = 0;\r\n    }\r\n\r\n    if (node.x + node.width > this.column) {\r\n      if (resizing) {\r\n        node.width = this.column - node.x;\r\n      } else {\r\n        node.x = this.column - node.width;\r\n      }\r\n    }\r\n    if (this.maxRow && node.y + node.height > this.maxRow) {\r\n      if (resizing) {\r\n        node.height = this.maxRow - node.y;\r\n      } else {\r\n        node.y = this.maxRow - node.height;\r\n      }\r\n    }\r\n\r\n    return node;\r\n  }\r\n\r\n  public getDirtyNodes(verify?: boolean): GridStackNode[] {\r\n    // compare original X,Y,W,H (or entire node?) instead as _dirty can be a temporary state\r\n    if (verify) {\r\n      let dirtNodes: GridStackNode[] = [];\r\n      this.nodes.forEach(n => {\r\n        if (n._dirty) {\r\n          if (n.y === n._origY && n.x === n._origX && n.width === n._origW && n.height === n._origH) {\r\n            delete n._dirty;\r\n          } else {\r\n            dirtNodes.push(n);\r\n          }\r\n        }\r\n      });\r\n      return dirtNodes;\r\n    }\r\n\r\n    return this.nodes.filter(n => n._dirty);\r\n  }\r\n\r\n  /** @internal */\r\n  private _notify(nodes?: GridStackNode | GridStackNode[], removeDOM = true): GridStackEngine {\r\n    if (this.batchMode) { return this }\r\n    nodes = (nodes === undefined ? [] : (Array.isArray(nodes) ? nodes : [nodes]) );\r\n    let dirtyNodes = nodes.concat(this.getDirtyNodes());\r\n    if (this.onchange) {\r\n      this.onchange(dirtyNodes, removeDOM);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  public cleanNodes(): GridStackEngine {\r\n    if (this.batchMode) { return this }\r\n    this.nodes.forEach(n => { delete n._dirty; });\r\n    return this;\r\n  }\r\n\r\n  public addNode(node: GridStackNode, triggerAddEvent = false): GridStackNode {\r\n    node = this.prepareNode(node);\r\n\r\n    if (node.autoPosition) {\r\n      this._sortNodes();\r\n\r\n      for (let i = 0;; ++i) {\r\n        let x = i % this.column;\r\n        let y = Math.floor(i / this.column);\r\n        if (x + node.width > this.column) {\r\n          continue;\r\n        }\r\n        let box = {x: x, y: y, width: node.width, height: node.height};\r\n        if (!this.nodes.find(n => Utils.isIntercepted(box, n), {x: x, y: y, node: node})) {\r\n          node.x = x;\r\n          node.y = y;\r\n          delete node.autoPosition; // found our slot\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.nodes.push(node);\r\n    if (triggerAddEvent) {\r\n      this.addedNodes.push(node);\r\n    }\r\n\r\n    this._fixCollisions(node);\r\n    this._packNodes();\r\n    this._notify();\r\n    return node;\r\n  }\r\n\r\n  public removeNode(node: GridStackNode, removeDOM = true, triggerEvent = false): GridStackEngine {\r\n    if (triggerEvent) { // we wait until final drop to manually track removed items (rather than during drag)\r\n      this.removedNodes.push(node);\r\n    }\r\n    node._id = null; // hint that node is being removed\r\n    // TODO: .splice(findIndex(),1) would be faster but apparently there are cases we have 2 instances ! (see spec 'load add new, delete others')\r\n    // this.nodes = this.nodes.filter(n => n !== node);\r\n    this.nodes.splice(this.nodes.findIndex(n => n === node), 1);\r\n    if (!this.float) {\r\n      this._packNodes();\r\n    }\r\n    this._notify(node, removeDOM);\r\n    return this;\r\n  }\r\n\r\n  public removeAll(removeDOM = true): GridStackEngine {\r\n    delete this._layouts;\r\n    if (this.nodes.length === 0) { return this }\r\n    if (removeDOM) {\r\n      this.nodes.forEach(n => { n._id = null; }); // hint that node is being removed\r\n    }\r\n    this.removedNodes = this.nodes;\r\n    this.nodes = [];\r\n    this._notify(this.removedNodes, removeDOM);\r\n    return this;\r\n  }\r\n\r\n  public canMoveNode(node: GridStackNode, x: number, y: number, width?: number, height?: number): boolean {\r\n    if (!this.isNodeChangedPosition(node, x, y, width, height)) {\r\n      return false;\r\n    }\r\n    let hasLocked = Boolean(this.nodes.find(n => n.locked));\r\n\r\n    if (!this.maxRow && !hasLocked) {\r\n      return true;\r\n    }\r\n\r\n    let clonedNode: GridStackNode;\r\n    let clone = new GridStackEngine(\r\n      this.column,\r\n      null,\r\n      this.float,\r\n      0,\r\n      this.nodes.map(n => {\r\n        if (n === node) {\r\n          clonedNode = Utils.clone(n);\r\n          return clonedNode;\r\n        }\r\n        return Utils.clone(n);\r\n      }));\r\n\r\n    if (!clonedNode) {  return true;}\r\n\r\n    clone.moveNode(clonedNode, x, y, width, height);\r\n\r\n    let canMove = true;\r\n    if (hasLocked) {\r\n      canMove = canMove && !Boolean(clone.nodes.find(n => {\r\n        return n !== clonedNode && Boolean(n.locked) && Boolean(n._dirty);\r\n      }));\r\n    }\r\n    if (this.maxRow) {\r\n      canMove = canMove && (clone.getRow() <= this.maxRow);\r\n    }\r\n\r\n    return canMove;\r\n  }\r\n\r\n  public canBePlacedWithRespectToHeight(node: GridStackNode): boolean {\r\n    if (!this.maxRow) {\r\n      return true;\r\n    }\r\n\r\n    let clone = new GridStackEngine(\r\n      this.column,\r\n      null,\r\n      this.float,\r\n      0,\r\n      this.nodes.map(n => Utils.clone(n)));\r\n    clone.addNode(node);\r\n    return clone.getRow() <= this.maxRow;\r\n  }\r\n\r\n  public isNodeChangedPosition(node: GridStackNode, x: number, y: number, width: number, height: number): boolean {\r\n    if (typeof x !== 'number') { x = node.x; }\r\n    if (typeof y !== 'number') { y = node.y; }\r\n    if (typeof width !== 'number') { width = node.width; }\r\n    if (typeof height !== 'number') { height = node.height; }\r\n\r\n    if (node.maxWidth) { width = Math.min(width, node.maxWidth); }\r\n    if (node.maxHeight) { height = Math.min(height, node.maxHeight); }\r\n    if (node.minWidth) { width = Math.max(width, node.minWidth); }\r\n    if (node.minHeight) { height = Math.max(height, node.minHeight); }\r\n\r\n    if (node.x === x && node.y === y && node.width === width && node.height === height) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  public moveNode(node: GridStackNode, x: number, y: number, width?: number, height?: number, noPack?: boolean): GridStackNode {\r\n    if (node.locked) { return null; }\r\n    if (typeof x !== 'number') { x = node.x; }\r\n    if (typeof y !== 'number') { y = node.y; }\r\n    if (typeof width !== 'number') { width = node.width; }\r\n    if (typeof height !== 'number') { height = node.height; }\r\n\r\n    // constrain the passed in values and check if we're still changing our node\r\n    let resizing = (node.width !== width || node.height !== height);\r\n    let nn: GridStackNode = { x, y, width, height,\r\n      maxWidth: node.maxWidth, maxHeight: node.maxHeight, minWidth: node.minWidth, minHeight: node.minHeight};\r\n    nn = this.prepareNode(nn, resizing);\r\n    if (node.x === nn.x && node.y === nn.y && node.width === nn.width && node.height === nn.height) {\r\n      return null;\r\n    }\r\n\r\n    node._dirty = true;\r\n\r\n    node.x = node._lastTriedX = nn.x;\r\n    node.y = node._lastTriedY = nn.y;\r\n    node.width = node._lastTriedWidth = nn.width;\r\n    node.height = node._lastTriedHeight = nn.height;\r\n\r\n    this._fixCollisions(node);\r\n    if (!noPack) {\r\n      this._packNodes();\r\n      this._notify();\r\n    }\r\n    return node;\r\n  }\r\n\r\n  public getRow(): number {\r\n    return this.nodes.reduce((memo, n) => Math.max(memo, n.y + n.height), 0);\r\n  }\r\n\r\n  public beginUpdate(node: GridStackNode): GridStackEngine {\r\n    if (node._updating) return this;\r\n    node._updating = true;\r\n    this.nodes.forEach(n => { n._packY = n.y; });\r\n    return this;\r\n  }\r\n\r\n  public endUpdate(): GridStackEngine {\r\n    let n = this.nodes.find(n => n._updating);\r\n    if (n) {\r\n      delete n._updating;\r\n      this.nodes.forEach(n => { delete n._packY; });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** saves the current layout returning a list of widgets for serialization */\r\n  public save(saveElement = true): GridStackNode[] {\r\n    let widgets: GridStackNode[] = [];\r\n    Utils.sort(this.nodes);\r\n    this.nodes.forEach(n => {\r\n      let w: GridStackNode = {};\r\n      for (let key in n) { if (key[0] !== '_' && n[key] !== null && n[key] !== undefined ) w[key] = n[key]; }\r\n      // delete other internals\r\n      if (!saveElement) delete w.el;\r\n      delete w.grid;\r\n      // delete default values (will be re-created on read)\r\n      if (!w.autoPosition) delete w.autoPosition;\r\n      if (!w.noResize) delete w.noResize;\r\n      if (!w.noMove) delete w.noMove;\r\n      if (!w.locked) delete w.locked;\r\n      widgets.push(w);\r\n    });\r\n    return widgets;\r\n  }\r\n\r\n  /** @internal called whenever a node is added or moved - updates the cached layouts */\r\n  public layoutsNodesChange(nodes: GridStackNode[]): GridStackEngine {\r\n    if (!this._layouts || this._ignoreLayoutsNodeChange) return this;\r\n    // remove smaller layouts - we will re-generate those on the fly... larger ones need to update\r\n    this._layouts.forEach((layout, column) => {\r\n      if (!layout || column === this.column) return this;\r\n      if (column < this.column) {\r\n        this._layouts[column] = undefined;\r\n      }\r\n      else {\r\n        // we save the original x,y,w (h isn't cached) to see what actually changed to propagate better.\r\n        // Note: we don't need to check against out of bound scaling/moving as that will be done when using those cache values.\r\n        nodes.forEach(node => {\r\n          let n = layout.find(l => l._id === node._id);\r\n          if (!n) return this; // no cache for new nodes. Will use those values.\r\n          let ratio = column / this.column;\r\n          // Y changed, push down same amount\r\n          // TODO: detect doing item 'swaps' will help instead of move (especially in 1 column mode)\r\n          if (node.y !== node._origY) {\r\n            n.y += (node.y - node._origY);\r\n          }\r\n          // X changed, scale from new position\r\n          if (node.x !== node._origX) {\r\n            n.x = Math.round(node.x * ratio);\r\n          }\r\n          // width changed, scale from new width\r\n          if (node.width !== node._origW) {\r\n            n.width = Math.round(node.width * ratio);\r\n          }\r\n          // ...height always carries over from cache\r\n        });\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * @internal Called to scale the widget width & position up/down based on the column change.\r\n   * Note we store previous layouts (especially original ones) to make it possible to go\r\n   * from say 12 -> 1 -> 12 and get back to where we were.\r\n   *\r\n   * @param oldColumn previous number of columns\r\n   * @param column  new column number\r\n   * @param nodes different sorted list (ex: DOM order) instead of current list\r\n   */\r\n  public updateNodeWidths(oldColumn: number, column: number, nodes: GridStackNode[]): GridStackEngine {\r\n    if (!this.nodes.length || oldColumn === column) { return this }\r\n\r\n    // cache the current layout in case they want to go back (like 12 -> 1 -> 12) as it requires original data\r\n    let copy: Layout[] = [];\r\n    this.nodes.forEach((n, i) => { copy[i] = {x: n.x, y: n.y, width: n.width, _id: n._id} }); // only thing we change is x,y,w and id to find it back\r\n    this._layouts = this._layouts || []; // use array to find larger quick\r\n    this._layouts[oldColumn] = copy;\r\n\r\n    // if we're going to 1 column and using DOM order rather than default sorting, then generate that layout\r\n    if (column === 1 && nodes && nodes.length) {\r\n      let top = 0;\r\n      nodes.forEach(n => {\r\n        n.x = 0;\r\n        n.width = 1;\r\n        n.y = Math.max(n.y, top);\r\n        top = n.y + n.height;\r\n      });\r\n    } else {\r\n      nodes = Utils.sort(this.nodes, -1, oldColumn); // current column reverse sorting so we can insert last to front (limit collision)\r\n    }\r\n\r\n    // see if we have cached previous layout.\r\n    let cacheNodes = this._layouts[column] || [];\r\n    // if not AND we are going up in size start with the largest layout as down-scaling is more accurate\r\n    let lastIndex = this._layouts.length - 1;\r\n    if (cacheNodes.length === 0 && column > oldColumn && column < lastIndex) {\r\n      cacheNodes = this._layouts[lastIndex] || [];\r\n      if (cacheNodes.length) {\r\n        // pretend we came from that larger column by assigning those values as starting point\r\n        oldColumn = lastIndex;\r\n        cacheNodes.forEach(cacheNode => {\r\n          let j = nodes.findIndex(n => n._id === cacheNode._id);\r\n          if (j !== -1) {\r\n            // still current, use cache info positions\r\n            nodes[j].x = cacheNode.x;\r\n            nodes[j].y = cacheNode.y;\r\n            nodes[j].width = cacheNode.width;\r\n          }\r\n        });\r\n        cacheNodes = []; // we still don't have new column cached data... will generate from larger one.\r\n      }\r\n    }\r\n\r\n    // if we found cache re-use those nodes that are still current\r\n    let newNodes: GridStackNode[] = [];\r\n    cacheNodes.forEach(cacheNode => {\r\n      let j = nodes.findIndex(n => n && n._id === cacheNode._id);\r\n      if (j !== -1) {\r\n        // still current, use cache info positions\r\n        nodes[j].x = cacheNode.x;\r\n        nodes[j].y = cacheNode.y;\r\n        nodes[j].width = cacheNode.width;\r\n        newNodes.push(nodes[j]);\r\n        nodes[j] = null; // erase it so we know what's left\r\n      }\r\n    });\r\n    // ...and add any extra non-cached ones\r\n    let ratio = column / oldColumn;\r\n    nodes.forEach(node => {\r\n      if (!node) return this;\r\n      node.x = (column === 1 ? 0 : Math.round(node.x * ratio));\r\n      node.width = ((column === 1 || oldColumn === 1) ? 1 : (Math.round(node.width * ratio) || 1));\r\n      newNodes.push(node);\r\n    });\r\n\r\n    // finally re-layout them in reverse order (to get correct placement)\r\n    newNodes = Utils.sort(newNodes, -1, column);\r\n    this._ignoreLayoutsNodeChange = true;\r\n    this.batchUpdate();\r\n    this.nodes = []; // pretend we have no nodes to start with (we use same structures) to simplify layout\r\n    newNodes.forEach(node => {\r\n      this.addNode(node, false); // 'false' for add event trigger\r\n      node._dirty = true; // force attr update\r\n    }, this);\r\n    this.commit();\r\n    delete this._ignoreLayoutsNodeChange;\r\n    return this;\r\n  }\r\n\r\n  /** @internal called to save initial position/size */\r\n  public saveInitial(): GridStackEngine {\r\n    this.nodes.forEach(n => {\r\n      n._origX = n.x;\r\n      n._origY = n.y;\r\n      n._origW = n.width;\r\n      n._origH = n.height;\r\n      delete n._dirty;\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /** called to remove all internal values */\r\n  public cleanupNode(node: GridStackNode) {\r\n    for (let prop in node) {\r\n      if (prop[0] === '_') delete node[prop];\r\n    }\r\n  }\r\n\r\n  /** @internal legacy method renames */\r\n  private getGridHeight = obsolete(this, GridStackEngine.prototype.getRow, 'getGridHeight', 'getRow', 'v1.0.0');\r\n}\r\n\r\n/** @internal class to store per column layout bare minimal info (subset of GridStackWidget) */\r\ninterface Layout {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  _id: number; // so we can find full node back\r\n}\r\n","// gridstack-dd-jqueryui.ts 2.0.2 @preserve\r\n\r\n/** JQuery UI Drag&Drop plugin\r\n * https://gridstackjs.com/\r\n * (c) 2014-2020 Alain Dumesny, Dylan Weiss, Pavel Reznikov\r\n * gridstack.js may be freely distributed under the MIT license.\r\n*/\r\n\r\nimport { GridStack, GridStackElement } from '../gridstack';\r\nimport { GridStackDD, DDOpts, DDKey, DDDropOpt, DDCallback, DDValue } from '../gridstack-dd';\r\nimport { GridItemHTMLElement, DDDragInOpt } from '../types';\r\n\r\n// TODO: TEMPORARY until can remove jquery-ui drag&drop and this class and use HTML5 instead !\r\n// see https://stackoverflow.com/questions/35345760/importing-jqueryui-with-typescript-and-requirejs\r\nimport * as $ from './jquery';\r\nexport { $ };\r\nexport * from './jquery-ui';\r\n\r\n/**\r\n * Jquery-ui based drag'n'drop plugin.\r\n */\r\nexport class GridStackDDJQueryUI extends GridStackDD {\r\n  public constructor(grid: GridStack) {\r\n    super(grid);\r\n  }\r\n\r\n  public resizable(el: GridItemHTMLElement, opts: DDOpts, key?: DDKey, value?: DDValue): GridStackDD {\r\n    let $el: JQuery = $(el);\r\n    if (opts === 'enable') {\r\n      $el.resizable().resizable(opts);\r\n    } else if (opts === 'disable' || opts === 'destroy') {\r\n      if ($el.data('ui-resizable')) { // error to call destroy if not there\r\n        $el.resizable(opts);\r\n      }\r\n    } else if (opts === 'option') {\r\n      $el.resizable(opts, key, value);\r\n    } else {\r\n      let handles = $el.data('gs-resize-handles') ? $el.data('gs-resize-handles') : this.grid.opts.resizable.handles;\r\n      $el.resizable({...this.grid.opts.resizable, ...{handles: handles}, ...{ // was using $.extend()\r\n        start: opts.start, // || function() {},\r\n        stop: opts.stop, // || function() {},\r\n        resize: opts.resize // || function() {}\r\n      }});\r\n    }\r\n    return this;\r\n  }\r\n\r\n  public draggable(el: GridItemHTMLElement, opts: DDOpts, key?: DDKey, value?: DDValue): GridStackDD {\r\n    let $el: JQuery = $(el);\r\n    if (opts === 'enable') {\r\n      $el.draggable().draggable('enable');\r\n    } else if (opts === 'disable' || opts === 'destroy') {\r\n      if ($el.data('ui-draggable')) { // error to call destroy if not there\r\n        $el.draggable(opts);\r\n      }\r\n    } else if (opts === 'option') {\r\n      $el.draggable(opts, key, value);\r\n    } else {\r\n      $el.draggable({...this.grid.opts.draggable, ...{ // was using $.extend()\r\n        containment: (this.grid.opts._isNested && !this.grid.opts.dragOut) ?\r\n          $(this.grid.el).parent() : (this.grid.opts.draggable.containment || null),\r\n        start: opts.start, // || function() {},\r\n        stop: opts.stop, // || function() {},\r\n        drag: opts.drag // || function() {}\r\n      }});\r\n    }\r\n    return this;\r\n  }\r\n\r\n  public dragIn(el: GridStackElement, opts: DDDragInOpt): GridStackDD {\r\n    let $el: JQuery = $(el as any); // workaround Type 'string' is not assignable to type 'PlainObject<any>' - see https://github.com/DefinitelyTyped/DefinitelyTyped/issues/29312\r\n    $el.draggable(opts);\r\n    return this;\r\n  }\r\n\r\n  public droppable(el: GridItemHTMLElement, opts: DDOpts | DDDropOpt, key?: DDKey, value?: DDValue): GridStackDD {\r\n    let $el: JQuery = $(el);\r\n    if (typeof opts.accept === 'function' && !opts._accept) {\r\n      // convert jquery event to generic element\r\n      opts._accept = opts.accept;\r\n      opts.accept = ($el: JQuery) => opts._accept($el.get(0));\r\n    }\r\n    $el.droppable(opts, key, value);\r\n    return this;\r\n  }\r\n\r\n  public isDroppable(el: GridItemHTMLElement): boolean {\r\n    let $el: JQuery = $(el);\r\n    return Boolean($el.data('ui-droppable'));\r\n  }\r\n\r\n  public isDraggable(el: GridStackElement): boolean {\r\n    let $el: JQuery = $(el as any); // workaround Type 'string' is not assignable to type 'PlainObject<any>' - see https://github.com/DefinitelyTyped/DefinitelyTyped/issues/29312\r\n    return Boolean($el.data('ui-draggable'));\r\n  }\r\n\r\n  public on(el: GridItemHTMLElement, name: string, callback: DDCallback): GridStackDD {\r\n    let $el: JQuery = $(el);\r\n    $el.on(name, (event, ui) => { callback(event as any, ui.draggable ? ui.draggable[0] : event.target, ui.helper ? ui.helper[0] : null) });\r\n    return this;\r\n  }\r\n\r\n  public off(el: GridItemHTMLElement, name: string): GridStackDD {\r\n    let $el: JQuery = $(el);\r\n    $el.off(name);\r\n    return this;\r\n  }\r\n}\r\n\r\n// finally register ourself\r\nGridStackDD.registerPlugin(GridStackDDJQueryUI);\r\n","/*! jQuery UI - v1.12.1 - 2019-11-20\r\n* http://jqueryui.com\r\n* Includes: widget.js, data.js, disable-selection.js, scroll-parent.js, widgets/draggable.js, widgets/droppable.js, widgets/resizable.js, widgets/mouse.js\r\n* Copyright jQuery Foundation and other contributors; Licensed MIT\r\n*/\r\n\r\n(function( factory ) {\r\n  /* [alain] we compile this in so no need to load with AMD\r\n  if ( typeof define === \"function\" && define.amd ) {\r\n\r\n    // AMD. Register as an anonymous module.\r\n    define([ \"jquery\" ], factory );\r\n  } else */{\r\n\r\n    // Browser globals\r\n    factory( jQuery );\r\n  }\r\n}(function( $ ) {\r\n\r\n$.ui = $.ui || {};\r\n\r\nvar version = $.ui.version = \"1.12.1\";\r\n\r\n\r\n/*\r\n * jQuery UI Widget 1.12.1\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: Widget\r\n//>>group: Core\r\n//>>description: Provides a factory for creating stateful widgets with a common API.\r\n//>>docs: http://api.jqueryui.com/jQuery.widget/\r\n//>>demos: http://jqueryui.com/widget/\r\n\r\n\r\n\r\nvar widgetUuid = 0;\r\nvar widgetSlice = Array.prototype.slice;\r\n\r\n$.cleanData = ( function( orig ) {\r\n  return function( elems ) {\r\n    var events, elem, i;\r\n    for ( i = 0; ( elem = elems[ i ] ) != null; i++ ) {\r\n      try {\r\n\r\n        // Only trigger remove when necessary to save time\r\n        events = $._data( elem, \"events\" );\r\n        if ( events && events.remove ) {\r\n          $( elem ).triggerHandler( \"remove\" );\r\n        }\r\n\r\n      // Http://bugs.jquery.com/ticket/8235\r\n      } catch ( e ) {}\r\n    }\r\n    orig( elems );\r\n  };\r\n} )( $.cleanData );\r\n\r\n$.widget = function( name, base, prototype ) {\r\n  var existingConstructor, constructor, basePrototype;\r\n\r\n  // ProxiedPrototype allows the provided prototype to remain unmodified\r\n  // so that it can be used as a mixin for multiple widgets (#8876)\r\n  var proxiedPrototype = {};\r\n\r\n  var namespace = name.split( \".\" )[ 0 ];\r\n  name = name.split( \".\" )[ 1 ];\r\n  var fullName = namespace + \"-\" + name;\r\n\r\n  if ( !prototype ) {\r\n    prototype = base;\r\n    base = $.Widget;\r\n  }\r\n\r\n  if ( $.isArray( prototype ) ) {\r\n    prototype = $.extend.apply( null, [ {} ].concat( prototype ) );\r\n  }\r\n\r\n  // Create selector for plugin\r\n  $.expr[ \":\" ][ fullName.toLowerCase() ] = function( elem ) {\r\n    return !!$.data( elem, fullName );\r\n  };\r\n\r\n  $[ namespace ] = $[ namespace ] || {};\r\n  existingConstructor = $[ namespace ][ name ];\r\n  constructor = $[ namespace ][ name ] = function( options, element ) {\r\n\r\n    // Allow instantiation without \"new\" keyword\r\n    if ( !this._createWidget ) {\r\n      return new constructor( options, element );\r\n    }\r\n\r\n    // Allow instantiation without initializing for simple inheritance\r\n    // must use \"new\" keyword (the code above always passes args)\r\n    if ( arguments.length ) {\r\n      this._createWidget( options, element );\r\n    }\r\n  };\r\n\r\n  // Extend with the existing constructor to carry over any static properties\r\n  $.extend( constructor, existingConstructor, {\r\n    version: prototype.version,\r\n\r\n    // Copy the object used to create the prototype in case we need to\r\n    // redefine the widget later\r\n    _proto: $.extend( {}, prototype ),\r\n\r\n    // Track widgets that inherit from this widget in case this widget is\r\n    // redefined after a widget inherits from it\r\n    _childConstructors: []\r\n  } );\r\n\r\n  basePrototype = new base();\r\n\r\n  // We need to make the options hash a property directly on the new instance\r\n  // otherwise we'll modify the options hash on the prototype that we're\r\n  // inheriting from\r\n  basePrototype.options = $.widget.extend( {}, basePrototype.options );\r\n  $.each( prototype, function( prop, value ) {\r\n    if ( !$.isFunction( value ) ) {\r\n      proxiedPrototype[ prop ] = value;\r\n      return;\r\n    }\r\n    proxiedPrototype[ prop ] = ( function() {\r\n      function _super() {\r\n        return base.prototype[ prop ].apply( this, arguments );\r\n      }\r\n\r\n      function _superApply( args ) {\r\n        return base.prototype[ prop ].apply( this, args );\r\n      }\r\n\r\n      return function() {\r\n        var __super = this._super;\r\n        var __superApply = this._superApply;\r\n        var returnValue;\r\n\r\n        this._super = _super;\r\n        this._superApply = _superApply;\r\n\r\n        returnValue = value.apply( this, arguments );\r\n\r\n        this._super = __super;\r\n        this._superApply = __superApply;\r\n\r\n        return returnValue;\r\n      };\r\n    } )();\r\n  } );\r\n  constructor.prototype = $.widget.extend( basePrototype, {\r\n\r\n    // TODO: remove support for widgetEventPrefix\r\n    // always use the name + a colon as the prefix, e.g., draggable:start\r\n    // don't prefix for widgets that aren't DOM-based\r\n    widgetEventPrefix: existingConstructor ? ( basePrototype.widgetEventPrefix || name ) : name\r\n  }, proxiedPrototype, {\r\n    constructor: constructor,\r\n    namespace: namespace,\r\n    widgetName: name,\r\n    widgetFullName: fullName\r\n  } );\r\n\r\n  // If this widget is being redefined then we need to find all widgets that\r\n  // are inheriting from it and redefine all of them so that they inherit from\r\n  // the new version of this widget. We're essentially trying to replace one\r\n  // level in the prototype chain.\r\n  if ( existingConstructor ) {\r\n    $.each( existingConstructor._childConstructors, function( i, child ) {\r\n      var childPrototype = child.prototype;\r\n\r\n      // Redefine the child widget using the same prototype that was\r\n      // originally used, but inherit from the new version of the base\r\n      $.widget( childPrototype.namespace + \".\" + childPrototype.widgetName, constructor,\r\n        child._proto );\r\n    } );\r\n\r\n    // Remove the list of existing child constructors from the old constructor\r\n    // so the old child constructors can be garbage collected\r\n    delete existingConstructor._childConstructors;\r\n  } else {\r\n    base._childConstructors.push( constructor );\r\n  }\r\n\r\n  $.widget.bridge( name, constructor );\r\n\r\n  return constructor;\r\n};\r\n\r\n$.widget.extend = function( target ) {\r\n  var input = widgetSlice.call( arguments, 1 );\r\n  var inputIndex = 0;\r\n  var inputLength = input.length;\r\n  var key;\r\n  var value;\r\n\r\n  for ( ; inputIndex < inputLength; inputIndex++ ) {\r\n    for ( key in input[ inputIndex ] ) {\r\n      value = input[ inputIndex ][ key ];\r\n      if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {\r\n\r\n        // Clone objects\r\n        if ( $.isPlainObject( value ) ) {\r\n          target[ key ] = $.isPlainObject( target[ key ] ) ?\r\n            $.widget.extend( {}, target[ key ], value ) :\r\n\r\n            // Don't extend strings, arrays, etc. with objects\r\n            $.widget.extend( {}, value );\r\n\r\n        // Copy everything else by reference\r\n        } else {\r\n          target[ key ] = value;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return target;\r\n};\r\n\r\n$.widget.bridge = function( name, object ) {\r\n  var fullName = object.prototype.widgetFullName || name;\r\n  $.fn[ name ] = function( options ) {\r\n    var isMethodCall = typeof options === \"string\";\r\n    var args = widgetSlice.call( arguments, 1 );\r\n    var returnValue = this;\r\n\r\n    if ( isMethodCall ) {\r\n\r\n      // If this is an empty collection, we need to have the instance method\r\n      // return undefined instead of the jQuery instance\r\n      if ( !this.length && options === \"instance\" ) {\r\n        returnValue = undefined;\r\n      } else {\r\n        this.each( function() {\r\n          var methodValue;\r\n          var instance = $.data( this, fullName );\r\n\r\n          if ( options === \"instance\" ) {\r\n            returnValue = instance;\r\n            return false;\r\n          }\r\n\r\n          if ( !instance ) {\r\n            return $.error( \"cannot call methods on \" + name +\r\n              \" prior to initialization; \" +\r\n              \"attempted to call method '\" + options + \"'\" );\r\n          }\r\n\r\n          if ( !$.isFunction( instance[ options ] ) || options.charAt( 0 ) === \"_\" ) {\r\n            return $.error( \"no such method '\" + options + \"' for \" + name +\r\n              \" widget instance\" );\r\n          }\r\n\r\n          methodValue = instance[ options ].apply( instance, args );\r\n\r\n          if ( methodValue !== instance && methodValue !== undefined ) {\r\n            returnValue = methodValue && methodValue.jquery ?\r\n              returnValue.pushStack( methodValue.get() ) :\r\n              methodValue;\r\n            return false;\r\n          }\r\n        } );\r\n      }\r\n    } else {\r\n\r\n      // Allow multiple hashes to be passed on init\r\n      if ( args.length ) {\r\n        options = $.widget.extend.apply( null, [ options ].concat( args ) );\r\n      }\r\n\r\n      this.each( function() {\r\n        var instance = $.data( this, fullName );\r\n        if ( instance ) {\r\n          instance.option( options || {} );\r\n          if ( instance._init ) {\r\n            instance._init();\r\n          }\r\n        } else {\r\n          $.data( this, fullName, new object( options, this ) );\r\n        }\r\n      } );\r\n    }\r\n\r\n    return returnValue;\r\n  };\r\n};\r\n\r\n$.Widget = function( /* options, element */ ) {};\r\n$.Widget._childConstructors = [];\r\n\r\n$.Widget.prototype = {\r\n  widgetName: \"widget\",\r\n  widgetEventPrefix: \"\",\r\n  defaultElement: \"<div>\",\r\n\r\n  options: {\r\n    classes: {},\r\n    disabled: false,\r\n\r\n    // Callbacks\r\n    create: null\r\n  },\r\n\r\n  _createWidget: function( options, element ) {\r\n    element = $( element || this.defaultElement || this )[ 0 ];\r\n    this.element = $( element );\r\n    this.uuid = widgetUuid++;\r\n    this.eventNamespace = \".\" + this.widgetName + this.uuid;\r\n\r\n    this.bindings = $();\r\n    this.hoverable = $();\r\n    this.focusable = $();\r\n    this.classesElementLookup = {};\r\n\r\n    if ( element !== this ) {\r\n      $.data( element, this.widgetFullName, this );\r\n      this._on( true, this.element, {\r\n        remove: function( event ) {\r\n          if ( event.target === element ) {\r\n            this.destroy();\r\n          }\r\n        }\r\n      } );\r\n      this.document = $( element.style ?\r\n\r\n        // Element within the document\r\n        element.ownerDocument :\r\n\r\n        // Element is window or document\r\n        element.document || element );\r\n      this.window = $( this.document[ 0 ].defaultView || this.document[ 0 ].parentWindow );\r\n    }\r\n\r\n    this.options = $.widget.extend( {},\r\n      this.options,\r\n      this._getCreateOptions(),\r\n      options );\r\n\r\n    this._create();\r\n\r\n    if ( this.options.disabled ) {\r\n      this._setOptionDisabled( this.options.disabled );\r\n    }\r\n\r\n    this._trigger( \"create\", null, this._getCreateEventData() );\r\n    this._init();\r\n  },\r\n\r\n  _getCreateOptions: function() {\r\n    return {};\r\n  },\r\n\r\n  _getCreateEventData: $.noop,\r\n\r\n  _create: $.noop,\r\n\r\n  _init: $.noop,\r\n\r\n  destroy: function() {\r\n    var that = this;\r\n\r\n    this._destroy();\r\n    $.each( this.classesElementLookup, function( key, value ) {\r\n      that._removeClass( value, key );\r\n    } );\r\n\r\n    // We can probably remove the unbind calls in 2.0\r\n    // all event bindings should go through this._on()\r\n    this.element\r\n      .off( this.eventNamespace )\r\n      .removeData( this.widgetFullName );\r\n    this.widget()\r\n      .off( this.eventNamespace )\r\n      .removeAttr( \"aria-disabled\" );\r\n\r\n    // Clean up events and states\r\n    this.bindings.off( this.eventNamespace );\r\n  },\r\n\r\n  _destroy: $.noop,\r\n\r\n  widget: function() {\r\n    return this.element;\r\n  },\r\n\r\n  option: function( key, value ) {\r\n    var options = key;\r\n    var parts;\r\n    var curOption;\r\n    var i;\r\n\r\n    if ( arguments.length === 0 ) {\r\n\r\n      // Don't return a reference to the internal hash\r\n      return $.widget.extend( {}, this.options );\r\n    }\r\n\r\n    if ( typeof key === \"string\" ) {\r\n\r\n      // Handle nested keys, e.g., \"foo.bar\" = { foo: { bar: ___ } }\r\n      options = {};\r\n      parts = key.split( \".\" );\r\n      key = parts.shift();\r\n      if ( parts.length ) {\r\n        curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );\r\n        for ( i = 0; i < parts.length - 1; i++ ) {\r\n          curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};\r\n          curOption = curOption[ parts[ i ] ];\r\n        }\r\n        key = parts.pop();\r\n        if ( arguments.length === 1 ) {\r\n          return curOption[ key ] === undefined ? null : curOption[ key ];\r\n        }\r\n        curOption[ key ] = value;\r\n      } else {\r\n        if ( arguments.length === 1 ) {\r\n          return this.options[ key ] === undefined ? null : this.options[ key ];\r\n        }\r\n        options[ key ] = value;\r\n      }\r\n    }\r\n\r\n    this._setOptions( options );\r\n\r\n    return this;\r\n  },\r\n\r\n  _setOptions: function( options ) {\r\n    var key;\r\n\r\n    for ( key in options ) {\r\n      this._setOption( key, options[ key ] );\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  _setOption: function( key, value ) {\r\n    if ( key === \"classes\" ) {\r\n      this._setOptionClasses( value );\r\n    }\r\n\r\n    this.options[ key ] = value;\r\n\r\n    if ( key === \"disabled\" ) {\r\n      this._setOptionDisabled( value );\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  _setOptionClasses: function( value ) {\r\n    var classKey, elements, currentElements;\r\n\r\n    for ( classKey in value ) {\r\n      currentElements = this.classesElementLookup[ classKey ];\r\n      if ( value[ classKey ] === this.options.classes[ classKey ] ||\r\n          !currentElements ||\r\n          !currentElements.length ) {\r\n        continue;\r\n      }\r\n\r\n      // We are doing this to create a new jQuery object because the _removeClass() call\r\n      // on the next line is going to destroy the reference to the current elements being\r\n      // tracked. We need to save a copy of this collection so that we can add the new classes\r\n      // below.\r\n      elements = $( currentElements.get() );\r\n      this._removeClass( currentElements, classKey );\r\n\r\n      // We don't use _addClass() here, because that uses this.options.classes\r\n      // for generating the string of classes. We want to use the value passed in from\r\n      // _setOption(), this is the new value of the classes option which was passed to\r\n      // _setOption(). We pass this value directly to _classes().\r\n      elements.addClass( this._classes( {\r\n        element: elements,\r\n        keys: classKey,\r\n        classes: value,\r\n        add: true\r\n      } ) );\r\n    }\r\n  },\r\n\r\n  _setOptionDisabled: function( value ) {\r\n    this._toggleClass( this.widget(), this.widgetFullName + \"-disabled\", null, !!value );\r\n\r\n    // If the widget is becoming disabled, then nothing is interactive\r\n    if ( value ) {\r\n      this._removeClass( this.hoverable, null, \"ui-state-hover\" );\r\n      this._removeClass( this.focusable, null, \"ui-state-focus\" );\r\n    }\r\n  },\r\n\r\n  enable: function() {\r\n    return this._setOptions( { disabled: false } );\r\n  },\r\n\r\n  disable: function() {\r\n    return this._setOptions( { disabled: true } );\r\n  },\r\n\r\n  _classes: function( options ) {\r\n    var full = [];\r\n    var that = this;\r\n\r\n    options = $.extend( {\r\n      element: this.element,\r\n      classes: this.options.classes || {}\r\n    }, options );\r\n\r\n    function processClassString( classes, checkOption ) {\r\n      var current, i;\r\n      for ( i = 0; i < classes.length; i++ ) {\r\n        current = that.classesElementLookup[ classes[ i ] ] || $();\r\n        if ( options.add ) {\r\n          current = $( $.unique( current.get().concat( options.element.get() ) ) );\r\n        } else {\r\n          current = $( current.not( options.element ).get() );\r\n        }\r\n        that.classesElementLookup[ classes[ i ] ] = current;\r\n        full.push( classes[ i ] );\r\n        if ( checkOption && options.classes[ classes[ i ] ] ) {\r\n          full.push( options.classes[ classes[ i ] ] );\r\n        }\r\n      }\r\n    }\r\n\r\n    this._on( options.element, {\r\n      \"remove\": \"_untrackClassesElement\"\r\n    } );\r\n\r\n    if ( options.keys ) {\r\n      processClassString( options.keys.match( /\\S+/g ) || [], true );\r\n    }\r\n    if ( options.extra ) {\r\n      processClassString( options.extra.match( /\\S+/g ) || [] );\r\n    }\r\n\r\n    return full.join( \" \" );\r\n  },\r\n\r\n  _untrackClassesElement: function( event ) {\r\n    var that = this;\r\n    $.each( that.classesElementLookup, function( key, value ) {\r\n      if ( $.inArray( event.target, value ) !== -1 ) {\r\n        that.classesElementLookup[ key ] = $( value.not( event.target ).get() );\r\n      }\r\n    } );\r\n  },\r\n\r\n  _removeClass: function( element, keys, extra ) {\r\n    return this._toggleClass( element, keys, extra, false );\r\n  },\r\n\r\n  _addClass: function( element, keys, extra ) {\r\n    return this._toggleClass( element, keys, extra, true );\r\n  },\r\n\r\n  _toggleClass: function( element, keys, extra, add ) {\r\n    add = ( typeof add === \"boolean\" ) ? add : extra;\r\n    var shift = ( typeof element === \"string\" || element === null ),\r\n      options = {\r\n        extra: shift ? keys : extra,\r\n        keys: shift ? element : keys,\r\n        element: shift ? this.element : element,\r\n        add: add\r\n      };\r\n    options.element.toggleClass( this._classes( options ), add );\r\n    return this;\r\n  },\r\n\r\n  _on: function( suppressDisabledCheck, element, handlers ) {\r\n    var delegateElement;\r\n    var instance = this;\r\n\r\n    // No suppressDisabledCheck flag, shuffle arguments\r\n    if ( typeof suppressDisabledCheck !== \"boolean\" ) {\r\n      handlers = element;\r\n      element = suppressDisabledCheck;\r\n      suppressDisabledCheck = false;\r\n    }\r\n\r\n    // No element argument, shuffle and use this.element\r\n    if ( !handlers ) {\r\n      handlers = element;\r\n      element = this.element;\r\n      delegateElement = this.widget();\r\n    } else {\r\n      element = delegateElement = $( element );\r\n      this.bindings = this.bindings.add( element );\r\n    }\r\n\r\n    $.each( handlers, function( event, handler ) {\r\n      function handlerProxy() {\r\n\r\n        // Allow widgets to customize the disabled handling\r\n        // - disabled as an array instead of boolean\r\n        // - disabled class as method for disabling individual parts\r\n        if ( !suppressDisabledCheck &&\r\n            ( instance.options.disabled === true ||\r\n            $( this ).hasClass( \"ui-state-disabled\" ) ) ) {\r\n          return;\r\n        }\r\n        return ( typeof handler === \"string\" ? instance[ handler ] : handler )\r\n          .apply( instance, arguments );\r\n      }\r\n\r\n      // Copy the guid so direct unbinding works\r\n      if ( typeof handler !== \"string\" ) {\r\n        handlerProxy.guid = handler.guid =\r\n          handler.guid || handlerProxy.guid || $.guid++;\r\n      }\r\n\r\n      var match = event.match( /^([\\w:-]*)\\s*(.*)$/ );\r\n      var eventName = match[ 1 ] + instance.eventNamespace;\r\n      var selector = match[ 2 ];\r\n\r\n      if ( selector ) {\r\n        delegateElement.on( eventName, selector, handlerProxy );\r\n      } else {\r\n        element.on( eventName, handlerProxy );\r\n      }\r\n    } );\r\n  },\r\n\r\n  _off: function( element, eventName ) {\r\n    eventName = ( eventName || \"\" ).split( \" \" ).join( this.eventNamespace + \" \" ) +\r\n      this.eventNamespace;\r\n    element.off( eventName ).off( eventName );\r\n\r\n    // Clear the stack to avoid memory leaks (#10056)\r\n    this.bindings = $( this.bindings.not( element ).get() );\r\n    this.focusable = $( this.focusable.not( element ).get() );\r\n    this.hoverable = $( this.hoverable.not( element ).get() );\r\n  },\r\n\r\n  _delay: function( handler, delay ) {\r\n    function handlerProxy() {\r\n      return ( typeof handler === \"string\" ? instance[ handler ] : handler )\r\n        .apply( instance, arguments );\r\n    }\r\n    var instance = this;\r\n    return setTimeout( handlerProxy, delay || 0 );\r\n  },\r\n\r\n  _hoverable: function( element ) {\r\n    this.hoverable = this.hoverable.add( element );\r\n    this._on( element, {\r\n      mouseenter: function( event ) {\r\n        this._addClass( $( event.currentTarget ), null, \"ui-state-hover\" );\r\n      },\r\n      mouseleave: function( event ) {\r\n        this._removeClass( $( event.currentTarget ), null, \"ui-state-hover\" );\r\n      }\r\n    } );\r\n  },\r\n\r\n  _focusable: function( element ) {\r\n    this.focusable = this.focusable.add( element );\r\n    this._on( element, {\r\n      focusin: function( event ) {\r\n        this._addClass( $( event.currentTarget ), null, \"ui-state-focus\" );\r\n      },\r\n      focusout: function( event ) {\r\n        this._removeClass( $( event.currentTarget ), null, \"ui-state-focus\" );\r\n      }\r\n    } );\r\n  },\r\n\r\n  _trigger: function( type, event, data ) {\r\n    var prop, orig;\r\n    var callback = this.options[ type ];\r\n\r\n    data = data || {};\r\n    event = $.Event( event );\r\n    event.type = ( type === this.widgetEventPrefix ?\r\n      type :\r\n      this.widgetEventPrefix + type ).toLowerCase();\r\n\r\n    // The original event may come from any element\r\n    // so we need to reset the target on the new event\r\n    event.target = this.element[ 0 ];\r\n\r\n    // Copy original event properties over to the new event\r\n    orig = event.originalEvent;\r\n    if ( orig ) {\r\n      for ( prop in orig ) {\r\n        if ( !( prop in event ) ) {\r\n          event[ prop ] = orig[ prop ];\r\n        }\r\n      }\r\n    }\r\n\r\n    this.element.trigger( event, data );\r\n    return !( $.isFunction( callback ) &&\r\n      callback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||\r\n      event.isDefaultPrevented() );\r\n  }\r\n};\r\n\r\n$.each( { show: \"fadeIn\", hide: \"fadeOut\" }, function( method, defaultEffect ) {\r\n  $.Widget.prototype[ \"_\" + method ] = function( element, options, callback ) {\r\n    if ( typeof options === \"string\" ) {\r\n      options = { effect: options };\r\n    }\r\n\r\n    var hasOptions;\r\n    var effectName = !options ?\r\n      method :\r\n      options === true || typeof options === \"number\" ?\r\n        defaultEffect :\r\n        options.effect || defaultEffect;\r\n\r\n    options = options || {};\r\n    if ( typeof options === \"number\" ) {\r\n      options = { duration: options };\r\n    }\r\n\r\n    hasOptions = !$.isEmptyObject( options );\r\n    options.complete = callback;\r\n\r\n    if ( options.delay ) {\r\n      element.delay( options.delay );\r\n    }\r\n\r\n    if ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {\r\n      element[ method ]( options );\r\n    } else if ( effectName !== method && element[ effectName ] ) {\r\n      element[ effectName ]( options.duration, options.easing, callback );\r\n    } else {\r\n      element.queue( function( next ) {\r\n        $( this )[ method ]();\r\n        if ( callback ) {\r\n          callback.call( element[ 0 ] );\r\n        }\r\n        next();\r\n      } );\r\n    }\r\n  };\r\n} );\r\n\r\nvar widget = $.widget;\r\n\r\n\r\n/*\r\n * jQuery UI :data 1.12.1\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: :data Selector\r\n//>>group: Core\r\n//>>description: Selects elements which have data stored under the specified key.\r\n//>>docs: http://api.jqueryui.com/data-selector/\r\n\r\n\r\nvar data = $.extend( $.expr[ \":\" ], {\r\n  data: $.expr.createPseudo ?\r\n    $.expr.createPseudo( function( dataName ) {\r\n      return function( elem ) {\r\n        return !!$.data( elem, dataName );\r\n      };\r\n    } ) :\r\n\r\n    // Support: jQuery <1.8\r\n    function( elem, i, match ) {\r\n      return !!$.data( elem, match[ 3 ] );\r\n    }\r\n} );\r\n\r\n/*\r\n * jQuery UI Disable Selection 1.12.1\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: disableSelection\r\n//>>group: Core\r\n//>>description: Disable selection of text content within the set of matched elements.\r\n//>>docs: http://api.jqueryui.com/disableSelection/\r\n\r\n// This file is deprecated\r\n\r\n\r\nvar disableSelection = $.fn.extend( {\r\n  disableSelection: ( function() {\r\n    var eventType = \"onselectstart\" in document.createElement( \"div\" ) ?\r\n      \"selectstart\" :\r\n      \"mousedown\";\r\n\r\n    return function() {\r\n      return this.on( eventType + \".ui-disableSelection\", function( event ) {\r\n        event.preventDefault();\r\n      } );\r\n    };\r\n  } )(),\r\n\r\n  enableSelection: function() {\r\n    return this.off( \".ui-disableSelection\" );\r\n  }\r\n} );\r\n\r\n\r\n/*\r\n * jQuery UI Scroll Parent 1.12.1\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: scrollParent\r\n//>>group: Core\r\n//>>description: Get the closest ancestor element that is scrollable.\r\n//>>docs: http://api.jqueryui.com/scrollParent/\r\n\r\n\r\n\r\nvar scrollParent = $.fn.scrollParent = function( includeHidden ) {\r\n  var position = this.css( \"position\" ),\r\n    excludeStaticParent = position === \"absolute\",\r\n    overflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,\r\n    scrollParent = this.parents().filter( function() {\r\n      var parent = $( this );\r\n      if ( excludeStaticParent && parent.css( \"position\" ) === \"static\" ) {\r\n        return false;\r\n      }\r\n      return overflowRegex.test( parent.css( \"overflow\" ) + parent.css( \"overflow-y\" ) +\r\n        parent.css( \"overflow-x\" ) );\r\n    } ).eq( 0 );\r\n\r\n  return position === \"fixed\" || !scrollParent.length ?\r\n    $( this[ 0 ].ownerDocument || document ) :\r\n    scrollParent;\r\n};\r\n\r\n\r\n\r\n\r\n// This file is deprecated\r\nvar ie = $.ui.ie = !!/msie [\\w.]+/.exec( navigator.userAgent.toLowerCase() );\r\n\r\n/*\r\n * jQuery UI Mouse 1.12.1\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: Mouse\r\n//>>group: Widgets\r\n//>>description: Abstracts mouse-based interactions to assist in creating certain widgets.\r\n//>>docs: http://api.jqueryui.com/mouse/\r\n\r\n\r\n\r\nvar mouseHandled = false;\r\n$( document ).on( \"mouseup\", function() {\r\n  mouseHandled = false;\r\n} );\r\n\r\nvar widgetsMouse = $.widget( \"ui.mouse\", {\r\n  version: \"1.12.1\",\r\n  options: {\r\n    cancel: \"input, textarea, button, select, option\",\r\n    distance: 1,\r\n    delay: 0\r\n  },\r\n  _mouseInit: function() {\r\n    var that = this;\r\n\r\n    this.element\r\n      .on( \"mousedown.\" + this.widgetName, function( event ) {\r\n        return that._mouseDown( event );\r\n      } )\r\n      .on( \"click.\" + this.widgetName, function( event ) {\r\n        if ( true === $.data( event.target, that.widgetName + \".preventClickEvent\" ) ) {\r\n          $.removeData( event.target, that.widgetName + \".preventClickEvent\" );\r\n          event.stopImmediatePropagation();\r\n          return false;\r\n        }\r\n      } );\r\n\r\n    this.started = false;\r\n  },\r\n\r\n  // TODO: make sure destroying one instance of mouse doesn't mess with\r\n  // other instances of mouse\r\n  _mouseDestroy: function() {\r\n    this.element.off( \".\" + this.widgetName );\r\n    if ( this._mouseMoveDelegate ) {\r\n      this.document\r\n        .off( \"mousemove.\" + this.widgetName, this._mouseMoveDelegate )\r\n        .off( \"mouseup.\" + this.widgetName, this._mouseUpDelegate );\r\n    }\r\n  },\r\n\r\n  _mouseDown: function( event ) {\r\n\r\n    // don't let more than one widget handle mouseStart\r\n    if ( mouseHandled ) {\r\n      return;\r\n    }\r\n\r\n    this._mouseMoved = false;\r\n\r\n    // We may have missed mouseup (out of window)\r\n    ( this._mouseStarted && this._mouseUp( event ) );\r\n\r\n    this._mouseDownEvent = event;\r\n\r\n    var that = this,\r\n      btnIsLeft = ( event.which === 1 ),\r\n\r\n      // event.target.nodeName works around a bug in IE 8 with\r\n      // disabled inputs (#7620)\r\n      elIsCancel = ( typeof this.options.cancel === \"string\" && event.target.nodeName ?\r\n        $( event.target ).closest( this.options.cancel ).length : false );\r\n    if ( !btnIsLeft || elIsCancel || !this._mouseCapture( event ) ) {\r\n      return true;\r\n    }\r\n\r\n    this.mouseDelayMet = !this.options.delay;\r\n    if ( !this.mouseDelayMet ) {\r\n      this._mouseDelayTimer = setTimeout( function() {\r\n        that.mouseDelayMet = true;\r\n      }, this.options.delay );\r\n    }\r\n\r\n    if ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {\r\n      this._mouseStarted = ( this._mouseStart( event ) !== false );\r\n      if ( !this._mouseStarted ) {\r\n        event.preventDefault();\r\n        return true;\r\n      }\r\n    }\r\n\r\n    // Click event may never have fired (Gecko & Opera)\r\n    if ( true === $.data( event.target, this.widgetName + \".preventClickEvent\" ) ) {\r\n      $.removeData( event.target, this.widgetName + \".preventClickEvent\" );\r\n    }\r\n\r\n    // These delegates are required to keep context\r\n    this._mouseMoveDelegate = function( event ) {\r\n      return that._mouseMove( event );\r\n    };\r\n    this._mouseUpDelegate = function( event ) {\r\n      return that._mouseUp( event );\r\n    };\r\n\r\n    this.document\r\n      .on( \"mousemove.\" + this.widgetName, this._mouseMoveDelegate )\r\n      .on( \"mouseup.\" + this.widgetName, this._mouseUpDelegate );\r\n\r\n    event.preventDefault();\r\n\r\n    mouseHandled = true;\r\n    return true;\r\n  },\r\n\r\n  _mouseMove: function( event ) {\r\n\r\n    // Only check for mouseups outside the document if you've moved inside the document\r\n    // at least once. This prevents the firing of mouseup in the case of IE<9, which will\r\n    // fire a mousemove event if content is placed under the cursor. See #7778\r\n    // Support: IE <9\r\n    if ( this._mouseMoved ) {\r\n\r\n      // IE mouseup check - mouseup happened when mouse was out of window\r\n      if ( $.ui.ie && ( !document.documentMode || document.documentMode < 9 ) &&\r\n          !event.button ) {\r\n        return this._mouseUp( event );\r\n\r\n      // Iframe mouseup check - mouseup occurred in another document\r\n      } else if ( !event.which ) {\r\n\r\n        // Support: Safari <=8 - 9\r\n        // Safari sets which to 0 if you press any of the following keys\r\n        // during a drag (#14461)\r\n        if ( event.originalEvent.altKey || event.originalEvent.ctrlKey ||\r\n            event.originalEvent.metaKey || event.originalEvent.shiftKey ) {\r\n          this.ignoreMissingWhich = true;\r\n        } else if ( !this.ignoreMissingWhich ) {\r\n          return this._mouseUp( event );\r\n        }\r\n      }\r\n    }\r\n\r\n    if ( event.which || event.button ) {\r\n      this._mouseMoved = true;\r\n    }\r\n\r\n    if ( this._mouseStarted ) {\r\n      this._mouseDrag( event );\r\n      return event.preventDefault();\r\n    }\r\n\r\n    if ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {\r\n      this._mouseStarted =\r\n        ( this._mouseStart( this._mouseDownEvent, event ) !== false );\r\n      ( this._mouseStarted ? this._mouseDrag( event ) : this._mouseUp( event ) );\r\n    }\r\n\r\n    return !this._mouseStarted;\r\n  },\r\n\r\n  _mouseUp: function( event ) {\r\n    this.document\r\n      .off( \"mousemove.\" + this.widgetName, this._mouseMoveDelegate )\r\n      .off( \"mouseup.\" + this.widgetName, this._mouseUpDelegate );\r\n\r\n    if ( this._mouseStarted ) {\r\n      this._mouseStarted = false;\r\n\r\n      if ( event.target === this._mouseDownEvent.target ) {\r\n        $.data( event.target, this.widgetName + \".preventClickEvent\", true );\r\n      }\r\n\r\n      this._mouseStop( event );\r\n    }\r\n\r\n    if ( this._mouseDelayTimer ) {\r\n      clearTimeout( this._mouseDelayTimer );\r\n      delete this._mouseDelayTimer;\r\n    }\r\n\r\n    this.ignoreMissingWhich = false;\r\n    mouseHandled = false;\r\n    event.preventDefault();\r\n  },\r\n\r\n  _mouseDistanceMet: function( event ) {\r\n    return ( Math.max(\r\n        Math.abs( this._mouseDownEvent.pageX - event.pageX ),\r\n        Math.abs( this._mouseDownEvent.pageY - event.pageY )\r\n      ) >= this.options.distance\r\n    );\r\n  },\r\n\r\n  _mouseDelayMet: function( /* event */ ) {\r\n    return this.mouseDelayMet;\r\n  },\r\n\r\n  // These are placeholder methods, to be overriden by extending plugin\r\n  _mouseStart: function( /* event */ ) {},\r\n  _mouseDrag: function( /* event */ ) {},\r\n  _mouseStop: function( /* event */ ) {},\r\n  _mouseCapture: function( /* event */ ) { return true; }\r\n} );\r\n\r\n\r\n\r\n\r\n// $.ui.plugin is deprecated. Use $.widget() extensions instead.\r\nvar plugin = $.ui.plugin = {\r\n  add: function( module, option, set ) {\r\n    var i,\r\n      proto = $.ui[ module ].prototype;\r\n    for ( i in set ) {\r\n      proto.plugins[ i ] = proto.plugins[ i ] || [];\r\n      proto.plugins[ i ].push( [ option, set[ i ] ] );\r\n    }\r\n  },\r\n  call: function( instance, name, args, allowDisconnected ) {\r\n    var i,\r\n      set = instance.plugins[ name ];\r\n\r\n    if ( !set ) {\r\n      return;\r\n    }\r\n\r\n    if ( !allowDisconnected && ( !instance.element[ 0 ].parentNode ||\r\n        instance.element[ 0 ].parentNode.nodeType === 11 ) ) {\r\n      return;\r\n    }\r\n\r\n    for ( i = 0; i < set.length; i++ ) {\r\n      if ( instance.options[ set[ i ][ 0 ] ] ) {\r\n        set[ i ][ 1 ].apply( instance.element, args );\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n\r\n\r\nvar safeActiveElement = $.ui.safeActiveElement = function( document ) {\r\n  var activeElement;\r\n\r\n  // Support: IE 9 only\r\n  // IE9 throws an \"Unspecified error\" accessing document.activeElement from an <iframe>\r\n  try {\r\n    activeElement = document.activeElement;\r\n  } catch ( error ) {\r\n    activeElement = document.body;\r\n  }\r\n\r\n  // Support: IE 9 - 11 only\r\n  // IE may return null instead of an element\r\n  // Interestingly, this only seems to occur when NOT in an iframe\r\n  if ( !activeElement ) {\r\n    activeElement = document.body;\r\n  }\r\n\r\n  // Support: IE 11 only\r\n  // IE11 returns a seemingly empty object in some cases when accessing\r\n  // document.activeElement from an <iframe>\r\n  if ( !activeElement.nodeName ) {\r\n    activeElement = document.body;\r\n  }\r\n\r\n  return activeElement;\r\n};\r\n\r\n\r\n\r\nvar safeBlur = $.ui.safeBlur = function( element ) {\r\n\r\n  // Support: IE9 - 10 only\r\n  // If the <body> is blurred, IE will switch windows, see #9420\r\n  if ( element && element.nodeName.toLowerCase() !== \"body\" ) {\r\n    $( element ).trigger( \"blur\" );\r\n  }\r\n};\r\n\r\n\r\n/*\r\n * jQuery UI Draggable 1.12.1\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: Draggable\r\n//>>group: Interactions\r\n//>>description: Enables dragging functionality for any element.\r\n//>>docs: http://api.jqueryui.com/draggable/\r\n//>>demos: http://jqueryui.com/draggable/\r\n//>>css.structure: ../../themes/base/draggable.css\r\n\r\n\r\n\r\n$.widget( \"ui.draggable\", $.ui.mouse, {\r\n  version: \"1.12.1\",\r\n  widgetEventPrefix: \"drag\",\r\n  options: {\r\n    addClasses: true,\r\n    appendTo: \"parent\",\r\n    axis: false,\r\n    connectToSortable: false,\r\n    containment: false,\r\n    cursor: \"auto\",\r\n    cursorAt: false,\r\n    grid: false,\r\n    handle: false,\r\n    helper: \"original\",\r\n    iframeFix: false,\r\n    opacity: false,\r\n    refreshPositions: false,\r\n    revert: false,\r\n    revertDuration: 500,\r\n    scope: \"default\",\r\n    scroll: true,\r\n    scrollSensitivity: 20,\r\n    scrollSpeed: 20,\r\n    snap: false,\r\n    snapMode: \"both\",\r\n    snapTolerance: 20,\r\n    stack: false,\r\n    zIndex: false,\r\n\r\n    // Callbacks\r\n    drag: null,\r\n    start: null,\r\n    stop: null\r\n  },\r\n  _create: function() {\r\n\r\n    if ( this.options.helper === \"original\" ) {\r\n      this._setPositionRelative();\r\n    }\r\n    if ( this.options.addClasses ) {\r\n      this._addClass( \"ui-draggable\" );\r\n    }\r\n    this._setHandleClassName();\r\n\r\n    this._mouseInit();\r\n  },\r\n\r\n  _setOption: function( key, value ) {\r\n    this._super( key, value );\r\n    if ( key === \"handle\" ) {\r\n      this._removeHandleClassName();\r\n      this._setHandleClassName();\r\n    }\r\n  },\r\n\r\n  _destroy: function() {\r\n    if ( ( this.helper || this.element ).is( \".ui-draggable-dragging\" ) ) {\r\n      this.destroyOnClear = true;\r\n      return;\r\n    }\r\n    this._removeHandleClassName();\r\n    this._mouseDestroy();\r\n  },\r\n\r\n  _mouseCapture: function( event ) {\r\n    var o = this.options;\r\n\r\n    // Among others, prevent a drag on a resizable-handle\r\n    if ( this.helper || o.disabled ||\r\n        $( event.target ).closest( \".ui-resizable-handle\" ).length > 0 ) {\r\n      return false;\r\n    }\r\n\r\n    //Quit if we're not on a valid handle\r\n    this.handle = this._getHandle( event );\r\n    if ( !this.handle ) {\r\n      return false;\r\n    }\r\n\r\n    this._blurActiveElement( event );\r\n\r\n    this._blockFrames( o.iframeFix === true ? \"iframe\" : o.iframeFix );\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  _blockFrames: function( selector ) {\r\n    this.iframeBlocks = this.document.find( selector ).map( function() {\r\n      var iframe = $( this );\r\n\r\n      return $( \"<div>\" )\r\n        .css( \"position\", \"absolute\" )\r\n        .appendTo( iframe.parent() )\r\n        .outerWidth( iframe.outerWidth() )\r\n        .outerHeight( iframe.outerHeight() )\r\n        .offset( iframe.offset() )[ 0 ];\r\n    } );\r\n  },\r\n\r\n  _unblockFrames: function() {\r\n    if ( this.iframeBlocks ) {\r\n      this.iframeBlocks.remove();\r\n      delete this.iframeBlocks;\r\n    }\r\n  },\r\n\r\n  _blurActiveElement: function( event ) {\r\n    var activeElement = $.ui.safeActiveElement( this.document[ 0 ] ),\r\n      target = $( event.target );\r\n\r\n    // Don't blur if the event occurred on an element that is within\r\n    // the currently focused element\r\n    // See #10527, #12472\r\n    if ( target.closest( activeElement ).length ) {\r\n      return;\r\n    }\r\n\r\n    // Blur any element that currently has focus, see #4261\r\n    $.ui.safeBlur( activeElement );\r\n  },\r\n\r\n  _mouseStart: function( event ) {\r\n\r\n    var o = this.options;\r\n\r\n    //Create and append the visible helper\r\n    this.helper = this._createHelper( event );\r\n\r\n    this._addClass( this.helper, \"ui-draggable-dragging\" );\r\n\r\n    //Cache the helper size\r\n    this._cacheHelperProportions();\r\n\r\n    //If ddmanager is used for droppables, set the global draggable\r\n    if ( $.ui.ddmanager ) {\r\n      $.ui.ddmanager.current = this;\r\n    }\r\n\r\n    /*\r\n     * - Position generation -\r\n     * This block generates everything position related - it's the core of draggables.\r\n     */\r\n\r\n    //Cache the margins of the original element\r\n    this._cacheMargins();\r\n\r\n    //Store the helper's css position\r\n    this.cssPosition = this.helper.css( \"position\" );\r\n    this.scrollParent = this.helper.scrollParent( true );\r\n    this.offsetParent = this.helper.offsetParent();\r\n    this.hasFixedAncestor = this.helper.parents().filter( function() {\r\n        return $( this ).css( \"position\" ) === \"fixed\";\r\n      } ).length > 0;\r\n\r\n    //The element's absolute position on the page minus margins\r\n    this.positionAbs = this.element.offset();\r\n    this._refreshOffsets( event );\r\n\r\n    //Generate the original position\r\n    this.originalPosition = this.position = this._generatePosition( event, false );\r\n    this.originalPageX = event.pageX;\r\n    this.originalPageY = event.pageY;\r\n\r\n    //Adjust the mouse offset relative to the helper if \"cursorAt\" is supplied\r\n    ( o.cursorAt && this._adjustOffsetFromHelper( o.cursorAt ) );\r\n\r\n    //Set a containment if given in the options\r\n    this._setContainment();\r\n\r\n    //Trigger event + callbacks\r\n    if ( this._trigger( \"start\", event ) === false ) {\r\n      this._clear();\r\n      return false;\r\n    }\r\n\r\n    //Recache the helper size\r\n    this._cacheHelperProportions();\r\n\r\n    //Prepare the droppable offsets\r\n    if ( $.ui.ddmanager && !o.dropBehaviour ) {\r\n      $.ui.ddmanager.prepareOffsets( this, event );\r\n    }\r\n\r\n    // Execute the drag once - this causes the helper not to be visible before getting its\r\n    // correct position\r\n    this._mouseDrag( event, true );\r\n\r\n    // If the ddmanager is used for droppables, inform the manager that dragging has started\r\n    // (see #5003)\r\n    if ( $.ui.ddmanager ) {\r\n      $.ui.ddmanager.dragStart( this, event );\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  _refreshOffsets: function( event ) {\r\n    this.offset = {\r\n      top: this.positionAbs.top - this.margins.top,\r\n      left: this.positionAbs.left - this.margins.left,\r\n      scroll: false,\r\n      parent: this._getParentOffset(),\r\n      relative: this._getRelativeOffset()\r\n    };\r\n\r\n    this.offset.click = {\r\n      left: event.pageX - this.offset.left,\r\n      top: event.pageY - this.offset.top\r\n    };\r\n  },\r\n\r\n  _mouseDrag: function( event, noPropagation ) {\r\n\r\n    // reset any necessary cached properties (see #5009)\r\n    if ( this.hasFixedAncestor ) {\r\n      this.offset.parent = this._getParentOffset();\r\n    }\r\n\r\n    //Compute the helpers position\r\n    this.position = this._generatePosition( event, true );\r\n    this.positionAbs = this._convertPositionTo( \"absolute\" );\r\n\r\n    //Call plugins and callbacks and use the resulting position if something is returned\r\n    if ( !noPropagation ) {\r\n      var ui = this._uiHash();\r\n      if ( this._trigger( \"drag\", event, ui ) === false ) {\r\n        this._mouseUp( new $.Event( \"mouseup\", event ) );\r\n        return false;\r\n      }\r\n      this.position = ui.position;\r\n    }\r\n\r\n    this.helper[ 0 ].style.left = this.position.left + \"px\";\r\n    this.helper[ 0 ].style.top = this.position.top + \"px\";\r\n\r\n    if ( $.ui.ddmanager ) {\r\n      $.ui.ddmanager.drag( this, event );\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  _mouseStop: function( event ) {\r\n\r\n    //If we are using droppables, inform the manager about the drop\r\n    var that = this,\r\n      dropped = false;\r\n    if ( $.ui.ddmanager && !this.options.dropBehaviour ) {\r\n      dropped = $.ui.ddmanager.drop( this, event );\r\n    }\r\n\r\n    //if a drop comes from outside (a sortable)\r\n    if ( this.dropped ) {\r\n      dropped = this.dropped;\r\n      this.dropped = false;\r\n    }\r\n\r\n    if ( ( this.options.revert === \"invalid\" && !dropped ) ||\r\n        ( this.options.revert === \"valid\" && dropped ) ||\r\n        this.options.revert === true || ( $.isFunction( this.options.revert ) &&\r\n        this.options.revert.call( this.element, dropped ) )\r\n    ) {\r\n      $( this.helper ).animate(\r\n        this.originalPosition,\r\n        parseInt( this.options.revertDuration, 10 ),\r\n        function() {\r\n          if ( that._trigger( \"stop\", event ) !== false ) {\r\n            that._clear();\r\n          }\r\n        }\r\n      );\r\n    } else {\r\n      if ( this._trigger( \"stop\", event ) !== false ) {\r\n        this._clear();\r\n      }\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  _mouseUp: function( event ) {\r\n    this._unblockFrames();\r\n\r\n    // If the ddmanager is used for droppables, inform the manager that dragging has stopped\r\n    // (see #5003)\r\n    if ( $.ui.ddmanager ) {\r\n      $.ui.ddmanager.dragStop( this, event );\r\n    }\r\n\r\n    // Only need to focus if the event occurred on the draggable itself, see #10527\r\n    if ( this.handleElement.is( event.target ) ) {\r\n\r\n      // The interaction is over; whether or not the click resulted in a drag,\r\n      // focus the element\r\n      this.element.trigger( \"focus\" );\r\n    }\r\n\r\n    return $.ui.mouse.prototype._mouseUp.call( this, event );\r\n  },\r\n\r\n  cancel: function() {\r\n\r\n    if ( this.helper.is( \".ui-draggable-dragging\" ) ) {\r\n      this._mouseUp( new $.Event( \"mouseup\", { target: this.element[ 0 ] } ) );\r\n    } else {\r\n      this._clear();\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  _getHandle: function( event ) {\r\n    return this.options.handle ?\r\n      !!$( event.target ).closest( this.element.find( this.options.handle ) ).length :\r\n      true;\r\n  },\r\n\r\n  _setHandleClassName: function() {\r\n    this.handleElement = this.options.handle ?\r\n      this.element.find( this.options.handle ) : this.element;\r\n    this._addClass( this.handleElement, \"ui-draggable-handle\" );\r\n  },\r\n\r\n  _removeHandleClassName: function() {\r\n    this._removeClass( this.handleElement, \"ui-draggable-handle\" );\r\n  },\r\n\r\n  _createHelper: function( event ) {\r\n\r\n    var o = this.options,\r\n      helperIsFunction = $.isFunction( o.helper ),\r\n      helper = helperIsFunction ?\r\n        $( o.helper.apply( this.element[ 0 ], [ event ] ) ) :\r\n        ( o.helper === \"clone\" ?\r\n          this.element.clone().removeAttr( \"id\" ) :\r\n          this.element );\r\n\r\n    if ( !helper.parents( \"body\" ).length ) {\r\n      helper.appendTo( ( o.appendTo === \"parent\" ?\r\n        this.element[ 0 ].parentNode :\r\n        o.appendTo ) );\r\n    }\r\n\r\n    // Http://bugs.jqueryui.com/ticket/9446\r\n    // a helper function can return the original element\r\n    // which wouldn't have been set to relative in _create\r\n    if ( helperIsFunction && helper[ 0 ] === this.element[ 0 ] ) {\r\n      this._setPositionRelative();\r\n    }\r\n\r\n    if ( helper[ 0 ] !== this.element[ 0 ] &&\r\n        !( /(fixed|absolute)/ ).test( helper.css( \"position\" ) ) ) {\r\n      helper.css( \"position\", \"absolute\" );\r\n    }\r\n\r\n    return helper;\r\n\r\n  },\r\n\r\n  _setPositionRelative: function() {\r\n    if ( !( /^(?:r|a|f)/ ).test( this.element.css( \"position\" ) ) ) {\r\n      this.element[ 0 ].style.position = \"relative\";\r\n    }\r\n  },\r\n\r\n  _adjustOffsetFromHelper: function( obj ) {\r\n    if ( typeof obj === \"string\" ) {\r\n      obj = obj.split( \" \" );\r\n    }\r\n    if ( $.isArray( obj ) ) {\r\n      obj = { left: +obj[ 0 ], top: +obj[ 1 ] || 0 };\r\n    }\r\n    if ( \"left\" in obj ) {\r\n      this.offset.click.left = obj.left + this.margins.left;\r\n    }\r\n    if ( \"right\" in obj ) {\r\n      this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;\r\n    }\r\n    if ( \"top\" in obj ) {\r\n      this.offset.click.top = obj.top + this.margins.top;\r\n    }\r\n    if ( \"bottom\" in obj ) {\r\n      this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;\r\n    }\r\n  },\r\n\r\n  _isRootNode: function( element ) {\r\n    return ( /(html|body)/i ).test( element.tagName ) || element === this.document[ 0 ];\r\n  },\r\n\r\n  _getParentOffset: function() {\r\n\r\n    //Get the offsetParent and cache its position\r\n    var po = this.offsetParent.offset(),\r\n      document = this.document[ 0 ];\r\n\r\n    // This is a special case where we need to modify a offset calculated on start, since the\r\n    // following happened:\r\n    // 1. The position of the helper is absolute, so it's position is calculated based on the\r\n    // next positioned parent\r\n    // 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't\r\n    // the document, which means that the scroll is included in the initial calculation of the\r\n    // offset of the parent, and never recalculated upon drag\r\n    if ( this.cssPosition === \"absolute\" && this.scrollParent[ 0 ] !== document &&\r\n        $.contains( this.scrollParent[ 0 ], this.offsetParent[ 0 ] ) ) {\r\n      po.left += this.scrollParent.scrollLeft();\r\n      po.top += this.scrollParent.scrollTop();\r\n    }\r\n\r\n    if ( this._isRootNode( this.offsetParent[ 0 ] ) ) {\r\n      po = { top: 0, left: 0 };\r\n    }\r\n\r\n    return {\r\n      top: po.top + ( parseInt( this.offsetParent.css( \"borderTopWidth\" ), 10 ) || 0 ),\r\n      left: po.left + ( parseInt( this.offsetParent.css( \"borderLeftWidth\" ), 10 ) || 0 )\r\n    };\r\n\r\n  },\r\n\r\n  _getRelativeOffset: function() {\r\n    if ( this.cssPosition !== \"relative\" ) {\r\n      return { top: 0, left: 0 };\r\n    }\r\n\r\n    var p = this.element.position(),\r\n      scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );\r\n\r\n    return {\r\n      top: p.top - ( parseInt( this.helper.css( \"top\" ), 10 ) || 0 ) +\r\n        ( !scrollIsRootNode ? this.scrollParent.scrollTop() : 0 ),\r\n      left: p.left - ( parseInt( this.helper.css( \"left\" ), 10 ) || 0 ) +\r\n        ( !scrollIsRootNode ? this.scrollParent.scrollLeft() : 0 )\r\n    };\r\n\r\n  },\r\n\r\n  _cacheMargins: function() {\r\n    this.margins = {\r\n      left: ( parseInt( this.element.css( \"marginLeft\" ), 10 ) || 0 ),\r\n      top: ( parseInt( this.element.css( \"marginTop\" ), 10 ) || 0 ),\r\n      right: ( parseInt( this.element.css( \"marginRight\" ), 10 ) || 0 ),\r\n      bottom: ( parseInt( this.element.css( \"marginBottom\" ), 10 ) || 0 )\r\n    };\r\n  },\r\n\r\n  _cacheHelperProportions: function() {\r\n    this.helperProportions = {\r\n      width: this.helper.outerWidth(),\r\n      height: this.helper.outerHeight()\r\n    };\r\n  },\r\n\r\n  _setContainment: function() {\r\n\r\n    var isUserScrollable, c, ce,\r\n      o = this.options,\r\n      document = this.document[ 0 ];\r\n\r\n    this.relativeContainer = null;\r\n\r\n    if ( !o.containment ) {\r\n      this.containment = null;\r\n      return;\r\n    }\r\n\r\n    if ( o.containment === \"window\" ) {\r\n      this.containment = [\r\n        $( window ).scrollLeft() - this.offset.relative.left - this.offset.parent.left,\r\n        $( window ).scrollTop() - this.offset.relative.top - this.offset.parent.top,\r\n        $( window ).scrollLeft() + $( window ).width() -\r\n          this.helperProportions.width - this.margins.left,\r\n        $( window ).scrollTop() +\r\n          ( $( window ).height() || document.body.parentNode.scrollHeight ) -\r\n          this.helperProportions.height - this.margins.top\r\n      ];\r\n      return;\r\n    }\r\n\r\n    if ( o.containment === \"document\" ) {\r\n      this.containment = [\r\n        0,\r\n        0,\r\n        $( document ).width() - this.helperProportions.width - this.margins.left,\r\n        ( $( document ).height() || document.body.parentNode.scrollHeight ) -\r\n          this.helperProportions.height - this.margins.top\r\n      ];\r\n      return;\r\n    }\r\n\r\n    if ( o.containment.constructor === Array ) {\r\n      this.containment = o.containment;\r\n      return;\r\n    }\r\n\r\n    if ( o.containment === \"parent\" ) {\r\n      o.containment = this.helper[ 0 ].parentNode;\r\n    }\r\n\r\n    c = $( o.containment );\r\n    ce = c[ 0 ];\r\n\r\n    if ( !ce ) {\r\n      return;\r\n    }\r\n\r\n    isUserScrollable = /(scroll|auto)/.test( c.css( \"overflow\" ) );\r\n\r\n    this.containment = [\r\n      ( parseInt( c.css( \"borderLeftWidth\" ), 10 ) || 0 ) +\r\n        ( parseInt( c.css( \"paddingLeft\" ), 10 ) || 0 ),\r\n      ( parseInt( c.css( \"borderTopWidth\" ), 10 ) || 0 ) +\r\n        ( parseInt( c.css( \"paddingTop\" ), 10 ) || 0 ),\r\n      ( isUserScrollable ? Math.max( ce.scrollWidth, ce.offsetWidth ) : ce.offsetWidth ) -\r\n        ( parseInt( c.css( \"borderRightWidth\" ), 10 ) || 0 ) -\r\n        ( parseInt( c.css( \"paddingRight\" ), 10 ) || 0 ) -\r\n        this.helperProportions.width -\r\n        this.margins.left -\r\n        this.margins.right,\r\n      ( isUserScrollable ? Math.max( ce.scrollHeight, ce.offsetHeight ) : ce.offsetHeight ) -\r\n        ( parseInt( c.css( \"borderBottomWidth\" ), 10 ) || 0 ) -\r\n        ( parseInt( c.css( \"paddingBottom\" ), 10 ) || 0 ) -\r\n        this.helperProportions.height -\r\n        this.margins.top -\r\n        this.margins.bottom\r\n    ];\r\n    this.relativeContainer = c;\r\n  },\r\n\r\n  _convertPositionTo: function( d, pos ) {\r\n\r\n    if ( !pos ) {\r\n      pos = this.position;\r\n    }\r\n\r\n    var mod = d === \"absolute\" ? 1 : -1,\r\n      scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );\r\n\r\n    return {\r\n      top: (\r\n\r\n        // The absolute mouse position\r\n        pos.top\t+\r\n\r\n        // Only for relative positioned nodes: Relative offset from element to offset parent\r\n        this.offset.relative.top * mod +\r\n\r\n        // The offsetParent's offset without borders (offset + border)\r\n        this.offset.parent.top * mod -\r\n        ( ( this.cssPosition === \"fixed\" ?\r\n          -this.offset.scroll.top :\r\n          ( scrollIsRootNode ? 0 : this.offset.scroll.top ) ) * mod )\r\n      ),\r\n      left: (\r\n\r\n        // The absolute mouse position\r\n        pos.left +\r\n\r\n        // Only for relative positioned nodes: Relative offset from element to offset parent\r\n        this.offset.relative.left * mod +\r\n\r\n        // The offsetParent's offset without borders (offset + border)\r\n        this.offset.parent.left * mod\t-\r\n        ( ( this.cssPosition === \"fixed\" ?\r\n          -this.offset.scroll.left :\r\n          ( scrollIsRootNode ? 0 : this.offset.scroll.left ) ) * mod )\r\n      )\r\n    };\r\n\r\n  },\r\n\r\n  _generatePosition: function( event, constrainPosition ) {\r\n\r\n    var containment, co, top, left,\r\n      o = this.options,\r\n      scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] ),\r\n      pageX = event.pageX,\r\n      pageY = event.pageY;\r\n\r\n    // Cache the scroll\r\n    if ( !scrollIsRootNode || !this.offset.scroll ) {\r\n      this.offset.scroll = {\r\n        top: this.scrollParent.scrollTop(),\r\n        left: this.scrollParent.scrollLeft()\r\n      };\r\n    }\r\n\r\n    /*\r\n     * - Position constraining -\r\n     * Constrain the position to a mix of grid, containment.\r\n     */\r\n\r\n    // If we are not dragging yet, we won't check for options\r\n    if ( constrainPosition ) {\r\n      if ( this.containment ) {\r\n        if ( this.relativeContainer ) {\r\n          co = this.relativeContainer.offset();\r\n          containment = [\r\n            this.containment[ 0 ] + co.left,\r\n            this.containment[ 1 ] + co.top,\r\n            this.containment[ 2 ] + co.left,\r\n            this.containment[ 3 ] + co.top\r\n          ];\r\n        } else {\r\n          containment = this.containment;\r\n        }\r\n\r\n        if ( event.pageX - this.offset.click.left < containment[ 0 ] ) {\r\n          pageX = containment[ 0 ] + this.offset.click.left;\r\n        }\r\n        if ( event.pageY - this.offset.click.top < containment[ 1 ] ) {\r\n          pageY = containment[ 1 ] + this.offset.click.top;\r\n        }\r\n        if ( event.pageX - this.offset.click.left > containment[ 2 ] ) {\r\n          pageX = containment[ 2 ] + this.offset.click.left;\r\n        }\r\n        if ( event.pageY - this.offset.click.top > containment[ 3 ] ) {\r\n          pageY = containment[ 3 ] + this.offset.click.top;\r\n        }\r\n      }\r\n\r\n      if ( o.grid ) {\r\n\r\n        //Check for grid elements set to 0 to prevent divide by 0 error causing invalid\r\n        // argument errors in IE (see ticket #6950)\r\n        top = o.grid[ 1 ] ? this.originalPageY + Math.round( ( pageY -\r\n          this.originalPageY ) / o.grid[ 1 ] ) * o.grid[ 1 ] : this.originalPageY;\r\n        pageY = containment ? ( ( top - this.offset.click.top >= containment[ 1 ] ||\r\n          top - this.offset.click.top > containment[ 3 ] ) ?\r\n            top :\r\n            ( ( top - this.offset.click.top >= containment[ 1 ] ) ?\r\n              top - o.grid[ 1 ] : top + o.grid[ 1 ] ) ) : top;\r\n\r\n        left = o.grid[ 0 ] ? this.originalPageX +\r\n          Math.round( ( pageX - this.originalPageX ) / o.grid[ 0 ] ) * o.grid[ 0 ] :\r\n          this.originalPageX;\r\n        pageX = containment ? ( ( left - this.offset.click.left >= containment[ 0 ] ||\r\n          left - this.offset.click.left > containment[ 2 ] ) ?\r\n            left :\r\n            ( ( left - this.offset.click.left >= containment[ 0 ] ) ?\r\n              left - o.grid[ 0 ] : left + o.grid[ 0 ] ) ) : left;\r\n      }\r\n\r\n      if ( o.axis === \"y\" ) {\r\n        pageX = this.originalPageX;\r\n      }\r\n\r\n      if ( o.axis === \"x\" ) {\r\n        pageY = this.originalPageY;\r\n      }\r\n    }\r\n\r\n    return {\r\n      top: (\r\n\r\n        // The absolute mouse position\r\n        pageY -\r\n\r\n        // Click offset (relative to the element)\r\n        this.offset.click.top -\r\n\r\n        // Only for relative positioned nodes: Relative offset from element to offset parent\r\n        this.offset.relative.top -\r\n\r\n        // The offsetParent's offset without borders (offset + border)\r\n        this.offset.parent.top +\r\n        ( this.cssPosition === \"fixed\" ?\r\n          -this.offset.scroll.top :\r\n          ( scrollIsRootNode ? 0 : this.offset.scroll.top ) )\r\n      ),\r\n      left: (\r\n\r\n        // The absolute mouse position\r\n        pageX -\r\n\r\n        // Click offset (relative to the element)\r\n        this.offset.click.left -\r\n\r\n        // Only for relative positioned nodes: Relative offset from element to offset parent\r\n        this.offset.relative.left -\r\n\r\n        // The offsetParent's offset without borders (offset + border)\r\n        this.offset.parent.left +\r\n        ( this.cssPosition === \"fixed\" ?\r\n          -this.offset.scroll.left :\r\n          ( scrollIsRootNode ? 0 : this.offset.scroll.left ) )\r\n      )\r\n    };\r\n\r\n  },\r\n\r\n  _clear: function() {\r\n    this._removeClass( this.helper, \"ui-draggable-dragging\" );\r\n    if ( this.helper[ 0 ] !== this.element[ 0 ] && !this.cancelHelperRemoval ) {\r\n      this.helper.remove();\r\n    }\r\n    this.helper = null;\r\n    this.cancelHelperRemoval = false;\r\n    if ( this.destroyOnClear ) {\r\n      this.destroy();\r\n    }\r\n  },\r\n\r\n  // From now on bulk stuff - mainly helpers\r\n\r\n  _trigger: function( type, event, ui ) {\r\n    ui = ui || this._uiHash();\r\n    $.ui.plugin.call( this, type, [ event, ui, this ], true );\r\n\r\n    // Absolute position and offset (see #6884 ) have to be recalculated after plugins\r\n    if ( /^(drag|start|stop)/.test( type ) ) {\r\n      this.positionAbs = this._convertPositionTo( \"absolute\" );\r\n      ui.offset = this.positionAbs;\r\n    }\r\n    return $.Widget.prototype._trigger.call( this, type, event, ui );\r\n  },\r\n\r\n  plugins: {},\r\n\r\n  _uiHash: function() {\r\n    return {\r\n      helper: this.helper,\r\n      position: this.position,\r\n      originalPosition: this.originalPosition,\r\n      offset: this.positionAbs\r\n    };\r\n  }\r\n\r\n} );\r\n\r\n$.ui.plugin.add( \"draggable\", \"connectToSortable\", {\r\n  start: function( event, ui, draggable ) {\r\n    var uiSortable = $.extend( {}, ui, {\r\n      item: draggable.element\r\n    } );\r\n\r\n    draggable.sortables = [];\r\n    $( draggable.options.connectToSortable ).each( function() {\r\n      var sortable = $( this ).sortable( \"instance\" );\r\n\r\n      if ( sortable && !sortable.options.disabled ) {\r\n        draggable.sortables.push( sortable );\r\n\r\n        // RefreshPositions is called at drag start to refresh the containerCache\r\n        // which is used in drag. This ensures it's initialized and synchronized\r\n        // with any changes that might have happened on the page since initialization.\r\n        sortable.refreshPositions();\r\n        sortable._trigger( \"activate\", event, uiSortable );\r\n      }\r\n    } );\r\n  },\r\n  stop: function( event, ui, draggable ) {\r\n    var uiSortable = $.extend( {}, ui, {\r\n      item: draggable.element\r\n    } );\r\n\r\n    draggable.cancelHelperRemoval = false;\r\n\r\n    $.each( draggable.sortables, function() {\r\n      var sortable = this;\r\n\r\n      if ( sortable.isOver ) {\r\n        sortable.isOver = 0;\r\n\r\n        // Allow this sortable to handle removing the helper\r\n        draggable.cancelHelperRemoval = true;\r\n        sortable.cancelHelperRemoval = false;\r\n\r\n        // Use _storedCSS To restore properties in the sortable,\r\n        // as this also handles revert (#9675) since the draggable\r\n        // may have modified them in unexpected ways (#8809)\r\n        sortable._storedCSS = {\r\n          position: sortable.placeholder.css( \"position\" ),\r\n          top: sortable.placeholder.css( \"top\" ),\r\n          left: sortable.placeholder.css( \"left\" )\r\n        };\r\n\r\n        sortable._mouseStop( event );\r\n\r\n        // Once drag has ended, the sortable should return to using\r\n        // its original helper, not the shared helper from draggable\r\n        sortable.options.helper = sortable.options._helper;\r\n      } else {\r\n\r\n        // Prevent this Sortable from removing the helper.\r\n        // However, don't set the draggable to remove the helper\r\n        // either as another connected Sortable may yet handle the removal.\r\n        sortable.cancelHelperRemoval = true;\r\n\r\n        sortable._trigger( \"deactivate\", event, uiSortable );\r\n      }\r\n    } );\r\n  },\r\n  drag: function( event, ui, draggable ) {\r\n    $.each( draggable.sortables, function() {\r\n      var innermostIntersecting = false,\r\n        sortable = this;\r\n\r\n      // Copy over variables that sortable's _intersectsWith uses\r\n      sortable.positionAbs = draggable.positionAbs;\r\n      sortable.helperProportions = draggable.helperProportions;\r\n      sortable.offset.click = draggable.offset.click;\r\n\r\n      if ( sortable._intersectsWith( sortable.containerCache ) ) {\r\n        innermostIntersecting = true;\r\n\r\n        $.each( draggable.sortables, function() {\r\n\r\n          // Copy over variables that sortable's _intersectsWith uses\r\n          this.positionAbs = draggable.positionAbs;\r\n          this.helperProportions = draggable.helperProportions;\r\n          this.offset.click = draggable.offset.click;\r\n\r\n          if ( this !== sortable &&\r\n              this._intersectsWith( this.containerCache ) &&\r\n              $.contains( sortable.element[ 0 ], this.element[ 0 ] ) ) {\r\n            innermostIntersecting = false;\r\n          }\r\n\r\n          return innermostIntersecting;\r\n        } );\r\n      }\r\n\r\n      if ( innermostIntersecting ) {\r\n\r\n        // If it intersects, we use a little isOver variable and set it once,\r\n        // so that the move-in stuff gets fired only once.\r\n        if ( !sortable.isOver ) {\r\n          sortable.isOver = 1;\r\n\r\n          // Store draggable's parent in case we need to reappend to it later.\r\n          draggable._parent = ui.helper.parent();\r\n\r\n          sortable.currentItem = ui.helper\r\n            .appendTo( sortable.element )\r\n            .data( \"ui-sortable-item\", true );\r\n\r\n          // Store helper option to later restore it\r\n          sortable.options._helper = sortable.options.helper;\r\n\r\n          sortable.options.helper = function() {\r\n            return ui.helper[ 0 ];\r\n          };\r\n\r\n          // Fire the start events of the sortable with our passed browser event,\r\n          // and our own helper (so it doesn't create a new one)\r\n          event.target = sortable.currentItem[ 0 ];\r\n          sortable._mouseCapture( event, true );\r\n          sortable._mouseStart( event, true, true );\r\n\r\n          // Because the browser event is way off the new appended portlet,\r\n          // modify necessary variables to reflect the changes\r\n          sortable.offset.click.top = draggable.offset.click.top;\r\n          sortable.offset.click.left = draggable.offset.click.left;\r\n          sortable.offset.parent.left -= draggable.offset.parent.left -\r\n            sortable.offset.parent.left;\r\n          sortable.offset.parent.top -= draggable.offset.parent.top -\r\n            sortable.offset.parent.top;\r\n\r\n          draggable._trigger( \"toSortable\", event );\r\n\r\n          // Inform draggable that the helper is in a valid drop zone,\r\n          // used solely in the revert option to handle \"valid/invalid\".\r\n          draggable.dropped = sortable.element;\r\n\r\n          // Need to refreshPositions of all sortables in the case that\r\n          // adding to one sortable changes the location of the other sortables (#9675)\r\n          $.each( draggable.sortables, function() {\r\n            this.refreshPositions();\r\n          } );\r\n\r\n          // Hack so receive/update callbacks work (mostly)\r\n          draggable.currentItem = draggable.element;\r\n          sortable.fromOutside = draggable;\r\n        }\r\n\r\n        if ( sortable.currentItem ) {\r\n          sortable._mouseDrag( event );\r\n\r\n          // Copy the sortable's position because the draggable's can potentially reflect\r\n          // a relative position, while sortable is always absolute, which the dragged\r\n          // element has now become. (#8809)\r\n          ui.position = sortable.position;\r\n        }\r\n      } else {\r\n\r\n        // If it doesn't intersect with the sortable, and it intersected before,\r\n        // we fake the drag stop of the sortable, but make sure it doesn't remove\r\n        // the helper by using cancelHelperRemoval.\r\n        if ( sortable.isOver ) {\r\n\r\n          sortable.isOver = 0;\r\n          sortable.cancelHelperRemoval = true;\r\n\r\n          // Calling sortable's mouseStop would trigger a revert,\r\n          // so revert must be temporarily false until after mouseStop is called.\r\n          sortable.options._revert = sortable.options.revert;\r\n          sortable.options.revert = false;\r\n\r\n          sortable._trigger( \"out\", event, sortable._uiHash( sortable ) );\r\n          sortable._mouseStop( event, true );\r\n\r\n          // Restore sortable behaviors that were modfied\r\n          // when the draggable entered the sortable area (#9481)\r\n          sortable.options.revert = sortable.options._revert;\r\n          sortable.options.helper = sortable.options._helper;\r\n\r\n          if ( sortable.placeholder ) {\r\n            sortable.placeholder.remove();\r\n          }\r\n\r\n          // Restore and recalculate the draggable's offset considering the sortable\r\n          // may have modified them in unexpected ways. (#8809, #10669)\r\n          ui.helper.appendTo( draggable._parent );\r\n          draggable._refreshOffsets( event );\r\n          ui.position = draggable._generatePosition( event, true );\r\n\r\n          draggable._trigger( \"fromSortable\", event );\r\n\r\n          // Inform draggable that the helper is no longer in a valid drop zone\r\n          draggable.dropped = false;\r\n\r\n          // Need to refreshPositions of all sortables just in case removing\r\n          // from one sortable changes the location of other sortables (#9675)\r\n          $.each( draggable.sortables, function() {\r\n            this.refreshPositions();\r\n          } );\r\n        }\r\n      }\r\n    } );\r\n  }\r\n} );\r\n\r\n$.ui.plugin.add( \"draggable\", \"cursor\", {\r\n  start: function( event, ui, instance ) {\r\n    var t = $( \"body\" ),\r\n      o = instance.options;\r\n\r\n    if ( t.css( \"cursor\" ) ) {\r\n      o._cursor = t.css( \"cursor\" );\r\n    }\r\n    t.css( \"cursor\", o.cursor );\r\n  },\r\n  stop: function( event, ui, instance ) {\r\n    var o = instance.options;\r\n    if ( o._cursor ) {\r\n      $( \"body\" ).css( \"cursor\", o._cursor );\r\n    }\r\n  }\r\n} );\r\n\r\n$.ui.plugin.add( \"draggable\", \"opacity\", {\r\n  start: function( event, ui, instance ) {\r\n    var t = $( ui.helper ),\r\n      o = instance.options;\r\n    if ( t.css( \"opacity\" ) ) {\r\n      o._opacity = t.css( \"opacity\" );\r\n    }\r\n    t.css( \"opacity\", o.opacity );\r\n  },\r\n  stop: function( event, ui, instance ) {\r\n    var o = instance.options;\r\n    if ( o._opacity ) {\r\n      $( ui.helper ).css( \"opacity\", o._opacity );\r\n    }\r\n  }\r\n} );\r\n\r\n$.ui.plugin.add( \"draggable\", \"scroll\", {\r\n  start: function( event, ui, i ) {\r\n    if ( !i.scrollParentNotHidden ) {\r\n      i.scrollParentNotHidden = i.helper.scrollParent( false );\r\n    }\r\n\r\n    if ( i.scrollParentNotHidden[ 0 ] !== i.document[ 0 ] &&\r\n        i.scrollParentNotHidden[ 0 ].tagName !== \"HTML\" ) {\r\n      i.overflowOffset = i.scrollParentNotHidden.offset();\r\n    }\r\n  },\r\n  drag: function( event, ui, i  ) {\r\n\r\n    var o = i.options,\r\n      scrolled = false,\r\n      scrollParent = i.scrollParentNotHidden[ 0 ],\r\n      document = i.document[ 0 ];\r\n\r\n    if ( scrollParent !== document && scrollParent.tagName !== \"HTML\" ) {\r\n      if ( !o.axis || o.axis !== \"x\" ) {\r\n        if ( ( i.overflowOffset.top + scrollParent.offsetHeight ) - event.pageY <\r\n            o.scrollSensitivity ) {\r\n          scrollParent.scrollTop = scrolled = scrollParent.scrollTop + o.scrollSpeed;\r\n        } else if ( event.pageY - i.overflowOffset.top < o.scrollSensitivity ) {\r\n          scrollParent.scrollTop = scrolled = scrollParent.scrollTop - o.scrollSpeed;\r\n        }\r\n      }\r\n\r\n      if ( !o.axis || o.axis !== \"y\" ) {\r\n        if ( ( i.overflowOffset.left + scrollParent.offsetWidth ) - event.pageX <\r\n            o.scrollSensitivity ) {\r\n          scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft + o.scrollSpeed;\r\n        } else if ( event.pageX - i.overflowOffset.left < o.scrollSensitivity ) {\r\n          scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft - o.scrollSpeed;\r\n        }\r\n      }\r\n\r\n    } else {\r\n\r\n      if ( !o.axis || o.axis !== \"x\" ) {\r\n        if ( event.pageY - $( document ).scrollTop() < o.scrollSensitivity ) {\r\n          scrolled = $( document ).scrollTop( $( document ).scrollTop() - o.scrollSpeed );\r\n        } else if ( $( window ).height() - ( event.pageY - $( document ).scrollTop() ) <\r\n            o.scrollSensitivity ) {\r\n          scrolled = $( document ).scrollTop( $( document ).scrollTop() + o.scrollSpeed );\r\n        }\r\n      }\r\n\r\n      if ( !o.axis || o.axis !== \"y\" ) {\r\n        if ( event.pageX - $( document ).scrollLeft() < o.scrollSensitivity ) {\r\n          scrolled = $( document ).scrollLeft(\r\n            $( document ).scrollLeft() - o.scrollSpeed\r\n          );\r\n        } else if ( $( window ).width() - ( event.pageX - $( document ).scrollLeft() ) <\r\n            o.scrollSensitivity ) {\r\n          scrolled = $( document ).scrollLeft(\r\n            $( document ).scrollLeft() + o.scrollSpeed\r\n          );\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    if ( scrolled !== false && $.ui.ddmanager && !o.dropBehaviour ) {\r\n      $.ui.ddmanager.prepareOffsets( i, event );\r\n    }\r\n\r\n  }\r\n} );\r\n\r\n$.ui.plugin.add( \"draggable\", \"snap\", {\r\n  start: function( event, ui, i ) {\r\n\r\n    var o = i.options;\r\n\r\n    i.snapElements = [];\r\n\r\n    $( o.snap.constructor !== String ? ( o.snap.items || \":data(ui-draggable)\" ) : o.snap )\r\n      .each( function() {\r\n        var $t = $( this ),\r\n          $o = $t.offset();\r\n        if ( this !== i.element[ 0 ] ) {\r\n          i.snapElements.push( {\r\n            item: this,\r\n            width: $t.outerWidth(), height: $t.outerHeight(),\r\n            top: $o.top, left: $o.left\r\n          } );\r\n        }\r\n      } );\r\n\r\n  },\r\n  drag: function( event, ui, inst ) {\r\n\r\n    var ts, bs, ls, rs, l, r, t, b, i, first,\r\n      o = inst.options,\r\n      d = o.snapTolerance,\r\n      x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,\r\n      y1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;\r\n\r\n    for ( i = inst.snapElements.length - 1; i >= 0; i-- ) {\r\n\r\n      l = inst.snapElements[ i ].left - inst.margins.left;\r\n      r = l + inst.snapElements[ i ].width;\r\n      t = inst.snapElements[ i ].top - inst.margins.top;\r\n      b = t + inst.snapElements[ i ].height;\r\n\r\n      if ( x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d ||\r\n          !$.contains( inst.snapElements[ i ].item.ownerDocument,\r\n          inst.snapElements[ i ].item ) ) {\r\n        if ( inst.snapElements[ i ].snapping ) {\r\n          ( inst.options.snap.release &&\r\n            inst.options.snap.release.call(\r\n              inst.element,\r\n              event,\r\n              $.extend( inst._uiHash(), { snapItem: inst.snapElements[ i ].item } )\r\n            ) );\r\n        }\r\n        inst.snapElements[ i ].snapping = false;\r\n        continue;\r\n      }\r\n\r\n      if ( o.snapMode !== \"inner\" ) {\r\n        ts = Math.abs( t - y2 ) <= d;\r\n        bs = Math.abs( b - y1 ) <= d;\r\n        ls = Math.abs( l - x2 ) <= d;\r\n        rs = Math.abs( r - x1 ) <= d;\r\n        if ( ts ) {\r\n          ui.position.top = inst._convertPositionTo( \"relative\", {\r\n            top: t - inst.helperProportions.height,\r\n            left: 0\r\n          } ).top;\r\n        }\r\n        if ( bs ) {\r\n          ui.position.top = inst._convertPositionTo( \"relative\", {\r\n            top: b,\r\n            left: 0\r\n          } ).top;\r\n        }\r\n        if ( ls ) {\r\n          ui.position.left = inst._convertPositionTo( \"relative\", {\r\n            top: 0,\r\n            left: l - inst.helperProportions.width\r\n          } ).left;\r\n        }\r\n        if ( rs ) {\r\n          ui.position.left = inst._convertPositionTo( \"relative\", {\r\n            top: 0,\r\n            left: r\r\n          } ).left;\r\n        }\r\n      }\r\n\r\n      first = ( ts || bs || ls || rs );\r\n\r\n      if ( o.snapMode !== \"outer\" ) {\r\n        ts = Math.abs( t - y1 ) <= d;\r\n        bs = Math.abs( b - y2 ) <= d;\r\n        ls = Math.abs( l - x1 ) <= d;\r\n        rs = Math.abs( r - x2 ) <= d;\r\n        if ( ts ) {\r\n          ui.position.top = inst._convertPositionTo( \"relative\", {\r\n            top: t,\r\n            left: 0\r\n          } ).top;\r\n        }\r\n        if ( bs ) {\r\n          ui.position.top = inst._convertPositionTo( \"relative\", {\r\n            top: b - inst.helperProportions.height,\r\n            left: 0\r\n          } ).top;\r\n        }\r\n        if ( ls ) {\r\n          ui.position.left = inst._convertPositionTo( \"relative\", {\r\n            top: 0,\r\n            left: l\r\n          } ).left;\r\n        }\r\n        if ( rs ) {\r\n          ui.position.left = inst._convertPositionTo( \"relative\", {\r\n            top: 0,\r\n            left: r - inst.helperProportions.width\r\n          } ).left;\r\n        }\r\n      }\r\n\r\n      if ( !inst.snapElements[ i ].snapping && ( ts || bs || ls || rs || first ) ) {\r\n        ( inst.options.snap.snap &&\r\n          inst.options.snap.snap.call(\r\n            inst.element,\r\n            event,\r\n            $.extend( inst._uiHash(), {\r\n              snapItem: inst.snapElements[ i ].item\r\n            } ) ) );\r\n      }\r\n      inst.snapElements[ i ].snapping = ( ts || bs || ls || rs || first );\r\n\r\n    }\r\n\r\n  }\r\n} );\r\n\r\n$.ui.plugin.add( \"draggable\", \"stack\", {\r\n  start: function( event, ui, instance ) {\r\n    var min,\r\n      o = instance.options,\r\n      group = $.makeArray( $( o.stack ) ).sort( function( a, b ) {\r\n        return ( parseInt( $( a ).css( \"zIndex\" ), 10 ) || 0 ) -\r\n          ( parseInt( $( b ).css( \"zIndex\" ), 10 ) || 0 );\r\n      } );\r\n\r\n    if ( !group.length ) { return; }\r\n\r\n    min = parseInt( $( group[ 0 ] ).css( \"zIndex\" ), 10 ) || 0;\r\n    $( group ).each( function( i ) {\r\n      $( this ).css( \"zIndex\", min + i );\r\n    } );\r\n    this.css( \"zIndex\", ( min + group.length ) );\r\n  }\r\n} );\r\n\r\n$.ui.plugin.add( \"draggable\", \"zIndex\", {\r\n  start: function( event, ui, instance ) {\r\n    var t = $( ui.helper ),\r\n      o = instance.options;\r\n\r\n    if ( t.css( \"zIndex\" ) ) {\r\n      o._zIndex = t.css( \"zIndex\" );\r\n    }\r\n    t.css( \"zIndex\", o.zIndex );\r\n  },\r\n  stop: function( event, ui, instance ) {\r\n    var o = instance.options;\r\n\r\n    if ( o._zIndex ) {\r\n      $( ui.helper ).css( \"zIndex\", o._zIndex );\r\n    }\r\n  }\r\n} );\r\n\r\nvar widgetsDraggable = $.ui.draggable;\r\n\r\n\r\n/*\r\n * jQuery UI Droppable 1.12.1\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: Droppable\r\n//>>group: Interactions\r\n//>>description: Enables drop targets for draggable elements.\r\n//>>docs: http://api.jqueryui.com/droppable/\r\n//>>demos: http://jqueryui.com/droppable/\r\n\r\n\r\n\r\n$.widget( \"ui.droppable\", {\r\n  version: \"1.12.1\",\r\n  widgetEventPrefix: \"drop\",\r\n  options: {\r\n    accept: \"*\",\r\n    addClasses: true,\r\n    greedy: false,\r\n    scope: \"default\",\r\n    tolerance: \"intersect\",\r\n\r\n    // Callbacks\r\n    activate: null,\r\n    deactivate: null,\r\n    drop: null,\r\n    out: null,\r\n    over: null\r\n  },\r\n  _create: function() {\r\n\r\n    var proportions,\r\n      o = this.options,\r\n      accept = o.accept;\r\n\r\n    this.isover = false;\r\n    this.isout = true;\r\n\r\n    this.accept = $.isFunction( accept ) ? accept : function( d ) {\r\n      return d.is( accept );\r\n    };\r\n\r\n    this.proportions = function( /* valueToWrite */ ) {\r\n      if ( arguments.length ) {\r\n\r\n        // Store the droppable's proportions\r\n        proportions = arguments[ 0 ];\r\n      } else {\r\n\r\n        // Retrieve or derive the droppable's proportions\r\n        return proportions ?\r\n          proportions :\r\n          proportions = {\r\n            width: this.element[ 0 ].offsetWidth,\r\n            height: this.element[ 0 ].offsetHeight\r\n          };\r\n      }\r\n    };\r\n\r\n    this._addToManager( o.scope );\r\n\r\n    o.addClasses && this._addClass( \"ui-droppable\" );\r\n\r\n  },\r\n\r\n  _addToManager: function( scope ) {\r\n\r\n    // Add the reference and positions to the manager\r\n    $.ui.ddmanager.droppables[ scope ] = $.ui.ddmanager.droppables[ scope ] || [];\r\n    $.ui.ddmanager.droppables[ scope ].push( this );\r\n  },\r\n\r\n  _splice: function( drop ) {\r\n    var i = 0;\r\n    for ( ; i < drop.length; i++ ) {\r\n      if ( drop[ i ] === this ) {\r\n        drop.splice( i, 1 );\r\n      }\r\n    }\r\n  },\r\n\r\n  _destroy: function() {\r\n    var drop = $.ui.ddmanager.droppables[ this.options.scope ];\r\n\r\n    this._splice( drop );\r\n  },\r\n\r\n  _setOption: function( key, value ) {\r\n\r\n    if ( key === \"accept\" ) {\r\n      this.accept = $.isFunction( value ) ? value : function( d ) {\r\n        return d.is( value );\r\n      };\r\n    } else if ( key === \"scope\" ) {\r\n      var drop = $.ui.ddmanager.droppables[ this.options.scope ];\r\n\r\n      this._splice( drop );\r\n      this._addToManager( value );\r\n    }\r\n\r\n    this._super( key, value );\r\n  },\r\n\r\n  _activate: function( event ) {\r\n    var draggable = $.ui.ddmanager.current;\r\n\r\n    this._addActiveClass();\r\n    if ( draggable ) {\r\n      this._trigger( \"activate\", event, this.ui( draggable ) );\r\n    }\r\n  },\r\n\r\n  _deactivate: function( event ) {\r\n    var draggable = $.ui.ddmanager.current;\r\n\r\n    this._removeActiveClass();\r\n    if ( draggable ) {\r\n      this._trigger( \"deactivate\", event, this.ui( draggable ) );\r\n    }\r\n  },\r\n\r\n  _over: function( event ) {\r\n\r\n    var draggable = $.ui.ddmanager.current;\r\n\r\n    // Bail if draggable and droppable are same element\r\n    if ( !draggable || ( draggable.currentItem ||\r\n        draggable.element )[ 0 ] === this.element[ 0 ] ) {\r\n      return;\r\n    }\r\n\r\n    if ( this.accept.call( this.element[ 0 ], ( draggable.currentItem ||\r\n        draggable.element ) ) ) {\r\n      this._addHoverClass();\r\n      this._trigger( \"over\", event, this.ui( draggable ) );\r\n    }\r\n\r\n  },\r\n\r\n  _out: function( event ) {\r\n\r\n    var draggable = $.ui.ddmanager.current;\r\n\r\n    // Bail if draggable and droppable are same element\r\n    if ( !draggable || ( draggable.currentItem ||\r\n        draggable.element )[ 0 ] === this.element[ 0 ] ) {\r\n      return;\r\n    }\r\n\r\n    if ( this.accept.call( this.element[ 0 ], ( draggable.currentItem ||\r\n        draggable.element ) ) ) {\r\n      this._removeHoverClass();\r\n      this._trigger( \"out\", event, this.ui( draggable ) );\r\n    }\r\n\r\n  },\r\n\r\n  _drop: function( event, custom ) {\r\n\r\n    var draggable = custom || $.ui.ddmanager.current,\r\n      childrenIntersection = false;\r\n\r\n    // Bail if draggable and droppable are same element\r\n    if ( !draggable || ( draggable.currentItem ||\r\n        draggable.element )[ 0 ] === this.element[ 0 ] ) {\r\n      return false;\r\n    }\r\n\r\n    this.element\r\n      .find( \":data(ui-droppable)\" )\r\n      .not( \".ui-draggable-dragging\" )\r\n      .each( function() {\r\n        var inst = $( this ).droppable( \"instance\" );\r\n        if (\r\n          inst.options.greedy &&\r\n          !inst.options.disabled &&\r\n          inst.options.scope === draggable.options.scope &&\r\n          inst.accept.call(\r\n            inst.element[ 0 ], ( draggable.currentItem || draggable.element )\r\n          ) &&\r\n          intersect(\r\n            draggable,\r\n            $.extend( inst, { offset: inst.element.offset() } ),\r\n            inst.options.tolerance, event\r\n          )\r\n        ) {\r\n          childrenIntersection = true;\r\n          return false; }\r\n      } );\r\n    if ( childrenIntersection ) {\r\n      return false;\r\n    }\r\n\r\n    if ( this.accept.call( this.element[ 0 ],\r\n        ( draggable.currentItem || draggable.element ) ) ) {\r\n      this._removeActiveClass();\r\n      this._removeHoverClass();\r\n\r\n      this._trigger( \"drop\", event, this.ui( draggable ) );\r\n      return this.element;\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  ui: function( c ) {\r\n    return {\r\n      draggable: ( c.currentItem || c.element ),\r\n      helper: c.helper,\r\n      position: c.position,\r\n      offset: c.positionAbs\r\n    };\r\n  },\r\n\r\n  // Extension points just to make backcompat sane and avoid duplicating logic\r\n  // TODO: Remove in 1.13 along with call to it below\r\n  _addHoverClass: function() {\r\n    this._addClass( \"ui-droppable-hover\" );\r\n  },\r\n\r\n  _removeHoverClass: function() {\r\n    this._removeClass( \"ui-droppable-hover\" );\r\n  },\r\n\r\n  _addActiveClass: function() {\r\n    this._addClass( \"ui-droppable-active\" );\r\n  },\r\n\r\n  _removeActiveClass: function() {\r\n    this._removeClass( \"ui-droppable-active\" );\r\n  }\r\n} );\r\n\r\nvar intersect = $.ui.intersect = ( function() {\r\n  function isOverAxis( x, reference, size ) {\r\n    return ( x >= reference ) && ( x < ( reference + size ) );\r\n  }\r\n\r\n  return function( draggable, droppable, toleranceMode, event ) {\r\n\r\n    if ( !droppable.offset ) {\r\n      return false;\r\n    }\r\n\r\n    var x1 = ( draggable.positionAbs ||\r\n        draggable.position.absolute ).left + draggable.margins.left,\r\n      y1 = ( draggable.positionAbs ||\r\n        draggable.position.absolute ).top + draggable.margins.top,\r\n      x2 = x1 + draggable.helperProportions.width,\r\n      y2 = y1 + draggable.helperProportions.height,\r\n      l = droppable.offset.left,\r\n      t = droppable.offset.top,\r\n      r = l + droppable.proportions().width,\r\n      b = t + droppable.proportions().height;\r\n\r\n    switch ( toleranceMode ) {\r\n    case \"fit\":\r\n      return ( l <= x1 && x2 <= r && t <= y1 && y2 <= b );\r\n    case \"intersect\":\r\n      return ( l < x1 + ( draggable.helperProportions.width / 2 ) && // Right Half\r\n        x2 - ( draggable.helperProportions.width / 2 ) < r && // Left Half\r\n        t < y1 + ( draggable.helperProportions.height / 2 ) && // Bottom Half\r\n        y2 - ( draggable.helperProportions.height / 2 ) < b ); // Top Half\r\n    case \"pointer\":\r\n      return isOverAxis( event.pageY, t, droppable.proportions().height ) &&\r\n        isOverAxis( event.pageX, l, droppable.proportions().width );\r\n    case \"touch\":\r\n      return (\r\n        ( y1 >= t && y1 <= b ) || // Top edge touching\r\n        ( y2 >= t && y2 <= b ) || // Bottom edge touching\r\n        ( y1 < t && y2 > b ) // Surrounded vertically\r\n      ) && (\r\n        ( x1 >= l && x1 <= r ) || // Left edge touching\r\n        ( x2 >= l && x2 <= r ) || // Right edge touching\r\n        ( x1 < l && x2 > r ) // Surrounded horizontally\r\n      );\r\n    default:\r\n      return false;\r\n    }\r\n  };\r\n} )();\r\n\r\n/*\r\n  This manager tracks offsets of draggables and droppables\r\n*/\r\n$.ui.ddmanager = {\r\n  current: null,\r\n  droppables: { \"default\": [] },\r\n  prepareOffsets: function( t, event ) {\r\n\r\n    var i, j,\r\n      m = $.ui.ddmanager.droppables[ t.options.scope ] || [],\r\n      type = event ? event.type : null, // workaround for #2317\r\n      list = ( t.currentItem || t.element ).find( \":data(ui-droppable)\" ).addBack();\r\n\r\n    droppablesLoop: for ( i = 0; i < m.length; i++ ) {\r\n\r\n      // No disabled and non-accepted\r\n      if ( m[ i ].options.disabled || ( t && !m[ i ].accept.call( m[ i ].element[ 0 ],\r\n          ( t.currentItem || t.element ) ) ) ) {\r\n        continue;\r\n      }\r\n\r\n      // Filter out elements in the current dragged item\r\n      for ( j = 0; j < list.length; j++ ) {\r\n        if ( list[ j ] === m[ i ].element[ 0 ] ) {\r\n          m[ i ].proportions().height = 0;\r\n          continue droppablesLoop;\r\n        }\r\n      }\r\n\r\n      m[ i ].visible = m[ i ].element.css( \"display\" ) !== \"none\";\r\n      if ( !m[ i ].visible ) {\r\n        continue;\r\n      }\r\n\r\n      // Activate the droppable if used directly from draggables\r\n      if ( type === \"mousedown\" ) {\r\n        m[ i ]._activate.call( m[ i ], event );\r\n      }\r\n\r\n      m[ i ].offset = m[ i ].element.offset();\r\n      m[ i ].proportions( {\r\n        width: m[ i ].element[ 0 ].offsetWidth,\r\n        height: m[ i ].element[ 0 ].offsetHeight\r\n      } );\r\n\r\n    }\r\n\r\n  },\r\n  drop: function( draggable, event ) {\r\n\r\n    var dropped = false;\r\n\r\n    // Create a copy of the droppables in case the list changes during the drop (#9116)\r\n    $.each( ( $.ui.ddmanager.droppables[ draggable.options.scope ] || [] ).slice(), function() {\r\n\r\n      if ( !this.options ) {\r\n        return;\r\n      }\r\n      if ( !this.options.disabled && this.visible &&\r\n          intersect( draggable, this, this.options.tolerance, event ) ) {\r\n        dropped = this._drop.call( this, event ) || dropped;\r\n      }\r\n\r\n      if ( !this.options.disabled && this.visible && this.accept.call( this.element[ 0 ],\r\n          ( draggable.currentItem || draggable.element ) ) ) {\r\n        this.isout = true;\r\n        this.isover = false;\r\n        this._deactivate.call( this, event );\r\n      }\r\n\r\n    } );\r\n    return dropped;\r\n\r\n  },\r\n  dragStart: function( draggable, event ) {\r\n\r\n    // Listen for scrolling so that if the dragging causes scrolling the position of the\r\n    // droppables can be recalculated (see #5003)\r\n    draggable.element.parentsUntil( \"body\" ).on( \"scroll.droppable\", function() {\r\n      if ( !draggable.options.refreshPositions ) {\r\n        $.ui.ddmanager.prepareOffsets( draggable, event );\r\n      }\r\n    } );\r\n  },\r\n  drag: function( draggable, event ) {\r\n\r\n    // If you have a highly dynamic page, you might try this option. It renders positions\r\n    // every time you move the mouse.\r\n    if ( draggable.options.refreshPositions ) {\r\n      $.ui.ddmanager.prepareOffsets( draggable, event );\r\n    }\r\n\r\n    // Run through all droppables and check their positions based on specific tolerance options\r\n    $.each( $.ui.ddmanager.droppables[ draggable.options.scope ] || [], function() {\r\n\r\n      if ( this.options.disabled || this.greedyChild || !this.visible ) {\r\n        return;\r\n      }\r\n\r\n      var parentInstance, scope, parent,\r\n        intersects = intersect( draggable, this, this.options.tolerance, event ),\r\n        c = !intersects && this.isover ?\r\n          \"isout\" :\r\n          ( intersects && !this.isover ? \"isover\" : null );\r\n      if ( !c ) {\r\n        return;\r\n      }\r\n\r\n      if ( this.options.greedy ) {\r\n\r\n        // find droppable parents with same scope\r\n        scope = this.options.scope;\r\n        parent = this.element.parents( \":data(ui-droppable)\" ).filter( function() {\r\n          return $( this ).droppable( \"instance\" ).options.scope === scope;\r\n        } );\r\n\r\n        if ( parent.length ) {\r\n          parentInstance = $( parent[ 0 ] ).droppable( \"instance\" );\r\n          parentInstance.greedyChild = ( c === \"isover\" );\r\n        }\r\n      }\r\n\r\n      // We just moved into a greedy child\r\n      if ( parentInstance && c === \"isover\" ) {\r\n        parentInstance.isover = false;\r\n        parentInstance.isout = true;\r\n        parentInstance._out.call( parentInstance, event );\r\n      }\r\n\r\n      this[ c ] = true;\r\n      this[ c === \"isout\" ? \"isover\" : \"isout\" ] = false;\r\n      this[ c === \"isover\" ? \"_over\" : \"_out\" ].call( this, event );\r\n\r\n      // We just moved out of a greedy child\r\n      if ( parentInstance && c === \"isout\" ) {\r\n        parentInstance.isout = false;\r\n        parentInstance.isover = true;\r\n        parentInstance._over.call( parentInstance, event );\r\n      }\r\n    } );\r\n\r\n  },\r\n  dragStop: function( draggable, event ) {\r\n    draggable.element.parentsUntil( \"body\" ).off( \"scroll.droppable\" );\r\n\r\n    // Call prepareOffsets one final time since IE does not fire return scroll events when\r\n    // overflow was caused by drag (see #5003)\r\n    if ( !draggable.options.refreshPositions ) {\r\n      $.ui.ddmanager.prepareOffsets( draggable, event );\r\n    }\r\n  }\r\n};\r\n\r\n// DEPRECATED\r\n// TODO: switch return back to widget declaration at top of file when this is removed\r\nif ( $.uiBackCompat !== false ) {\r\n\r\n  // Backcompat for activeClass and hoverClass options\r\n  $.widget( \"ui.droppable\", $.ui.droppable, {\r\n    options: {\r\n      hoverClass: false,\r\n      activeClass: false\r\n    },\r\n    _addActiveClass: function() {\r\n      this._super();\r\n      if ( this.options.activeClass ) {\r\n        this.element.addClass( this.options.activeClass );\r\n      }\r\n    },\r\n    _removeActiveClass: function() {\r\n      this._super();\r\n      if ( this.options.activeClass ) {\r\n        this.element.removeClass( this.options.activeClass );\r\n      }\r\n    },\r\n    _addHoverClass: function() {\r\n      this._super();\r\n      if ( this.options.hoverClass ) {\r\n        this.element.addClass( this.options.hoverClass );\r\n      }\r\n    },\r\n    _removeHoverClass: function() {\r\n      this._super();\r\n      if ( this.options.hoverClass ) {\r\n        this.element.removeClass( this.options.hoverClass );\r\n      }\r\n    }\r\n  } );\r\n}\r\n\r\nvar widgetsDroppable = $.ui.droppable;\r\n\r\n\r\n/*\r\n * jQuery UI Resizable 1.12.1\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: Resizable\r\n//>>group: Interactions\r\n//>>description: Enables resize functionality for any element.\r\n//>>docs: http://api.jqueryui.com/resizable/\r\n//>>demos: http://jqueryui.com/resizable/\r\n//>>css.structure: ../../themes/base/core.css\r\n//>>css.structure: ../../themes/base/resizable.css\r\n//>>css.theme: ../../themes/base/theme.css\r\n\r\n\r\n\r\n$.widget( \"ui.resizable\", $.ui.mouse, {\r\n  version: \"1.12.1\",\r\n  widgetEventPrefix: \"resize\",\r\n  options: {\r\n    alsoResize: false,\r\n    animate: false,\r\n    animateDuration: \"slow\",\r\n    animateEasing: \"swing\",\r\n    aspectRatio: false,\r\n    autoHide: false,\r\n    classes: {\r\n      \"ui-resizable-se\": \"ui-icon ui-icon-gripsmall-diagonal-se\"\r\n    },\r\n    containment: false,\r\n    ghost: false,\r\n    grid: false,\r\n    handles: \"e,s,se\",\r\n    helper: false,\r\n    maxHeight: null,\r\n    maxWidth: null,\r\n    minHeight: 10,\r\n    minWidth: 10,\r\n\r\n    // See #7960\r\n    zIndex: 90,\r\n\r\n    // Callbacks\r\n    resize: null,\r\n    start: null,\r\n    stop: null\r\n  },\r\n\r\n  _num: function( value ) {\r\n    return parseFloat( value ) || 0;\r\n  },\r\n\r\n  _isNumber: function( value ) {\r\n    return !isNaN( parseFloat( value ) );\r\n  },\r\n\r\n  _hasScroll: function( el, a ) {\r\n\r\n    if ( $( el ).css( \"overflow\" ) === \"hidden\" ) {\r\n      return false;\r\n    }\r\n\r\n    var scroll = ( a && a === \"left\" ) ? \"scrollLeft\" : \"scrollTop\",\r\n      has = false;\r\n\r\n    if ( el[ scroll ] > 0 ) {\r\n      return true;\r\n    }\r\n\r\n    // TODO: determine which cases actually cause this to happen\r\n    // if the element doesn't have the scroll set, see if it's possible to\r\n    // set the scroll\r\n    el[ scroll ] = 1;\r\n    has = ( el[ scroll ] > 0 );\r\n    el[ scroll ] = 0;\r\n    return has;\r\n  },\r\n\r\n  _create: function() {\r\n\r\n    var margins,\r\n      o = this.options,\r\n      that = this;\r\n    this._addClass( \"ui-resizable\" );\r\n\r\n    $.extend( this, {\r\n      _aspectRatio: !!( o.aspectRatio ),\r\n      aspectRatio: o.aspectRatio,\r\n      originalElement: this.element,\r\n      _proportionallyResizeElements: [],\r\n      _helper: o.helper || o.ghost || o.animate ? o.helper || \"ui-resizable-helper\" : null\r\n    } );\r\n\r\n    // Wrap the element if it cannot hold child nodes\r\n    if ( this.element[ 0 ].nodeName.match( /^(canvas|textarea|input|select|button|img)$/i ) ) {\r\n\r\n      this.element.wrap(\r\n        $( \"<div class='ui-wrapper' style='overflow: hidden;'></div>\" ).css( {\r\n          position: this.element.css( \"position\" ),\r\n          width: this.element.outerWidth(),\r\n          height: this.element.outerHeight(),\r\n          top: this.element.css( \"top\" ),\r\n          left: this.element.css( \"left\" )\r\n        } )\r\n      );\r\n\r\n      this.element = this.element.parent().data(\r\n        \"ui-resizable\", this.element.resizable( \"instance\" )\r\n      );\r\n\r\n      this.elementIsWrapper = true;\r\n\r\n      margins = {\r\n        marginTop: this.originalElement.css( \"marginTop\" ),\r\n        marginRight: this.originalElement.css( \"marginRight\" ),\r\n        marginBottom: this.originalElement.css( \"marginBottom\" ),\r\n        marginLeft: this.originalElement.css( \"marginLeft\" )\r\n      };\r\n\r\n      this.element.css( margins );\r\n      this.originalElement.css( \"margin\", 0 );\r\n\r\n      // support: Safari\r\n      // Prevent Safari textarea resize\r\n      this.originalResizeStyle = this.originalElement.css( \"resize\" );\r\n      this.originalElement.css( \"resize\", \"none\" );\r\n\r\n      this._proportionallyResizeElements.push( this.originalElement.css( {\r\n        position: \"static\",\r\n        zoom: 1,\r\n        display: \"block\"\r\n      } ) );\r\n\r\n      // Support: IE9\r\n      // avoid IE jump (hard set the margin)\r\n      this.originalElement.css( margins );\r\n\r\n      this._proportionallyResize();\r\n    }\r\n\r\n    this._setupHandles();\r\n\r\n    if ( o.autoHide ) {\r\n      $( this.element )\r\n        .on( \"mouseenter\", function() {\r\n          if ( o.disabled ) {\r\n            return;\r\n          }\r\n          that._removeClass( \"ui-resizable-autohide\" );\r\n          that._handles.show();\r\n        } )\r\n        .on( \"mouseleave\", function() {\r\n          if ( o.disabled ) {\r\n            return;\r\n          }\r\n          if ( !that.resizing ) {\r\n            that._addClass( \"ui-resizable-autohide\" );\r\n            that._handles.hide();\r\n          }\r\n        } );\r\n    }\r\n\r\n    this._mouseInit();\r\n  },\r\n\r\n  _destroy: function() {\r\n\r\n    this._mouseDestroy();\r\n\r\n    var wrapper,\r\n      _destroy = function( exp ) {\r\n        $( exp )\r\n          .removeData( \"resizable\" )\r\n          .removeData( \"ui-resizable\" )\r\n          .off( \".resizable\" )\r\n          .find( \".ui-resizable-handle\" )\r\n            .remove();\r\n      };\r\n\r\n    // TODO: Unwrap at same DOM position\r\n    if ( this.elementIsWrapper ) {\r\n      _destroy( this.element );\r\n      wrapper = this.element;\r\n      this.originalElement.css( {\r\n        position: wrapper.css( \"position\" ),\r\n        width: wrapper.outerWidth(),\r\n        height: wrapper.outerHeight(),\r\n        top: wrapper.css( \"top\" ),\r\n        left: wrapper.css( \"left\" )\r\n      } ).insertAfter( wrapper );\r\n      wrapper.remove();\r\n    }\r\n\r\n    this.originalElement.css( \"resize\", this.originalResizeStyle );\r\n    _destroy( this.originalElement );\r\n\r\n    return this;\r\n  },\r\n\r\n  _setOption: function( key, value ) {\r\n    this._super( key, value );\r\n\r\n    switch ( key ) {\r\n    case \"handles\":\r\n      this._removeHandles();\r\n      this._setupHandles();\r\n      break;\r\n    default:\r\n      break;\r\n    }\r\n  },\r\n\r\n  _setupHandles: function() {\r\n    var o = this.options, handle, i, n, hname, axis, that = this;\r\n    this.handles = o.handles ||\r\n      ( !$( \".ui-resizable-handle\", this.element ).length ?\r\n        \"e,s,se\" : {\r\n          n: \".ui-resizable-n\",\r\n          e: \".ui-resizable-e\",\r\n          s: \".ui-resizable-s\",\r\n          w: \".ui-resizable-w\",\r\n          se: \".ui-resizable-se\",\r\n          sw: \".ui-resizable-sw\",\r\n          ne: \".ui-resizable-ne\",\r\n          nw: \".ui-resizable-nw\"\r\n        } );\r\n\r\n    this._handles = $();\r\n    if ( this.handles.constructor === String ) {\r\n\r\n      if ( this.handles === \"all\" ) {\r\n        this.handles = \"n,e,s,w,se,sw,ne,nw\";\r\n      }\r\n\r\n      n = this.handles.split( \",\" );\r\n      this.handles = {};\r\n\r\n      for ( i = 0; i < n.length; i++ ) {\r\n\r\n        handle = $.trim( n[ i ] );\r\n        hname = \"ui-resizable-\" + handle;\r\n        axis = $( \"<div>\" );\r\n        this._addClass( axis, \"ui-resizable-handle \" + hname );\r\n\r\n        axis.css( { zIndex: o.zIndex } );\r\n\r\n        this.handles[ handle ] = \".ui-resizable-\" + handle;\r\n        this.element.append( axis );\r\n      }\r\n\r\n    }\r\n\r\n    this._renderAxis = function( target ) {\r\n\r\n      var i, axis, padPos, padWrapper;\r\n\r\n      target = target || this.element;\r\n\r\n      for ( i in this.handles ) {\r\n\r\n        if ( this.handles[ i ].constructor === String ) {\r\n          this.handles[ i ] = this.element.children( this.handles[ i ] ).first().show();\r\n        } else if ( this.handles[ i ].jquery || this.handles[ i ].nodeType ) {\r\n          this.handles[ i ] = $( this.handles[ i ] );\r\n          this._on( this.handles[ i ], { \"mousedown\": that._mouseDown } );\r\n        }\r\n\r\n        if ( this.elementIsWrapper &&\r\n            this.originalElement[ 0 ]\r\n              .nodeName\r\n              .match( /^(textarea|input|select|button)$/i ) ) {\r\n          axis = $( this.handles[ i ], this.element );\r\n\r\n          padWrapper = /sw|ne|nw|se|n|s/.test( i ) ?\r\n            axis.outerHeight() :\r\n            axis.outerWidth();\r\n\r\n          padPos = [ \"padding\",\r\n            /ne|nw|n/.test( i ) ? \"Top\" :\r\n            /se|sw|s/.test( i ) ? \"Bottom\" :\r\n            /^e$/.test( i ) ? \"Right\" : \"Left\" ].join( \"\" );\r\n\r\n          target.css( padPos, padWrapper );\r\n\r\n          this._proportionallyResize();\r\n        }\r\n\r\n        this._handles = this._handles.add( this.handles[ i ] );\r\n      }\r\n    };\r\n\r\n    // TODO: make renderAxis a prototype function\r\n    this._renderAxis( this.element );\r\n\r\n    this._handles = this._handles.add( this.element.find( \".ui-resizable-handle\" ) );\r\n    this._handles.disableSelection();\r\n\r\n    this._handles.on( \"mouseover\", function() {\r\n      if ( !that.resizing ) {\r\n        if ( this.className ) {\r\n          axis = this.className.match( /ui-resizable-(se|sw|ne|nw|n|e|s|w)/i );\r\n        }\r\n        that.axis = axis && axis[ 1 ] ? axis[ 1 ] : \"se\";\r\n      }\r\n    } );\r\n\r\n    if ( o.autoHide ) {\r\n      this._handles.hide();\r\n      this._addClass( \"ui-resizable-autohide\" );\r\n    }\r\n  },\r\n\r\n  _removeHandles: function() {\r\n    this._handles.remove();\r\n  },\r\n\r\n  _mouseCapture: function( event ) {\r\n    var i, handle,\r\n      capture = false;\r\n\r\n    for ( i in this.handles ) {\r\n      handle = $( this.handles[ i ] )[ 0 ];\r\n      if ( handle === event.target || $.contains( handle, event.target ) ) {\r\n        capture = true;\r\n      }\r\n    }\r\n\r\n    return !this.options.disabled && capture;\r\n  },\r\n\r\n  _mouseStart: function( event ) {\r\n\r\n    var curleft, curtop, cursor,\r\n      o = this.options,\r\n      el = this.element;\r\n\r\n    this.resizing = true;\r\n\r\n    this._renderProxy();\r\n\r\n    curleft = this._num( this.helper.css( \"left\" ) );\r\n    curtop = this._num( this.helper.css( \"top\" ) );\r\n\r\n    if ( o.containment ) {\r\n      curleft += $( o.containment ).scrollLeft() || 0;\r\n      curtop += $( o.containment ).scrollTop() || 0;\r\n    }\r\n\r\n    this.offset = this.helper.offset();\r\n    this.position = { left: curleft, top: curtop };\r\n\r\n    this.size = this._helper ? {\r\n        width: this.helper.width(),\r\n        height: this.helper.height()\r\n      } : {\r\n        width: el.width(),\r\n        height: el.height()\r\n      };\r\n\r\n    this.originalSize = this._helper ? {\r\n        width: el.outerWidth(),\r\n        height: el.outerHeight()\r\n      } : {\r\n        width: el.width(),\r\n        height: el.height()\r\n      };\r\n\r\n    this.sizeDiff = {\r\n      width: el.outerWidth() - el.width(),\r\n      height: el.outerHeight() - el.height()\r\n    };\r\n\r\n    this.originalPosition = { left: curleft, top: curtop };\r\n    this.originalMousePosition = { left: event.pageX, top: event.pageY };\r\n\r\n    this.aspectRatio = ( typeof o.aspectRatio === \"number\" ) ?\r\n      o.aspectRatio :\r\n      ( ( this.originalSize.width / this.originalSize.height ) || 1 );\r\n\r\n    cursor = $( \".ui-resizable-\" + this.axis ).css( \"cursor\" );\r\n    $( \"body\" ).css( \"cursor\", cursor === \"auto\" ? this.axis + \"-resize\" : cursor );\r\n\r\n    this._addClass( \"ui-resizable-resizing\" );\r\n    this._propagate( \"start\", event );\r\n    return true;\r\n  },\r\n\r\n  _mouseDrag: function( event ) {\r\n\r\n    var data, props,\r\n      smp = this.originalMousePosition,\r\n      a = this.axis,\r\n      dx = ( event.pageX - smp.left ) || 0,\r\n      dy = ( event.pageY - smp.top ) || 0,\r\n      trigger = this._change[ a ];\r\n\r\n    this._updatePrevProperties();\r\n\r\n    if ( !trigger ) {\r\n      return false;\r\n    }\r\n\r\n    data = trigger.apply( this, [ event, dx, dy ] );\r\n\r\n    this._updateVirtualBoundaries( event.shiftKey );\r\n    if ( this._aspectRatio || event.shiftKey ) {\r\n      data = this._updateRatio( data, event );\r\n    }\r\n\r\n    data = this._respectSize( data, event );\r\n\r\n    this._updateCache( data );\r\n\r\n    this._propagate( \"resize\", event );\r\n\r\n    props = this._applyChanges();\r\n\r\n    if ( !this._helper && this._proportionallyResizeElements.length ) {\r\n      this._proportionallyResize();\r\n    }\r\n\r\n    if ( !$.isEmptyObject( props ) ) {\r\n      this._updatePrevProperties();\r\n      this._trigger( \"resize\", event, this.ui() );\r\n      this._applyChanges();\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  _mouseStop: function( event ) {\r\n\r\n    this.resizing = false;\r\n    var pr, ista, soffseth, soffsetw, s, left, top,\r\n      o = this.options, that = this;\r\n\r\n    if ( this._helper ) {\r\n\r\n      pr = this._proportionallyResizeElements;\r\n      ista = pr.length && ( /textarea/i ).test( pr[ 0 ].nodeName );\r\n      soffseth = ista && this._hasScroll( pr[ 0 ], \"left\" ) ? 0 : that.sizeDiff.height;\r\n      soffsetw = ista ? 0 : that.sizeDiff.width;\r\n\r\n      s = {\r\n        width: ( that.helper.width()  - soffsetw ),\r\n        height: ( that.helper.height() - soffseth )\r\n      };\r\n      left = ( parseFloat( that.element.css( \"left\" ) ) +\r\n        ( that.position.left - that.originalPosition.left ) ) || null;\r\n      top = ( parseFloat( that.element.css( \"top\" ) ) +\r\n        ( that.position.top - that.originalPosition.top ) ) || null;\r\n\r\n      if ( !o.animate ) {\r\n        this.element.css( $.extend( s, { top: top, left: left } ) );\r\n      }\r\n\r\n      that.helper.height( that.size.height );\r\n      that.helper.width( that.size.width );\r\n\r\n      if ( this._helper && !o.animate ) {\r\n        this._proportionallyResize();\r\n      }\r\n    }\r\n\r\n    $( \"body\" ).css( \"cursor\", \"auto\" );\r\n\r\n    this._removeClass( \"ui-resizable-resizing\" );\r\n\r\n    this._propagate( \"stop\", event );\r\n\r\n    if ( this._helper ) {\r\n      this.helper.remove();\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  _updatePrevProperties: function() {\r\n    this.prevPosition = {\r\n      top: this.position.top,\r\n      left: this.position.left\r\n    };\r\n    this.prevSize = {\r\n      width: this.size.width,\r\n      height: this.size.height\r\n    };\r\n  },\r\n\r\n  _applyChanges: function() {\r\n    var props = {};\r\n\r\n    if ( this.position.top !== this.prevPosition.top ) {\r\n      props.top = this.position.top + \"px\";\r\n    }\r\n    if ( this.position.left !== this.prevPosition.left ) {\r\n      props.left = this.position.left + \"px\";\r\n    }\r\n    if ( this.size.width !== this.prevSize.width ) {\r\n      props.width = this.size.width + \"px\";\r\n    }\r\n    if ( this.size.height !== this.prevSize.height ) {\r\n      props.height = this.size.height + \"px\";\r\n    }\r\n\r\n    this.helper.css( props );\r\n\r\n    return props;\r\n  },\r\n\r\n  _updateVirtualBoundaries: function( forceAspectRatio ) {\r\n    var pMinWidth, pMaxWidth, pMinHeight, pMaxHeight, b,\r\n      o = this.options;\r\n\r\n    b = {\r\n      minWidth: this._isNumber( o.minWidth ) ? o.minWidth : 0,\r\n      maxWidth: this._isNumber( o.maxWidth ) ? o.maxWidth : Infinity,\r\n      minHeight: this._isNumber( o.minHeight ) ? o.minHeight : 0,\r\n      maxHeight: this._isNumber( o.maxHeight ) ? o.maxHeight : Infinity\r\n    };\r\n\r\n    if ( this._aspectRatio || forceAspectRatio ) {\r\n      pMinWidth = b.minHeight * this.aspectRatio;\r\n      pMinHeight = b.minWidth / this.aspectRatio;\r\n      pMaxWidth = b.maxHeight * this.aspectRatio;\r\n      pMaxHeight = b.maxWidth / this.aspectRatio;\r\n\r\n      if ( pMinWidth > b.minWidth ) {\r\n        b.minWidth = pMinWidth;\r\n      }\r\n      if ( pMinHeight > b.minHeight ) {\r\n        b.minHeight = pMinHeight;\r\n      }\r\n      if ( pMaxWidth < b.maxWidth ) {\r\n        b.maxWidth = pMaxWidth;\r\n      }\r\n      if ( pMaxHeight < b.maxHeight ) {\r\n        b.maxHeight = pMaxHeight;\r\n      }\r\n    }\r\n    this._vBoundaries = b;\r\n  },\r\n\r\n  _updateCache: function( data ) {\r\n    this.offset = this.helper.offset();\r\n    if ( this._isNumber( data.left ) ) {\r\n      this.position.left = data.left;\r\n    }\r\n    if ( this._isNumber( data.top ) ) {\r\n      this.position.top = data.top;\r\n    }\r\n    if ( this._isNumber( data.height ) ) {\r\n      this.size.height = data.height;\r\n    }\r\n    if ( this._isNumber( data.width ) ) {\r\n      this.size.width = data.width;\r\n    }\r\n  },\r\n\r\n  _updateRatio: function( data ) {\r\n\r\n    var cpos = this.position,\r\n      csize = this.size,\r\n      a = this.axis;\r\n\r\n    if ( this._isNumber( data.height ) ) {\r\n      data.width = ( data.height * this.aspectRatio );\r\n    } else if ( this._isNumber( data.width ) ) {\r\n      data.height = ( data.width / this.aspectRatio );\r\n    }\r\n\r\n    if ( a === \"sw\" ) {\r\n      data.left = cpos.left + ( csize.width - data.width );\r\n      data.top = null;\r\n    }\r\n    if ( a === \"nw\" ) {\r\n      data.top = cpos.top + ( csize.height - data.height );\r\n      data.left = cpos.left + ( csize.width - data.width );\r\n    }\r\n\r\n    return data;\r\n  },\r\n\r\n  _respectSize: function( data ) {\r\n\r\n    var o = this._vBoundaries,\r\n      a = this.axis,\r\n      ismaxw = this._isNumber( data.width ) && o.maxWidth && ( o.maxWidth < data.width ),\r\n      ismaxh = this._isNumber( data.height ) && o.maxHeight && ( o.maxHeight < data.height ),\r\n      isminw = this._isNumber( data.width ) && o.minWidth && ( o.minWidth > data.width ),\r\n      isminh = this._isNumber( data.height ) && o.minHeight && ( o.minHeight > data.height ),\r\n      dw = this.originalPosition.left + this.originalSize.width,\r\n      dh = this.originalPosition.top + this.originalSize.height,\r\n      cw = /sw|nw|w/.test( a ), ch = /nw|ne|n/.test( a );\r\n    if ( isminw ) {\r\n      data.width = o.minWidth;\r\n    }\r\n    if ( isminh ) {\r\n      data.height = o.minHeight;\r\n    }\r\n    if ( ismaxw ) {\r\n      data.width = o.maxWidth;\r\n    }\r\n    if ( ismaxh ) {\r\n      data.height = o.maxHeight;\r\n    }\r\n\r\n    if ( isminw && cw ) {\r\n      data.left = dw - o.minWidth;\r\n    }\r\n    if ( ismaxw && cw ) {\r\n      data.left = dw - o.maxWidth;\r\n    }\r\n    if ( isminh && ch ) {\r\n      data.top = dh - o.minHeight;\r\n    }\r\n    if ( ismaxh && ch ) {\r\n      data.top = dh - o.maxHeight;\r\n    }\r\n\r\n    // Fixing jump error on top/left - bug #2330\r\n    if ( !data.width && !data.height && !data.left && data.top ) {\r\n      data.top = null;\r\n    } else if ( !data.width && !data.height && !data.top && data.left ) {\r\n      data.left = null;\r\n    }\r\n\r\n    return data;\r\n  },\r\n\r\n  _getPaddingPlusBorderDimensions: function( element ) {\r\n    var i = 0,\r\n      widths = [],\r\n      borders = [\r\n        element.css( \"borderTopWidth\" ),\r\n        element.css( \"borderRightWidth\" ),\r\n        element.css( \"borderBottomWidth\" ),\r\n        element.css( \"borderLeftWidth\" )\r\n      ],\r\n      paddings = [\r\n        element.css( \"paddingTop\" ),\r\n        element.css( \"paddingRight\" ),\r\n        element.css( \"paddingBottom\" ),\r\n        element.css( \"paddingLeft\" )\r\n      ];\r\n\r\n    for ( ; i < 4; i++ ) {\r\n      widths[ i ] = ( parseFloat( borders[ i ] ) || 0 );\r\n      widths[ i ] += ( parseFloat( paddings[ i ] ) || 0 );\r\n    }\r\n\r\n    return {\r\n      height: widths[ 0 ] + widths[ 2 ],\r\n      width: widths[ 1 ] + widths[ 3 ]\r\n    };\r\n  },\r\n\r\n  _proportionallyResize: function() {\r\n\r\n    if ( !this._proportionallyResizeElements.length ) {\r\n      return;\r\n    }\r\n\r\n    var prel,\r\n      i = 0,\r\n      element = this.helper || this.element;\r\n\r\n    for ( ; i < this._proportionallyResizeElements.length; i++ ) {\r\n\r\n      prel = this._proportionallyResizeElements[ i ];\r\n\r\n      // TODO: Seems like a bug to cache this.outerDimensions\r\n      // considering that we are in a loop.\r\n      if ( !this.outerDimensions ) {\r\n        this.outerDimensions = this._getPaddingPlusBorderDimensions( prel );\r\n      }\r\n\r\n      prel.css( {\r\n        height: ( element.height() - this.outerDimensions.height ) || 0,\r\n        width: ( element.width() - this.outerDimensions.width ) || 0\r\n      } );\r\n\r\n    }\r\n\r\n  },\r\n\r\n  _renderProxy: function() {\r\n\r\n    var el = this.element, o = this.options;\r\n    this.elementOffset = el.offset();\r\n\r\n    if ( this._helper ) {\r\n\r\n      this.helper = this.helper || $( \"<div style='overflow:hidden;'></div>\" );\r\n\r\n      this._addClass( this.helper, this._helper );\r\n      this.helper.css( {\r\n        width: this.element.outerWidth(),\r\n        height: this.element.outerHeight(),\r\n        position: \"absolute\",\r\n        left: this.elementOffset.left + \"px\",\r\n        top: this.elementOffset.top + \"px\",\r\n        zIndex: ++o.zIndex //TODO: Don't modify option\r\n      } );\r\n\r\n      this.helper\r\n        .appendTo( \"body\" )\r\n        .disableSelection();\r\n\r\n    } else {\r\n      this.helper = this.element;\r\n    }\r\n\r\n  },\r\n\r\n  _change: {\r\n    e: function( event, dx ) {\r\n      return { width: this.originalSize.width + dx };\r\n    },\r\n    w: function( event, dx ) {\r\n      var cs = this.originalSize, sp = this.originalPosition;\r\n      return { left: sp.left + dx, width: cs.width - dx };\r\n    },\r\n    n: function( event, dx, dy ) {\r\n      var cs = this.originalSize, sp = this.originalPosition;\r\n      return { top: sp.top + dy, height: cs.height - dy };\r\n    },\r\n    s: function( event, dx, dy ) {\r\n      return { height: this.originalSize.height + dy };\r\n    },\r\n    se: function( event, dx, dy ) {\r\n      return $.extend( this._change.s.apply( this, arguments ),\r\n        this._change.e.apply( this, [ event, dx, dy ] ) );\r\n    },\r\n    sw: function( event, dx, dy ) {\r\n      return $.extend( this._change.s.apply( this, arguments ),\r\n        this._change.w.apply( this, [ event, dx, dy ] ) );\r\n    },\r\n    ne: function( event, dx, dy ) {\r\n      return $.extend( this._change.n.apply( this, arguments ),\r\n        this._change.e.apply( this, [ event, dx, dy ] ) );\r\n    },\r\n    nw: function( event, dx, dy ) {\r\n      return $.extend( this._change.n.apply( this, arguments ),\r\n        this._change.w.apply( this, [ event, dx, dy ] ) );\r\n    }\r\n  },\r\n\r\n  _propagate: function( n, event ) {\r\n    $.ui.plugin.call( this, n, [ event, this.ui() ] );\r\n    ( n !== \"resize\" && this._trigger( n, event, this.ui() ) );\r\n  },\r\n\r\n  plugins: {},\r\n\r\n  ui: function() {\r\n    return {\r\n      originalElement: this.originalElement,\r\n      element: this.element,\r\n      helper: this.helper,\r\n      position: this.position,\r\n      size: this.size,\r\n      originalSize: this.originalSize,\r\n      originalPosition: this.originalPosition\r\n    };\r\n  }\r\n\r\n} );\r\n\r\n/*\r\n * Resizable Extensions\r\n */\r\n\r\n$.ui.plugin.add( \"resizable\", \"animate\", {\r\n\r\n  stop: function( event ) {\r\n    var that = $( this ).resizable( \"instance\" ),\r\n      o = that.options,\r\n      pr = that._proportionallyResizeElements,\r\n      ista = pr.length && ( /textarea/i ).test( pr[ 0 ].nodeName ),\r\n      soffseth = ista && that._hasScroll( pr[ 0 ], \"left\" ) ? 0 : that.sizeDiff.height,\r\n      soffsetw = ista ? 0 : that.sizeDiff.width,\r\n      style = {\r\n        width: ( that.size.width - soffsetw ),\r\n        height: ( that.size.height - soffseth )\r\n      },\r\n      left = ( parseFloat( that.element.css( \"left\" ) ) +\r\n        ( that.position.left - that.originalPosition.left ) ) || null,\r\n      top = ( parseFloat( that.element.css( \"top\" ) ) +\r\n        ( that.position.top - that.originalPosition.top ) ) || null;\r\n\r\n    that.element.animate(\r\n      $.extend( style, top && left ? { top: top, left: left } : {} ), {\r\n        duration: o.animateDuration,\r\n        easing: o.animateEasing,\r\n        step: function() {\r\n\r\n          var data = {\r\n            width: parseFloat( that.element.css( \"width\" ) ),\r\n            height: parseFloat( that.element.css( \"height\" ) ),\r\n            top: parseFloat( that.element.css( \"top\" ) ),\r\n            left: parseFloat( that.element.css( \"left\" ) )\r\n          };\r\n\r\n          if ( pr && pr.length ) {\r\n            $( pr[ 0 ] ).css( { width: data.width, height: data.height } );\r\n          }\r\n\r\n          // Propagating resize, and updating values for each animation step\r\n          that._updateCache( data );\r\n          that._propagate( \"resize\", event );\r\n\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n} );\r\n\r\n$.ui.plugin.add( \"resizable\", \"containment\", {\r\n\r\n  start: function() {\r\n    var element, p, co, ch, cw, width, height,\r\n      that = $( this ).resizable( \"instance\" ),\r\n      o = that.options,\r\n      el = that.element,\r\n      oc = o.containment,\r\n      ce = ( oc instanceof $ ) ?\r\n        oc.get( 0 ) :\r\n        ( /parent/.test( oc ) ) ? el.parent().get( 0 ) : oc;\r\n\r\n    if ( !ce ) {\r\n      return;\r\n    }\r\n\r\n    that.containerElement = $( ce );\r\n\r\n    if ( /document/.test( oc ) || oc === document ) {\r\n      that.containerOffset = {\r\n        left: 0,\r\n        top: 0\r\n      };\r\n      that.containerPosition = {\r\n        left: 0,\r\n        top: 0\r\n      };\r\n\r\n      that.parentData = {\r\n        element: $( document ),\r\n        left: 0,\r\n        top: 0,\r\n        width: $( document ).width(),\r\n        height: $( document ).height() || document.body.parentNode.scrollHeight\r\n      };\r\n    } else {\r\n      element = $( ce );\r\n      p = [];\r\n      $( [ \"Top\", \"Right\", \"Left\", \"Bottom\" ] ).each( function( i, name ) {\r\n        p[ i ] = that._num( element.css( \"padding\" + name ) );\r\n      } );\r\n\r\n      that.containerOffset = element.offset();\r\n      that.containerPosition = element.position();\r\n      that.containerSize = {\r\n        height: ( element.innerHeight() - p[ 3 ] ),\r\n        width: ( element.innerWidth() - p[ 1 ] )\r\n      };\r\n\r\n      co = that.containerOffset;\r\n      ch = that.containerSize.height;\r\n      cw = that.containerSize.width;\r\n      width = ( that._hasScroll ( ce, \"left\" ) ? ce.scrollWidth : cw );\r\n      height = ( that._hasScroll ( ce ) ? ce.scrollHeight : ch ) ;\r\n\r\n      that.parentData = {\r\n        element: ce,\r\n        left: co.left,\r\n        top: co.top,\r\n        width: width,\r\n        height: height\r\n      };\r\n    }\r\n  },\r\n\r\n  resize: function( event ) {\r\n    var woset, hoset, isParent, isOffsetRelative,\r\n      that = $( this ).resizable( \"instance\" ),\r\n      o = that.options,\r\n      co = that.containerOffset,\r\n      cp = that.position,\r\n      pRatio = that._aspectRatio || event.shiftKey,\r\n      cop = {\r\n        top: 0,\r\n        left: 0\r\n      },\r\n      ce = that.containerElement,\r\n      continueResize = true;\r\n\r\n    if ( ce[ 0 ] !== document && ( /static/ ).test( ce.css( \"position\" ) ) ) {\r\n      cop = co;\r\n    }\r\n\r\n    if ( cp.left < ( that._helper ? co.left : 0 ) ) {\r\n      that.size.width = that.size.width +\r\n        ( that._helper ?\r\n          ( that.position.left - co.left ) :\r\n          ( that.position.left - cop.left ) );\r\n\r\n      if ( pRatio ) {\r\n        that.size.height = that.size.width / that.aspectRatio;\r\n        continueResize = false;\r\n      }\r\n      that.position.left = o.helper ? co.left : 0;\r\n    }\r\n\r\n    if ( cp.top < ( that._helper ? co.top : 0 ) ) {\r\n      that.size.height = that.size.height +\r\n        ( that._helper ?\r\n          ( that.position.top - co.top ) :\r\n          that.position.top );\r\n\r\n      if ( pRatio ) {\r\n        that.size.width = that.size.height * that.aspectRatio;\r\n        continueResize = false;\r\n      }\r\n      that.position.top = that._helper ? co.top : 0;\r\n    }\r\n\r\n    isParent = that.containerElement.get( 0 ) === that.element.parent().get( 0 );\r\n    isOffsetRelative = /relative|absolute/.test( that.containerElement.css( \"position\" ) );\r\n\r\n    if ( isParent && isOffsetRelative ) {\r\n      that.offset.left = that.parentData.left + that.position.left;\r\n      that.offset.top = that.parentData.top + that.position.top;\r\n    } else {\r\n      that.offset.left = that.element.offset().left;\r\n      that.offset.top = that.element.offset().top;\r\n    }\r\n\r\n    woset = Math.abs( that.sizeDiff.width +\r\n      ( that._helper ?\r\n        that.offset.left - cop.left :\r\n        ( that.offset.left - co.left ) ) );\r\n\r\n    hoset = Math.abs( that.sizeDiff.height +\r\n      ( that._helper ?\r\n        that.offset.top - cop.top :\r\n        ( that.offset.top - co.top ) ) );\r\n\r\n    if ( woset + that.size.width >= that.parentData.width ) {\r\n      that.size.width = that.parentData.width - woset;\r\n      if ( pRatio ) {\r\n        that.size.height = that.size.width / that.aspectRatio;\r\n        continueResize = false;\r\n      }\r\n    }\r\n\r\n    if ( hoset + that.size.height >= that.parentData.height ) {\r\n      that.size.height = that.parentData.height - hoset;\r\n      if ( pRatio ) {\r\n        that.size.width = that.size.height * that.aspectRatio;\r\n        continueResize = false;\r\n      }\r\n    }\r\n\r\n    if ( !continueResize ) {\r\n      that.position.left = that.prevPosition.left;\r\n      that.position.top = that.prevPosition.top;\r\n      that.size.width = that.prevSize.width;\r\n      that.size.height = that.prevSize.height;\r\n    }\r\n  },\r\n\r\n  stop: function() {\r\n    var that = $( this ).resizable( \"instance\" ),\r\n      o = that.options,\r\n      co = that.containerOffset,\r\n      cop = that.containerPosition,\r\n      ce = that.containerElement,\r\n      helper = $( that.helper ),\r\n      ho = helper.offset(),\r\n      w = helper.outerWidth() - that.sizeDiff.width,\r\n      h = helper.outerHeight() - that.sizeDiff.height;\r\n\r\n    if ( that._helper && !o.animate && ( /relative/ ).test( ce.css( \"position\" ) ) ) {\r\n      $( this ).css( {\r\n        left: ho.left - cop.left - co.left,\r\n        width: w,\r\n        height: h\r\n      } );\r\n    }\r\n\r\n    if ( that._helper && !o.animate && ( /static/ ).test( ce.css( \"position\" ) ) ) {\r\n      $( this ).css( {\r\n        left: ho.left - cop.left - co.left,\r\n        width: w,\r\n        height: h\r\n      } );\r\n    }\r\n  }\r\n} );\r\n\r\n$.ui.plugin.add( \"resizable\", \"alsoResize\", {\r\n\r\n  start: function() {\r\n    var that = $( this ).resizable( \"instance\" ),\r\n      o = that.options;\r\n\r\n    $( o.alsoResize ).each( function() {\r\n      var el = $( this );\r\n      el.data( \"ui-resizable-alsoresize\", {\r\n        width: parseFloat( el.width() ), height: parseFloat( el.height() ),\r\n        left: parseFloat( el.css( \"left\" ) ), top: parseFloat( el.css( \"top\" ) )\r\n      } );\r\n    } );\r\n  },\r\n\r\n  resize: function( event, ui ) {\r\n    var that = $( this ).resizable( \"instance\" ),\r\n      o = that.options,\r\n      os = that.originalSize,\r\n      op = that.originalPosition,\r\n      delta = {\r\n        height: ( that.size.height - os.height ) || 0,\r\n        width: ( that.size.width - os.width ) || 0,\r\n        top: ( that.position.top - op.top ) || 0,\r\n        left: ( that.position.left - op.left ) || 0\r\n      };\r\n\r\n      $( o.alsoResize ).each( function() {\r\n        var el = $( this ), start = $( this ).data( \"ui-resizable-alsoresize\" ), style = {},\r\n          css = el.parents( ui.originalElement[ 0 ] ).length ?\r\n              [ \"width\", \"height\" ] :\r\n              [ \"width\", \"height\", \"top\", \"left\" ];\r\n\r\n        $.each( css, function( i, prop ) {\r\n          var sum = ( start[ prop ] || 0 ) + ( delta[ prop ] || 0 );\r\n          if ( sum && sum >= 0 ) {\r\n            style[ prop ] = sum || null;\r\n          }\r\n        } );\r\n\r\n        el.css( style );\r\n      } );\r\n  },\r\n\r\n  stop: function() {\r\n    $( this ).removeData( \"ui-resizable-alsoresize\" );\r\n  }\r\n} );\r\n\r\n$.ui.plugin.add( \"resizable\", \"ghost\", {\r\n\r\n  start: function() {\r\n\r\n    var that = $( this ).resizable( \"instance\" ), cs = that.size;\r\n\r\n    that.ghost = that.originalElement.clone();\r\n    that.ghost.css( {\r\n      opacity: 0.25,\r\n      display: \"block\",\r\n      position: \"relative\",\r\n      height: cs.height,\r\n      width: cs.width,\r\n      margin: 0,\r\n      left: 0,\r\n      top: 0\r\n    } );\r\n\r\n    that._addClass( that.ghost, \"ui-resizable-ghost\" );\r\n\r\n    // DEPRECATED\r\n    // TODO: remove after 1.12\r\n    if ( $.uiBackCompat !== false && typeof that.options.ghost === \"string\" ) {\r\n\r\n      // Ghost option\r\n      that.ghost.addClass( this.options.ghost );\r\n    }\r\n\r\n    that.ghost.appendTo( that.helper );\r\n\r\n  },\r\n\r\n  resize: function() {\r\n    var that = $( this ).resizable( \"instance\" );\r\n    if ( that.ghost ) {\r\n      that.ghost.css( {\r\n        position: \"relative\",\r\n        height: that.size.height,\r\n        width: that.size.width\r\n      } );\r\n    }\r\n  },\r\n\r\n  stop: function() {\r\n    var that = $( this ).resizable( \"instance\" );\r\n    if ( that.ghost && that.helper ) {\r\n      that.helper.get( 0 ).removeChild( that.ghost.get( 0 ) );\r\n    }\r\n  }\r\n\r\n} );\r\n\r\n$.ui.plugin.add( \"resizable\", \"grid\", {\r\n\r\n  resize: function() {\r\n    var outerDimensions,\r\n      that = $( this ).resizable( \"instance\" ),\r\n      o = that.options,\r\n      cs = that.size,\r\n      os = that.originalSize,\r\n      op = that.originalPosition,\r\n      a = that.axis,\r\n      grid = typeof o.grid === \"number\" ? [ o.grid, o.grid ] : o.grid,\r\n      gridX = ( grid[ 0 ] || 1 ),\r\n      gridY = ( grid[ 1 ] || 1 ),\r\n      ox = Math.round( ( cs.width - os.width ) / gridX ) * gridX,\r\n      oy = Math.round( ( cs.height - os.height ) / gridY ) * gridY,\r\n      newWidth = os.width + ox,\r\n      newHeight = os.height + oy,\r\n      isMaxWidth = o.maxWidth && ( o.maxWidth < newWidth ),\r\n      isMaxHeight = o.maxHeight && ( o.maxHeight < newHeight ),\r\n      isMinWidth = o.minWidth && ( o.minWidth > newWidth ),\r\n      isMinHeight = o.minHeight && ( o.minHeight > newHeight );\r\n\r\n    o.grid = grid;\r\n\r\n    if ( isMinWidth ) {\r\n      newWidth += gridX;\r\n    }\r\n    if ( isMinHeight ) {\r\n      newHeight += gridY;\r\n    }\r\n    if ( isMaxWidth ) {\r\n      newWidth -= gridX;\r\n    }\r\n    if ( isMaxHeight ) {\r\n      newHeight -= gridY;\r\n    }\r\n\r\n    if ( /^(se|s|e)$/.test( a ) ) {\r\n      that.size.width = newWidth;\r\n      that.size.height = newHeight;\r\n    } else if ( /^(ne)$/.test( a ) ) {\r\n      that.size.width = newWidth;\r\n      that.size.height = newHeight;\r\n      that.position.top = op.top - oy;\r\n    } else if ( /^(sw)$/.test( a ) ) {\r\n      that.size.width = newWidth;\r\n      that.size.height = newHeight;\r\n      that.position.left = op.left - ox;\r\n    } else {\r\n      if ( newHeight - gridY <= 0 || newWidth - gridX <= 0 ) {\r\n        outerDimensions = that._getPaddingPlusBorderDimensions( this );\r\n      }\r\n\r\n      if ( newHeight - gridY > 0 ) {\r\n        that.size.height = newHeight;\r\n        that.position.top = op.top - oy;\r\n      } else {\r\n        newHeight = gridY - outerDimensions.height;\r\n        that.size.height = newHeight;\r\n        that.position.top = op.top + os.height - newHeight;\r\n      }\r\n      if ( newWidth - gridX > 0 ) {\r\n        that.size.width = newWidth;\r\n        that.position.left = op.left - ox;\r\n      } else {\r\n        newWidth = gridX - outerDimensions.width;\r\n        that.size.width = newWidth;\r\n        that.position.left = op.left + os.width - newWidth;\r\n      }\r\n    }\r\n  }\r\n\r\n} );\r\n\r\nvar widgetsResizable = $.ui.resizable;\r\n\r\n\r\n\r\n\r\n}));","// gridstack.ts 2.0.2 @preserve\r\n\r\n/**\r\n * https://gridstackjs.com/\r\n * (c) 2014-2020 Alain Dumesny, Dylan Weiss, Pavel Reznikov\r\n * gridstack.js may be freely distributed under the MIT license.\r\n*/\r\nimport { GridStackEngine } from './gridstack-engine';\r\nimport { obsoleteOpts, obsoleteOptsDel, obsoleteAttr, obsolete, Utils } from './utils';\r\nimport { GridItemHTMLElement, GridStackWidget, GridStackNode, GridStackOptions, numberOrString } from './types';\r\nimport { GridStackDD } from './gridstack-dd';\r\n\r\n// export all dependent file as well to make it easier for users to just import the main file\r\nexport * from './types';\r\nexport * from './utils';\r\nexport * from './gridstack-engine';\r\nexport * from './gridstack-dd';\r\n\r\n// TEMPORARY import the jquery-ui drag&drop since we don't have alternative yet and don't expect users to create their own yet\r\nimport './jq/gridstack-dd-jqueryui';\r\nexport * from './jq/gridstack-dd-jqueryui';\r\n\r\nexport type GridStackElement = string | HTMLElement | GridItemHTMLElement;\r\n\r\nexport interface GridHTMLElement extends HTMLElement {\r\n  gridstack?: GridStack; // grid's parent DOM element points back to grid class\r\n}\r\nexport type GridStackEvent = 'added' | 'change' | 'disable' | 'dragstart' | 'dragstop' | 'dropped' |\r\n  'enable' | 'removed' | 'resizestart' | 'resizestop';\r\n\r\n/** Defines the coordinates of an object */\r\nexport interface MousePosition {\r\n  top: number;\r\n  left: number;\r\n}\r\n\r\n/** Defines the position of a cell inside the grid*/\r\nexport interface CellPosition {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\ninterface GridCSSStyleSheet extends CSSStyleSheet {\r\n  _id?: string; // random id we will use to style us\r\n  _max?: number; // internal tracker of the max # of rows we created\\\r\n}\r\n\r\n/**\r\n * Main gridstack class - you will need to call `GridStack.init()` first to initialize your grid.\r\n * Note: your grid elements MUST have the following classes for the CSS layout to work:\r\n * @example\r\n * <div class=\"grid-stack\">\r\n *   <div class=\"grid-stack-item\">\r\n *     <div class=\"grid-stack-item-content\">Item 1</div>\r\n *   </div>\r\n * </div>\r\n */\r\nexport class GridStack {\r\n\r\n  /**\r\n   * initializing the HTML element, or selector string, into a grid will return the grid. Calling it again will\r\n   * simply return the existing instance (ignore any passed options). There is also an initAll() version that support\r\n   * multiple grids initialization at once.\r\n   * @param options grid options (optional)\r\n   * @param elOrString element or CSS selector (first one used) to convert to a grid (default to '.grid-stack' class selector)\r\n   *\r\n   * @example\r\n   * let grid = GridStack.init();\r\n   *\r\n   * Note: the HTMLElement (of type GridHTMLElement) will store a `gridstack: GridStack` value that can be retrieve later\r\n   * let grid = document.querySelector('.grid-stack').gridstack;\r\n   */\r\n  public static init(options: GridStackOptions = {}, elOrString: GridStackElement = '.grid-stack'): GridStack {\r\n    let el = GridStack.getGridElement(elOrString);\r\n    if (!el) {\r\n      if (typeof elOrString === 'string') {\r\n        console.error('GridStack.initAll() no grid was found with selector \"' + elOrString + '\" - element missing or wrong selector ?' +\r\n        '\\nNote: \".grid-stack\" is required for proper CSS styling and drag/drop, and is the default selector.');\r\n      } else {\r\n        console.error('GridStack.init() no grid element was passed.');\r\n      }\r\n      return null;\r\n    }\r\n    if (!el.gridstack) {\r\n      el.gridstack = new GridStack(el, Utils.clone(options));\r\n    }\r\n    return el.gridstack\r\n  }\r\n\r\n  /**\r\n   * Will initialize a list of elements (given a selector) and return an array of grids.\r\n   * @param options grid options (optional)\r\n   * @param selector elements selector to convert to grids (default to '.grid-stack' class selector)\r\n   *\r\n   * @example\r\n   * let grids = GridStack.initAll();\r\n   * grids.forEach(...)\r\n   */\r\n  public static initAll(options: GridStackOptions = {}, selector = '.grid-stack'): GridStack[] {\r\n    let grids: GridStack[] = [];\r\n    GridStack.getGridElements(selector).forEach(el => {\r\n      if (!el.gridstack) {\r\n        el.gridstack = new GridStack(el, Utils.clone(options));\r\n      }\r\n      grids.push(el.gridstack);\r\n    });\r\n    if (grids.length === 0) {\r\n      console.error('GridStack.initAll() no grid was found with selector \"' + selector + '\" - element missing or wrong selector ?' +\r\n      '\\nNote: \".grid-stack\" is required for proper CSS styling and drag/drop, and is the default selector.');\r\n    }\r\n    return grids;\r\n  }\r\n\r\n  /** scoping so users can call GridStack.Utils.sort() for example */\r\n  public static Utils = Utils;\r\n\r\n  /** scoping so users can call new GridStack.Engine(12) for example */\r\n  public static Engine = GridStackEngine;\r\n\r\n  /** the HTML element tied to this grid after it's been initialized */\r\n  public el: GridHTMLElement;\r\n\r\n  /** engine used to implement non DOM grid functionality */\r\n  public engine: GridStackEngine;\r\n\r\n  /** grid options - public for classes to access, but use methods to modify! */\r\n  public opts: GridStackOptions;\r\n\r\n  /** current drag&drop plugin being used */\r\n  public dd: GridStackDD;\r\n\r\n  /** @internal */\r\n  private placeholder: HTMLElement;\r\n  /** @internal */\r\n  private _oneColumnMode: boolean;\r\n  /** @internal */\r\n  private _prevColumn: number;\r\n  /** @internal */\r\n  private _gsEventHandler = {};\r\n  /** @internal */\r\n  private _styles: GridCSSStyleSheet;\r\n  /** @internal flag to keep cells square during resize */\r\n  private _isAutoCellHeight: boolean;\r\n  /** @internal track event binding to window resize so we can remove */\r\n  private _windowResizeBind: () => GridStack;\r\n\r\n  /**\r\n   * Construct a grid item from the given element and options\r\n   * @param el\r\n   * @param opts\r\n   */\r\n  public constructor(el: GridHTMLElement, opts: GridStackOptions = {}) {\r\n    this.el = el; // exposed HTML element to the user\r\n    opts = opts || {}; // handles null/undefined/0\r\n\r\n    obsoleteOpts(opts, 'width', 'column', 'v0.5.3');\r\n    obsoleteOpts(opts, 'height', 'maxRow', 'v0.5.3');\r\n    obsoleteOpts(opts, 'verticalMargin', 'margin', 'v2.0');\r\n    obsoleteOptsDel(opts, 'oneColumnModeClass', 'v0.6.3', '. Use class `.grid-stack-1` instead');\r\n\r\n    // container attributes\r\n    obsoleteAttr(this.el, 'data-gs-width', 'data-gs-column', 'v0.5.3');\r\n    obsoleteAttr(this.el, 'data-gs-height', 'data-gs-max-row', 'v0.5.3');\r\n    obsoleteAttr(this.el, 'data-gs-current-height', 'data-gs-current-row', 'v1.0.0');\r\n\r\n    // if row property exists, replace minRow and maxRow instead\r\n    if (opts.row) {\r\n      opts.minRow = opts.maxRow = opts.row;\r\n      delete opts.row;\r\n    }\r\n    let rowAttr = Utils.toNumber(el.getAttribute('data-gs-row'));\r\n\r\n    // elements attributes override any passed options (like CSS style) - merge the two together\r\n    let defaults: GridStackOptions = {\r\n      column: Utils.toNumber(el.getAttribute('data-gs-column')) || 12,\r\n      minRow: rowAttr ? rowAttr : Utils.toNumber(el.getAttribute('data-gs-min-row')) || 0,\r\n      maxRow: rowAttr ? rowAttr : Utils.toNumber(el.getAttribute('data-gs-max-row')) || 0,\r\n      itemClass: 'grid-stack-item',\r\n      placeholderClass: 'grid-stack-placeholder',\r\n      placeholderText: '',\r\n      handle: '.grid-stack-item-content',\r\n      handleClass: null,\r\n      styleInHead: false,\r\n      cellHeight: 'auto',\r\n      margin: 10,\r\n      auto: true,\r\n      minWidth: 768,\r\n      float: false,\r\n      staticGrid: false,\r\n      _class: 'grid-stack-instance-' + (Math.random() * 10000).toFixed(0),\r\n      animate: true,\r\n      alwaysShowResizeHandle: opts.alwaysShowResizeHandle || false,\r\n      resizable: {\r\n        autoHide: !(opts.alwaysShowResizeHandle || false),\r\n        handles: 'se'\r\n      },\r\n      draggable: {\r\n        handle: (opts.handleClass ? '.' + opts.handleClass : (opts.handle ? opts.handle : '')) || '.grid-stack-item-content',\r\n        scroll: false,\r\n        appendTo: 'body'\r\n      },\r\n      dragIn: undefined,\r\n      dragInOptions : {\r\n        revert: 'invalid',\r\n        handle: '.grid-stack-item-content',\r\n        scroll: false,\r\n        appendTo: 'body'\r\n      },\r\n      disableDrag: false,\r\n      disableResize: false,\r\n      rtl: 'auto',\r\n      removable: false,\r\n      removableOptions: {\r\n        accept: '.' + (opts.itemClass || 'grid-stack-item')\r\n      },\r\n      removeTimeout: 2000,\r\n      marginUnit: 'px',\r\n      cellHeightUnit: 'px',\r\n      disableOneColumnMode: false,\r\n      oneColumnModeDomSort: false\r\n    };\r\n    if (el.getAttribute('data-gs-animate')) {\r\n      defaults.animate = Utils.toBool(el.getAttribute('data-gs-animate'))\r\n    }\r\n\r\n    this.opts = Utils.defaults(opts, defaults);\r\n    this.initMargin();\r\n\r\n    if (this.opts.ddPlugin === false) {\r\n      this.opts.ddPlugin = GridStackDD;\r\n    } else if (this.opts.ddPlugin === undefined) {\r\n      this.opts.ddPlugin = GridStackDD.get();\r\n    }\r\n    this.dd = new (this.opts.ddPlugin as typeof GridStackDD)(this);\r\n\r\n    if (this.opts.rtl === 'auto') {\r\n      this.opts.rtl = el.style.direction === 'rtl';\r\n    }\r\n\r\n    if (this.opts.rtl) {\r\n      this.el.classList.add('grid-stack-rtl');\r\n    }\r\n\r\n    this.opts._isNested = Utils.closestByClass(this.el, opts.itemClass) !== null;\r\n    if (this.opts._isNested) {\r\n      this.el.classList.add('grid-stack-nested');\r\n    }\r\n\r\n    this._isAutoCellHeight = (this.opts.cellHeight === 'auto');\r\n    if (this._isAutoCellHeight) {\r\n      // make the cell content square initially (will use resize event to keep it square)\r\n      let marginDiff = - (this.opts.marginRight as number) - (this.opts.marginLeft as number)\r\n        + (this.opts.marginTop as number) + (this.opts.marginBottom as number);\r\n      this.cellHeight(this.cellWidth() + marginDiff, false);\r\n    } else {\r\n      this.cellHeight(this.opts.cellHeight, false);\r\n    }\r\n\r\n    this.el.classList.add(this.opts._class);\r\n\r\n    this._setStaticClass();\r\n    this._updateStyles();\r\n\r\n    this.engine = new GridStackEngine(this.opts.column, (cbNodes, removeDOM = true) => {\r\n      let maxHeight = 0;\r\n      this.engine.nodes.forEach(n => { maxHeight = Math.max(maxHeight, n.y + n.height) });\r\n      cbNodes.forEach(n => {\r\n        let el = n.el;\r\n        if (removeDOM && n._id === null) {\r\n          if (el && el.parentNode) { el.parentNode.removeChild(el) }\r\n        } else {\r\n          this._writeAttrs(el, n.x, n.y, n.width, n.height);\r\n        }\r\n      });\r\n      this._updateStyles(false, maxHeight); // false = don't recreate, just append if need be\r\n    },\r\n    this.opts.float,\r\n    this.opts.maxRow);\r\n\r\n    if (this.opts.auto) {\r\n      let elements: {el: HTMLElement; i: number}[] = [];\r\n      this.getGridItems().forEach(el => {\r\n        let x = parseInt(el.getAttribute('data-gs-x'));\r\n        let y = parseInt(el.getAttribute('data-gs-y'));\r\n        elements.push({\r\n          el,\r\n          // if x,y are missing (autoPosition) add them to end of list - but keep their respective DOM order\r\n          i: (Number.isNaN(x) ? 1000 : x) + (Number.isNaN(y) ? 1000 : y) * this.opts.column\r\n        });\r\n      });\r\n      elements.sort(e => e.i).forEach(item => { this._prepareElement(item.el) });\r\n    }\r\n    this.engine.saveInitial(); // initial start of items\r\n\r\n    this.setAnimation(this.opts.animate);\r\n\r\n    let placeholderChild = document.createElement('div');\r\n    placeholderChild.className = 'placeholder-content';\r\n    placeholderChild.innerHTML = this.opts.placeholderText;\r\n    this.placeholder = document.createElement('div');\r\n    this.placeholder.classList.add(this.opts.placeholderClass, this.opts.itemClass);\r\n    this.placeholder.appendChild(placeholderChild);\r\n\r\n    this._updateContainerHeight();\r\n\r\n    this.onParentResize();\r\n\r\n    this._setupDragIn();\r\n    this._setupRemoveDrop();\r\n    this._setupAcceptWidget();\r\n    this._updateWindowResizeEvent();\r\n  };\r\n\r\n\r\n  /**\r\n   * add a new widget and returns it.\r\n   *\r\n   * Widget will be always placed even if result height is more than actual grid height.\r\n   * You need to use willItFit method before calling addWidget for additional check.\r\n   * See also `makeWidget()`.\r\n   *\r\n   * @example\r\n   * let grid = GridStack.init();\r\n   * grid.addWidget({width: 3, content: 'hello'});\r\n   * grid.addWidget('<div class=\"grid-stack-item\"><div class=\"grid-stack-item-content\">hello</div></div>', {width: 3});\r\n   *\r\n   * @param el html element, or string definition, or GridStackWidget (which can have content string as well) to add\r\n   * @param options widget position/size options (optional, and ignore if first param is already option) - see GridStackWidget\r\n   */\r\n  public addWidget(els?: GridStackWidget | GridStackElement, options?: GridStackWidget): GridItemHTMLElement {\r\n\r\n    // support legacy call for now ?\r\n    if (arguments.length > 2) {\r\n      console.warn('gridstack.ts: `addWidget(el, x, y, width...)` is deprecated. Use `addWidget({x, y, width, content, ...})`. It will be removed soon');\r\n      // eslint-disable-next-line prefer-rest-params\r\n      let a = arguments, i = 1,\r\n        opt: GridStackWidget = { x:a[i++], y:a[i++], width:a[i++], height:a[i++], autoPosition:a[i++],\r\n          minWidth:a[i++], maxWidth:a[i++], minHeight:a[i++], maxHeight:a[i++], id:a[i++] };\r\n      return this.addWidget(els, opt);\r\n    }\r\n\r\n    function isGridStackWidget(w: GridStackWidget): w is GridStackWidget { // https://medium.com/ovrsea/checking-the-type-of-an-object-in-typescript-the-type-guards-24d98d9119b0\r\n      return w.x !== undefined || w.y !== undefined || w.width !== undefined || w.height !== undefined || w.content !== undefined ? true : false;\r\n    }\r\n\r\n    let el: HTMLElement;\r\n    if (typeof els === 'string') {\r\n      let doc = document.implementation.createHTMLDocument();\r\n      doc.body.innerHTML = els;\r\n      el = doc.body.children[0] as HTMLElement;\r\n    } else if (arguments.length === 0 || arguments.length === 1 && isGridStackWidget(els)) {\r\n      let content = els ? (els as GridStackWidget).content || '' : '';\r\n      options = els;\r\n      let doc = document.implementation.createHTMLDocument();\r\n      doc.body.innerHTML = `<div class=\"grid-stack-item\"><div class=\"grid-stack-item-content\">${content}</div></div>`;\r\n      el = doc.body.children[0] as HTMLElement;\r\n    } else {\r\n      el = els as HTMLElement;\r\n    }\r\n\r\n    // Tempting to initialize the passed in opt with default and valid values, but this break knockout demos\r\n    // as the actual value are filled in when _prepareElement() calls el.getAttribute('data-gs-xyz) before adding the node.\r\n    if (options) {\r\n      options = {...options};  // make a copy before we modify in case caller re-uses it\r\n      // make sure we load any DOM attributes that are not specified in passed in options (which override)\r\n      let domAttr = this._readAttr(el);\r\n      Utils.defaults(options, domAttr);\r\n      this.engine.prepareNode(options);\r\n      this._writeAttr(el, options);\r\n    }\r\n\r\n    this.el.appendChild(el);\r\n    return this.makeWidget(el);\r\n  }\r\n\r\n  /** saves the current layout returning a list of widgets for serialization */\r\n  public save(saveContent = true): GridStackWidget[] {\r\n    let list = this.engine.save(saveContent);\r\n    // check for HTML content as well\r\n    if (saveContent) {\r\n      list.forEach(n => {\r\n        if (n.el) {\r\n          let sub = n.el.querySelector('.grid-stack-item-content');\r\n          n.content = sub ? sub.innerHTML : undefined;\r\n          if (!n.content) delete n.content;\r\n          delete n.el;\r\n        }\r\n      });\r\n    }\r\n    return list;\r\n  }\r\n\r\n  /**\r\n   * load the widgets from a list. This will call update() on each (matching by id) or add/remove widgets that are not there.\r\n   *\r\n   * @param layout list of widgets definition to update/create\r\n   * @param addAndRemove boolean (default true) or callback method can be passed to control if and how missing widgets can be added/removed, giving\r\n   * the user control of insertion.\r\n   *\r\n   * @example\r\n   * see http://gridstackjs.com/demo/serialization.html\r\n   **/\r\n  public load(layout: GridStackWidget[], addAndRemove: boolean | ((w: GridStackWidget, add: boolean) => void)  = true) {\r\n    let items = GridStack.Utils.sort(layout);\r\n    let removed: GridStackNode[] = [];\r\n    this.batchUpdate();\r\n    // see if any items are missing from new layout and need to be removed first\r\n    if (addAndRemove) {\r\n      let copyNodes = [...this.engine.nodes]; // don't loop through array you modify\r\n      copyNodes.forEach(n => {\r\n        let item = items.find(w => n.id === w.id);\r\n        if (!item) {\r\n          if (typeof(addAndRemove) === 'function') {\r\n            addAndRemove(n, false);\r\n          } else {\r\n            removed.push(n); // batch keep track\r\n            this.removeWidget(n.el, true, false);\r\n          }\r\n        }\r\n      });\r\n    }\r\n    // now add/update the widgets\r\n    items.forEach(w => {\r\n      let item = this.engine.nodes.find(n => n.id === w.id);\r\n      if (item) {\r\n        this.update(item.el, w.x, w.y, w.width, w.height); // TODO: full update\r\n      } else if (addAndRemove) {\r\n        if (typeof(addAndRemove) === 'function') {\r\n          addAndRemove(w, true);\r\n        } else {\r\n          this.addWidget(w);\r\n        }\r\n      }\r\n    });\r\n    this.engine.removedNodes = removed;\r\n    this.commit();\r\n  }\r\n\r\n  /**\r\n   * Initializes batch updates. You will see no changes until `commit()` method is called.\r\n   */\r\n  public batchUpdate(): GridStack {\r\n    this.engine.batchUpdate();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Gets current cell height.\r\n   */\r\n  public getCellHeight(forcePixel = false): number {\r\n    if (this.opts.cellHeight && this.opts.cellHeight !== 'auto' &&\r\n       (!forcePixel || !this.opts.cellHeightUnit || this.opts.cellHeightUnit === 'px')) {\r\n      return this.opts.cellHeight as number;\r\n    }\r\n    // else get first cell height\r\n    // or do entire grid and # of rows ? (this.el.getBoundingClientRect().height) / parseInt(this.el.getAttribute('data-gs-current-row'))\r\n    let el = this.el.querySelector('.' + this.opts.itemClass) as HTMLElement;\r\n    let height = Utils.toNumber(el.getAttribute('data-gs-height'));\r\n    return Math.round(el.offsetHeight / height);\r\n  }\r\n\r\n  /**\r\n   * Update current cell height - see `GridStackOptions.cellHeight` for format.\r\n   * This method rebuilds an internal CSS style sheet.\r\n   * Note: You can expect performance issues if call this method too often.\r\n   *\r\n   * @param val the cell height\r\n   * @param update (Optional) if false, styles will not be updated\r\n   *\r\n   * @example\r\n   * grid.cellHeight(grid.cellWidth() * 1.2);\r\n   */\r\n  public cellHeight(val: numberOrString, update = true): GridStack {\r\n    let data = Utils.parseHeight(val);\r\n    if (this.opts.cellHeightUnit === data.unit && this.opts.cellHeight === data.height) {\r\n      return this;\r\n    }\r\n    this.opts.cellHeightUnit = data.unit;\r\n    this.opts.cellHeight = data.height;\r\n\r\n    if (update) {\r\n      this._updateStyles(true); // true = force re-create\r\n    }\r\n    this._resizeNestedGrids(this.el);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Gets current cell width.\r\n   */\r\n  public cellWidth(): number {\r\n    return this.el.offsetWidth / this.opts.column;\r\n  }\r\n\r\n  /**\r\n   * Finishes batch updates. Updates DOM nodes. You must call it after batchUpdate.\r\n   */\r\n  public commit(): GridStack {\r\n    this.engine.commit();\r\n    this._triggerRemoveEvent();\r\n    this._triggerAddEvent();\r\n    this._triggerChangeEvent();\r\n    return this;\r\n  };\r\n\r\n  /** re-layout grid items to reclaim any empty space */\r\n  public compact(): GridStack {\r\n    this.engine.compact();\r\n    this._triggerChangeEvent();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * set the number of columns in the grid. Will update existing widgets to conform to new number of columns,\r\n   * as well as cache the original layout so you can revert back to previous positions without loss.\r\n   * Requires `gridstack-extra.css` or `gridstack-extra.min.css` for [1-11],\r\n   * else you will need to generate correct CSS (see https://github.com/gridstack/gridstack.js#change-grid-columns)\r\n   * @param column - Integer > 0 (default 12).\r\n   * @param doNotPropagate if true existing widgets will not be updated (optional)\r\n   */\r\n  public column(column: number, doNotPropagate?: boolean): GridStack {\r\n    if (this.opts.column === column) { return this; }\r\n    let oldColumn = this.opts.column;\r\n\r\n    // if we go into 1 column mode (which happens if we're sized less than minWidth unless disableOneColumnMode is on)\r\n    // then remember the original columns so we can restore.\r\n    if (column === 1) {\r\n      this._prevColumn = oldColumn;\r\n    } else {\r\n      delete this._prevColumn;\r\n    }\r\n\r\n    this.el.classList.remove('grid-stack-' + oldColumn);\r\n    this.el.classList.add('grid-stack-' + column);\r\n    this.opts.column = this.engine.column = column;\r\n\r\n    if (doNotPropagate === true) { return this; }\r\n\r\n    // update the items now - see if the dom order nodes should be passed instead (else default to current list)\r\n    let domNodes: GridStackNode[] = undefined; // explicitly leave not defined\r\n    if (column === 1 && this.opts.oneColumnModeDomSort) {\r\n      domNodes = [];\r\n      this.getGridItems().forEach(el => {\r\n        if (el.gridstackNode) { domNodes.push(el.gridstackNode); }\r\n      });\r\n      if (!domNodes.length) { domNodes = undefined; }\r\n    }\r\n    this.engine.updateNodeWidths(oldColumn, column, domNodes);\r\n\r\n    // and trigger our event last...\r\n    this._triggerChangeEvent(true); // skip layout update\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * get the number of columns in the grid (default 12)\r\n   */\r\n  public getColumn(): number {\r\n    return this.opts.column;\r\n  }\r\n\r\n  /** returns an array of grid HTML elements (no placeholder) - used to iterate through our children */\r\n  public getGridItems(): GridItemHTMLElement[] {\r\n    return Array.from(this.el.children)\r\n      .filter((el: HTMLElement) => el.matches('.' + this.opts.itemClass) && !el.matches('.' + this.opts.placeholderClass)) as GridItemHTMLElement[];\r\n  }\r\n\r\n  /**\r\n   * Destroys a grid instance.\r\n   * @param removeDOM if `false` grid and items elements will not be removed from the DOM (Optional. Default `true`).\r\n   */\r\n  public destroy(removeDOM = true): GridStack {\r\n    this._updateWindowResizeEvent(true);\r\n    this.setStatic(true); // permanently removes DD\r\n    if (!removeDOM) {\r\n      this.removeAll(removeDOM);\r\n      this.el.classList.remove(this.opts._class);\r\n      delete this.el.gridstack;\r\n    } else {\r\n      this.el.parentNode.removeChild(this.el);\r\n    }\r\n    this._removeStylesheet();\r\n    delete this.engine;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Disables widgets moving/resizing. This is a shortcut for:\r\n   * @example\r\n   *  grid.enableMove(false);\r\n   *  grid.enableResize(false);\r\n   */\r\n  public disable(): GridStack {\r\n    this.enableMove(false);\r\n    this.enableResize(false);\r\n    this._triggerEvent('disable');\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Enables widgets moving/resizing. This is a shortcut for:\r\n   * @example\r\n   *  grid.enableMove(true);\r\n   *  grid.enableResize(true);\r\n   */\r\n  public enable(): GridStack {\r\n    this.enableMove(true);\r\n    this.enableResize(true);\r\n    this._triggerEvent('enable');\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Enables/disables widget moving.\r\n   *\r\n   * @param doEnable\r\n   * @param includeNewWidgets will force new widgets to be draggable as per\r\n   * doEnable`s value by changing the disableDrag grid option (default: true).\r\n   */\r\n  public enableMove(doEnable: boolean, includeNewWidgets = true): GridStack {\r\n    if (doEnable && this.opts.staticGrid) { return this; } // can't move a static grid!\r\n    this.getGridItems().forEach(el => this.movable(el, doEnable));\r\n    if (includeNewWidgets) {\r\n      this.opts.disableDrag = !doEnable;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Enables/disables widget resizing\r\n   * @param doEnable\r\n   * @param includeNewWidgets will force new widgets to be draggable as per\r\n   * doEnable`s value by changing the disableResize grid option (default: true).\r\n   */\r\n  public enableResize(doEnable: boolean, includeNewWidgets = true): GridStack {\r\n    if (doEnable && this.opts.staticGrid) { return this; } // can't size a static grid!\r\n    this.getGridItems().forEach(el => this.resizable(el, doEnable));\r\n    if (includeNewWidgets) {\r\n      this.opts.disableResize = !doEnable;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * enable/disable floating widgets (default: `false`) See [example](http://gridstackjs.com/demo/float.html)\r\n   */\r\n  public float(val: boolean): GridStack {\r\n    /*\r\n    if (val === undefined) {\r\n      // TODO: should we support and/or change signature ? figure this soon...\r\n      console.warn('gridstack.ts: getter `float()` is deprecated in 2.x and has been replaced by `getFloat()`. It will be **completely** removed soon');\r\n      return this.getFloat();\r\n    }\r\n    */\r\n    this.engine.float = val;\r\n    this._triggerChangeEvent();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * get the current float mode\r\n   */\r\n  public getFloat(): boolean {\r\n    return this.engine.float;\r\n  }\r\n\r\n  /**\r\n   * Get the position of the cell under a pixel on screen.\r\n   * @param position the position of the pixel to resolve in\r\n   * absolute coordinates, as an object with top and left properties\r\n   * @param useDocRelative if true, value will be based on document position vs parent position (Optional. Default false).\r\n   * Useful when grid is within `position: relative` element\r\n   *\r\n   * Returns an object with properties `x` and `y` i.e. the column and row in the grid.\r\n   */\r\n  public getCellFromPixel(position: MousePosition, useDocRelative = false): CellPosition {\r\n    let box = this.el.getBoundingClientRect();\r\n    // console.log(`getBoundingClientRect left: ${box.left} top: ${box.top} w: ${box.width} h: ${box.height}`)\r\n    let containerPos;\r\n    if (useDocRelative) {\r\n      containerPos = {top: box.top + document.documentElement.scrollTop, left: box.left};\r\n      // console.log(`getCellFromPixel scrollTop: ${document.documentElement.scrollTop}`)\r\n    } else {\r\n      containerPos = {top: this.el.offsetTop, left: this.el.offsetLeft}\r\n      // console.log(`getCellFromPixel offsetTop: ${containerPos.left} offsetLeft: ${containerPos.top}`)\r\n    }\r\n    let relativeLeft = position.left - containerPos.left;\r\n    let relativeTop = position.top - containerPos.top;\r\n\r\n    let columnWidth = (box.width / this.opts.column);\r\n    let rowHeight = (box.height / parseInt(this.el.getAttribute('data-gs-current-row')));\r\n\r\n    return {x: Math.floor(relativeLeft / columnWidth), y: Math.floor(relativeTop / rowHeight)};\r\n  }\r\n\r\n  /** returns the current number of rows, which will be at least `minRow` if set */\r\n  public getRow(): number {\r\n    return Math.max(this.engine.getRow(), this.opts.minRow);\r\n  }\r\n\r\n  /**\r\n   * Checks if specified area is empty.\r\n   * @param x the position x.\r\n   * @param y the position y.\r\n   * @param width the width of to check\r\n   * @param height the height of to check\r\n   */\r\n  public isAreaEmpty(x: number, y: number, width: number, height: number): boolean {\r\n    return this.engine.isAreaEmpty(x, y, width, height);\r\n  }\r\n\r\n  /**\r\n   * Locks/unlocks widget.\r\n   * @param el element or selector to modify.\r\n   * @param val if true widget will be locked.\r\n   */\r\n  public locked(els: GridStackElement, val: boolean): GridStack {\r\n    GridStack.getElements(els).forEach(el => {\r\n      let node = el.gridstackNode;\r\n      if (!node) return;\r\n      node.locked = (val || false);\r\n      if (node.locked) {\r\n        el.setAttribute('data-gs-locked', 'yes');\r\n      } else {\r\n        el.removeAttribute('data-gs-locked');\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * If you add elements to your grid by hand, you have to tell gridstack afterwards to make them widgets.\r\n   * If you want gridstack to add the elements for you, use `addWidget()` instead.\r\n   * Makes the given element a widget and returns it.\r\n   * @param els widget or single selector to convert.\r\n   *\r\n   * @example\r\n   * let grid = GridStack.init();\r\n   * grid.el.appendChild('<div id=\"gsi-1\" data-gs-width=\"3\"></div>');\r\n   * grid.makeWidget('#gsi-1');\r\n   */\r\n  public makeWidget(els: GridStackElement): GridItemHTMLElement {\r\n    let el = GridStack.getElement(els);\r\n    this._prepareElement(el, true);\r\n    this._updateContainerHeight();\r\n    this._triggerAddEvent();\r\n    this._triggerChangeEvent();\r\n    return el;\r\n  }\r\n\r\n  /**\r\n   * Set the maxWidth for a widget.\r\n   * @param els widget or selector to modify.\r\n   * @param val A numeric value of the number of columns\r\n   */\r\n  public maxWidth(els: GridStackElement, val: number): GridStack {\r\n    return this._updateAttr(els, val, 'data-gs-max-width', 'maxWidth');\r\n  }\r\n\r\n  /**\r\n   * Set the minWidth for a widget.\r\n   * @param els widget or selector to modify.\r\n   * @param val A numeric value of the number of columns\r\n   */\r\n  public minWidth(els: GridStackElement, val: number): GridStack {\r\n    return this._updateAttr(els, val, 'data-gs-min-width', 'minWidth');\r\n  }\r\n\r\n  /**\r\n   * Set the maxHeight for a widget.\r\n   * @param els widget or selector to modify.\r\n   * @param val A numeric value of the number of rows\r\n   */\r\n  public maxHeight(els: GridStackElement, val: number): GridStack {\r\n    return this._updateAttr(els, val, 'data-gs-max-height', 'maxHeight');\r\n  }\r\n\r\n  /**\r\n   * Set the minHeight for a widget.\r\n   * @param els widget or selector to modify.\r\n   * @param val A numeric value of the number of rows\r\n   */\r\n  public minHeight(els: GridStackElement, val: number): GridStack {\r\n    return this._updateAttr(els, val, 'data-gs-min-height', 'minHeight');\r\n  }\r\n\r\n  /**\r\n   * Enables/Disables moving.\r\n   * @param els widget or selector to modify.\r\n   * @param val if true widget will be draggable.\r\n   */\r\n  public movable(els: GridStackElement, val: boolean): GridStack {\r\n    if (val && this.opts.staticGrid) { return this; } // can't move a static grid!\r\n    GridStack.getElements(els).forEach(el => {\r\n      let node = el.gridstackNode;\r\n      if (!node) { return }\r\n      node.noMove = !(val || false);\r\n      if (node.noMove) {\r\n        this.dd.draggable(el, 'disable');\r\n        el.classList.remove('ui-draggable-handle');\r\n      } else {\r\n        this._prepareDragDropByNode(node); // init DD if need be\r\n        this.dd.draggable(el, 'enable');\r\n        el.classList.remove('ui-draggable-handle');\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Changes widget position\r\n   * @param els  widget or singular selector to modify\r\n   * @param x new position x. If value is null or undefined it will be ignored.\r\n   * @param y new position y. If value is null or undefined it will be ignored.\r\n   */\r\n  public move(els: GridStackElement, x?: number, y?: number): GridStack {\r\n    this._updateElement(els, (el, node) => {\r\n      x = (x !== undefined) ? x : node.x;\r\n      y = (y !== undefined) ? y : node.y;\r\n\r\n      this.engine.moveNode(node, x, y, node.width, node.height);\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Event handler that extracts our CustomEvent data out automatically for receiving custom\r\n   * notifications (see doc for supported events)\r\n   * @param name of the event (see possible values) or list of names space separated\r\n   * @param callback function called with event and optional second/third param\r\n   * (see README documentation for each signature).\r\n   *\r\n   * @example\r\n   * grid.on('added', function(e, items) { log('added ', items)} );\r\n   * or\r\n   * grid.on('added removed change', function(e, items) { log(e.type, items)} );\r\n   *\r\n   * Note: in some cases it is the same as calling native handler and parsing the event.\r\n   * grid.el.addEventListener('added', function(event) { log('added ', event.detail)} );\r\n   *\r\n   */\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  public on(name: GridStackEvent, callback: (event: Event, arg2?: GridItemHTMLElement | GridStackNode[]) => void): GridStack {\r\n    // check for array of names being passed instead\r\n    if (name.indexOf(' ') !== -1) {\r\n      let names = name.split(' ') as GridStackEvent[];\r\n      names.forEach(name => this.on(name, callback));\r\n      return this;\r\n    }\r\n\r\n    if (name === 'change' || name === 'added' || name === 'removed' || name === 'enable' || name === 'disable') {\r\n      // native CustomEvent handlers - cash the generic handlers so we can easily remove\r\n      let noData = (name === 'enable' || name === 'disable');\r\n      if (noData) {\r\n        this._gsEventHandler[name] = (event: Event) => callback(event);\r\n      } else {\r\n        this._gsEventHandler[name] = (event: CustomEvent) => callback(event, event.detail);\r\n      }\r\n      this.el.addEventListener(name, this._gsEventHandler[name]);\r\n    } else if (name === 'dragstart' || name === 'dragstop' || name === 'resizestart' || name === 'resizestop' || name === 'dropped') {\r\n      // drag&drop stop events NEED to be call them AFTER we update node attributes so handle them ourself.\r\n      // do same for start event to make it easier...\r\n      this._gsEventHandler[name] = callback;\r\n    } else {\r\n      console.log('GridStack.on(' + name + ') event not supported, but you can still use $(\".grid-stack\").on(...) while jquery-ui is still used internally.');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * unsubscribe from the 'on' event below\r\n   * @param name of the event (see possible values)\r\n   */\r\n  public off(name: GridStackEvent): GridStack {\r\n    // check for array of names being passed instead\r\n    if (name.indexOf(' ') !== -1) {\r\n      let names = name.split(' ') as GridStackEvent[];\r\n      names.forEach(name => this.off(name));\r\n      return this;\r\n    }\r\n\r\n    if (name === 'change' || name === 'added' || name === 'removed' || name === 'enable' || name === 'disable') {\r\n      // remove native CustomEvent handlers\r\n      if (this._gsEventHandler[name]) {\r\n        this.el.removeEventListener(name, this._gsEventHandler[name]);\r\n      }\r\n    }\r\n    delete this._gsEventHandler[name];\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Removes widget from the grid.\r\n   * @param el  widget or selector to modify\r\n   * @param removeDOM if `false` DOM element won't be removed from the tree (Default? true).\r\n   * @param triggerEvent if `false` (quiet mode) element will not be added to removed list and no 'removed' callbacks will be called (Default? true).\r\n   */\r\n  public removeWidget(els: GridStackElement, removeDOM = true, triggerEvent = true): GridStack {\r\n    GridStack.getElements(els).forEach(el => {\r\n      if (el.parentElement !== this.el) return; // not our child!\r\n      let node = el.gridstackNode;\r\n      // For Meteor support: https://github.com/gridstack/gridstack.js/pull/272\r\n      if (!node) {\r\n        node = this.engine.nodes.find(n => el === n.el);\r\n      }\r\n      if (!node) return;\r\n\r\n      // remove our DOM data (circular link) and drag&drop permanently\r\n      delete el.gridstackNode;\r\n      this.dd.remove(el);\r\n\r\n      this.engine.removeNode(node, removeDOM, triggerEvent);\r\n\r\n      if (removeDOM && el.parentElement) {\r\n        el.remove(); // in batch mode engine.removeNode doesn't call back to remove DOM\r\n      }\r\n    });\r\n    if (triggerEvent) {\r\n      this._triggerRemoveEvent();\r\n      this._triggerChangeEvent();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Removes all widgets from the grid.\r\n   * @param removeDOM if `false` DOM elements won't be removed from the tree (Default? `true`).\r\n   */\r\n  public removeAll(removeDOM = true): GridStack {\r\n    // always remove our DOM data (circular link) before list gets emptied and drag&drop permanently\r\n    this.engine.nodes.forEach(n => {\r\n      delete n.el.gridstackNode;\r\n      this.dd.remove(n.el);\r\n    });\r\n    this.engine.removeAll(removeDOM);\r\n    this._triggerRemoveEvent();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Changes widget size\r\n   * @param els  widget or singular selector to modify\r\n   * @param width new dimensions width. If value is null or undefined it will be ignored.\r\n   * @param height  new dimensions height. If value is null or undefined it will be ignored.\r\n   */\r\n  public resize(els: GridStackElement, width?: number, height?: number): GridStack {\r\n    this._updateElement(els, (el, node) => {\r\n      width = (width || node.width);\r\n      height = (height || node.height);\r\n\r\n      this.engine.moveNode(node, node.x, node.y, width, height);\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Enables/Disables resizing.\r\n   * @param els  widget or selector to modify\r\n   * @param val  if true widget will be resizable.\r\n   */\r\n  public resizable(els: GridStackElement, val: boolean): GridStack {\r\n    if (val && this.opts.staticGrid) { return this; } // can't resize a static grid!\r\n    GridStack.getElements(els).forEach(el => {\r\n      let node = el.gridstackNode;\r\n      if (!node) { return; }\r\n      node.noResize = !(val || false);\r\n      if (node.noResize) {\r\n        this.dd.resizable(el, 'disable');\r\n      } else {\r\n        this._prepareDragDropByNode(node); // init DD if need be\r\n        this.dd.resizable(el, 'enable');\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Toggle the grid animation state.  Toggles the `grid-stack-animate` class.\r\n   * @param doAnimate if true the grid will animate.\r\n   */\r\n  public setAnimation(doAnimate: boolean): GridStack {\r\n    if (doAnimate) {\r\n      this.el.classList.add('grid-stack-animate');\r\n    } else {\r\n      this.el.classList.remove('grid-stack-animate');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Toggle the grid static state, which permanently removes/add Drag&Drop support, unlike disable()/enable() that just turns it off/on.\r\n   * Also toggle the grid-stack-static class.\r\n   * @param val if true the grid become static.\r\n   */\r\n  public setStatic(val: boolean): GridStack {\r\n    if (this.opts.staticGrid === val) { return this; }\r\n    this.opts.staticGrid = val;\r\n    // either delete Drag&drop or initialize it\r\n    if (val) {\r\n      this.getGridItems().forEach(el => this.dd.remove(el));\r\n    } else {\r\n      this.engine.nodes.forEach(n => this._prepareDragDropByNode(n));\r\n    }\r\n    this._setStaticClass();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Updates widget position/size.\r\n   * @param els  widget or singular selector to modify\r\n   * @param x new position x. If value is null or undefined it will be ignored.\r\n   * @param y new position y. If value is null or undefined it will be ignored.\r\n   * @param width new dimensions width. If value is null or undefined it will be ignored.\r\n   * @param height  new dimensions height. If value is null or undefined it will be ignored.\r\n   */\r\n  public update(els: GridStackElement, x?: number, y?: number, width?: number, height?: number): GridStack {\r\n    this._updateElement(els, (el, node) => {\r\n      x = (x !== undefined) ? x : node.x;\r\n      y = (y !== undefined) ? y : node.y;\r\n      width = (width || node.width);\r\n      height = (height || node.height);\r\n\r\n      this.engine.moveNode(node, x, y, width, height);\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Updates the margins which will set all 4 sides at once - see `GridStackOptions.margin` for format options.\r\n   * @param value new vertical margin value\r\n   * Note: you can instead use `marginTop | marginBottom | marginLeft | marginRight` GridStackOptions to set the sides separately.\r\n   */\r\n  public margin(value: numberOrString): GridStack {\r\n    let data = Utils.parseHeight(value);\r\n    if (this.opts.marginUnit === data.unit && this.opts.margin === data.height) {\r\n      return;\r\n    }\r\n    this.opts.marginUnit = data.unit;\r\n    this.opts.marginTop =\r\n    this.opts.marginBottom =\r\n    this.opts.marginLeft =\r\n    this.opts.marginRight =\r\n    this.opts.margin = data.height;\r\n    this._updateStyles(true); // true = force re-create\r\n\r\n    return this;\r\n  }\r\n\r\n  /** returns current vertical margin value */\r\n  public getMargin(): number { return this.opts.margin as number; }\r\n\r\n  /**\r\n   * Returns true if the height of the grid will be less the vertical\r\n   * constraint. Always returns true if grid doesn't have height constraint.\r\n   * @param x new position x. If value is null or undefined it will be ignored.\r\n   * @param y new position y. If value is null or undefined it will be ignored.\r\n   * @param width new dimensions width. If value is null or undefined it will be ignored.\r\n   * @param height new dimensions height. If value is null or undefined it will be ignored.\r\n   * @param autoPosition if true then x, y parameters will be ignored and widget\r\n   * will be places on the first available position\r\n   *\r\n   * @example\r\n   * if (grid.willItFit(newNode.x, newNode.y, newNode.width, newNode.height, newNode.autoPosition)) {\r\n   *   grid.addWidget(newNode);\r\n   * } else {\r\n   *   alert('Not enough free space to place the widget');\r\n   * }\r\n   */\r\n  public willItFit(x: number, y: number, width: number, height: number, autoPosition: boolean): boolean {\r\n    return this.engine.canBePlacedWithRespectToHeight({x, y, width, height, autoPosition});\r\n  }\r\n\r\n  /** @internal */\r\n  private _triggerChangeEvent(skipLayoutChange?: boolean): GridStack {\r\n    if (this.engine.batchMode) { return this; }\r\n    let elements = this.engine.getDirtyNodes(true); // verify they really changed\r\n    if (elements && elements.length) {\r\n      if (!skipLayoutChange) {\r\n        this.engine.layoutsNodesChange(elements);\r\n      }\r\n      this._triggerEvent('change', elements);\r\n    }\r\n    this.engine.saveInitial(); // we called, now reset initial values & dirty flags\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _triggerAddEvent(): GridStack {\r\n    if (this.engine.batchMode) { return this }\r\n    if (this.engine.addedNodes && this.engine.addedNodes.length > 0) {\r\n      this.engine.layoutsNodesChange(this.engine.addedNodes);\r\n      // prevent added nodes from also triggering 'change' event (which is called next)\r\n      this.engine.addedNodes.forEach(n => { delete n._dirty; });\r\n      this._triggerEvent('added', this.engine.addedNodes);\r\n      this.engine.addedNodes = [];\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _triggerRemoveEvent(): GridStack {\r\n    if (this.engine.batchMode) { return this; }\r\n    if (this.engine.removedNodes && this.engine.removedNodes.length > 0) {\r\n      this._triggerEvent('removed', this.engine.removedNodes);\r\n      this.engine.removedNodes = [];\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _triggerEvent(name: string, data?: GridStackNode[]): GridStack {\r\n    let event = data ? new CustomEvent(name, {bubbles: false, detail: data}) : new Event(name);\r\n    this.el.dispatchEvent(event);\r\n    return this;\r\n  }\r\n\r\n  /** @internal called to delete the current dynamic style sheet used for our layout */\r\n  private _removeStylesheet(): GridStack {\r\n\r\n    if (this._styles) {\r\n      Utils.removeStylesheet(this._styles._id);\r\n      delete this._styles;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** @internal updated/create the CSS styles for row based layout and initial margin setting */\r\n  private _updateStyles(forceUpdate = false, maxHeight?: number): GridStack {\r\n    // call to delete existing one if we change cellHeight / margin\r\n    if (forceUpdate) {\r\n      this._removeStylesheet();\r\n    }\r\n\r\n    this._updateContainerHeight();\r\n    if (!this.opts.cellHeight) { // The rest will be handled by CSS TODO: I don't understand this usage\r\n      return this;\r\n    }\r\n\r\n    let cellHeight = this.opts.cellHeight as number;\r\n    let cellHeightUnit = this.opts.cellHeightUnit;\r\n    let prefix = `.${this.opts._class} > .${this.opts.itemClass}`;\r\n\r\n    // create one as needed\r\n    if (!this._styles) {\r\n      let id = 'gridstack-style-' + (Math.random() * 100000).toFixed();\r\n      // insert style to parent (instead of 'head' by default) to support WebComponent\r\n      let styleLocation = this.opts.styleInHead ? undefined : this.el.parentNode as HTMLElement;\r\n      this._styles = Utils.createStylesheet(id, styleLocation);\r\n      if (!this._styles) { return this; }\r\n      this._styles._id = id;\r\n      this._styles._max = 0;\r\n\r\n      // these are done once only\r\n      Utils.addCSSRule(this._styles, prefix, `min-height: ${cellHeight}${cellHeightUnit}`);\r\n      // content margins\r\n      let top: string = this.opts.marginTop + this.opts.marginUnit;\r\n      let bottom: string = this.opts.marginBottom + this.opts.marginUnit;\r\n      let right: string = this.opts.marginRight + this.opts.marginUnit;\r\n      let left: string = this.opts.marginLeft + this.opts.marginUnit;\r\n      let content = `${prefix} > .grid-stack-item-content`;\r\n      let placeholder = `.${this.opts._class} > .grid-stack-placeholder > .placeholder-content`;\r\n      Utils.addCSSRule(this._styles, content, `top: ${top}; right: ${right}; bottom: ${bottom}; left: ${left};`);\r\n      Utils.addCSSRule(this._styles, placeholder, `top: ${top}; right: ${right}; bottom: ${bottom}; left: ${left};`);\r\n      // resize handles offset (to match margin)\r\n      Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-ne`, `right: ${right}`);\r\n      Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-e`, `right: ${right}`);\r\n      Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-se`, `right: ${right}; bottom: ${bottom}`);\r\n      Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-nw`, `left: ${left}`);\r\n      Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-w`, `left: ${left}`);\r\n      Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-sw`, `left: ${left}; bottom: ${bottom}`);\r\n    }\r\n\r\n    // now update the height specific fields\r\n    maxHeight = maxHeight || this._styles._max;\r\n    if (maxHeight > this._styles._max) {\r\n      let getHeight = (rows: number): string => (cellHeight * rows) + cellHeightUnit;\r\n      for (let i = this._styles._max + 1; i <= maxHeight; i++) { // start at 1\r\n        let height: string = getHeight(i);\r\n        Utils.addCSSRule(this._styles, `${prefix}[data-gs-y=\"${i-1}\"]`,        `top: ${getHeight(i-1)}`); // start at 0\r\n        Utils.addCSSRule(this._styles, `${prefix}[data-gs-height=\"${i}\"]`,     `height: ${height}`);\r\n        Utils.addCSSRule(this._styles, `${prefix}[data-gs-min-height=\"${i}\"]`, `min-height: ${height}`);\r\n        Utils.addCSSRule(this._styles, `${prefix}[data-gs-max-height=\"${i}\"]`, `max-height: ${height}`);\r\n      }\r\n      this._styles._max = maxHeight;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _updateContainerHeight(): GridStack {\r\n    if (!this.engine || this.engine.batchMode) { return this; }\r\n    let row = this.getRow(); // checks for minRow already\r\n    // check for css min height\r\n    let cssMinHeight = parseInt(getComputedStyle(this.el)['min-height']);\r\n    if (cssMinHeight > 0) {\r\n      let minRow =  Math.round(cssMinHeight / this.getCellHeight(true));\r\n      if (row < minRow) {\r\n        row = minRow;\r\n      }\r\n    }\r\n    this.el.setAttribute('data-gs-current-row', String(row));\r\n    if (row === 0) {\r\n      this.el.style.removeProperty('height');\r\n      return this;\r\n    }\r\n    let cellHeight = this.opts.cellHeight as number;\r\n    let unit = this.opts.cellHeightUnit;\r\n    if (!cellHeight) { return this }\r\n    this.el.style.height = row * cellHeight + unit;\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _setupRemovingTimeout(el: GridItemHTMLElement): GridStack {\r\n    let node = el.gridstackNode;\r\n    if (!node || node._removeTimeout || !this.opts.removable) return this;\r\n    node._removeTimeout = setTimeout(() => {\r\n      el.classList.add('grid-stack-item-removing');\r\n      node._isAboutToRemove = true;\r\n    }, this.opts.removeTimeout);\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _clearRemovingTimeout(el: GridItemHTMLElement): GridStack {\r\n    let node = el.gridstackNode;\r\n    if (!node || !node._removeTimeout) return this;\r\n    clearTimeout(node._removeTimeout);\r\n    delete node._removeTimeout;\r\n    el.classList.remove('grid-stack-item-removing');\r\n    delete node._isAboutToRemove;\r\n    return this;\r\n  }\r\n\r\n  /** @internal prepares the element for drag&drop **/\r\n  private _prepareDragDropByNode(node: GridStackNode): GridStack {\r\n    // check if init already done or not needed (static/disabled)\r\n    if (node._initDD || this.opts.staticGrid ||\r\n      ((node.noMove || this.opts.disableDrag) && (node.noResize || this.opts.disableResize))) {\r\n      return;\r\n    }\r\n\r\n    // variables used/cashed between the 3 start/move/end methods, in addition to node passed above\r\n    let cellWidth: number;\r\n    let cellHeight: number;\r\n    let el = node.el;\r\n\r\n    /** called when item starts moving/resizing */\r\n    let onStartMoving = (event, ui) => {\r\n      let target: HTMLElement = event.target;\r\n\r\n      // trigger any 'dragstart' / 'resizestart' manually\r\n      if (this._gsEventHandler[event.type]) {\r\n        this._gsEventHandler[event.type](event, target);\r\n      }\r\n\r\n      this.engine.cleanNodes();\r\n      this.engine.beginUpdate(node);\r\n      cellWidth = this.cellWidth();\r\n      cellHeight = this.getCellHeight(true); // force pixels for calculations\r\n\r\n      this.placeholder.setAttribute('data-gs-x', target.getAttribute('data-gs-x'));\r\n      this.placeholder.setAttribute('data-gs-y', target.getAttribute('data-gs-y'));\r\n      this.placeholder.setAttribute('data-gs-width', target.getAttribute('data-gs-width'));\r\n      this.placeholder.setAttribute('data-gs-height', target.getAttribute('data-gs-height'));\r\n      this.el.append(this.placeholder);\r\n\r\n      node.el = this.placeholder;\r\n      node._beforeDragX = node.x;\r\n      node._beforeDragY = node.y;\r\n      node._prevYPix = ui.position.top;\r\n\r\n      this.dd.resizable(el, 'option', 'minWidth', cellWidth * (node.minWidth || 1));\r\n      this.dd.resizable(el, 'option', 'minHeight', cellHeight * (node.minHeight || 1));\r\n    }\r\n\r\n    /** called when item is being dragged/resized */\r\n    let dragOrResize = (event: Event, ui) => {\r\n      let x = Math.round(ui.position.left / cellWidth);\r\n      let y = Math.floor((ui.position.top + cellHeight / 2) / cellHeight);\r\n      let width;\r\n      let height;\r\n\r\n      if (event.type === 'drag') {\r\n        let distance = ui.position.top - node._prevYPix;\r\n        node._prevYPix = ui.position.top;\r\n        Utils.updateScrollPosition(el, ui.position, distance);\r\n        // if inTrash, outside of the bounds or added to another grid (#393) temporarily remove it from us\r\n        if (el.dataset.inTrashZone || x < 0 || x >= this.engine.column || y < 0 || (!this.engine.float && y > this.engine.getRow()) || node._added) {\r\n          if (node._temporaryRemoved) { return; }\r\n          if (this.opts.removable === true) {\r\n            this._setupRemovingTimeout(el);\r\n          }\r\n\r\n          x = node._beforeDragX;\r\n          y = node._beforeDragY;\r\n\r\n          if (this.placeholder.parentNode === this.el) {\r\n            this.placeholder.remove();\r\n          }\r\n          this.engine.removeNode(node);\r\n          this._updateContainerHeight();\r\n\r\n          node._temporaryRemoved = true;\r\n          delete node._added; // no need for this now\r\n        } else {\r\n          this._clearRemovingTimeout(el);\r\n\r\n          if (node._temporaryRemoved) {\r\n            this.engine.addNode(node);\r\n            this._writeAttrs(this.placeholder, x, y, width, height);\r\n            this.el.appendChild(this.placeholder);\r\n            node.el = this.placeholder;\r\n            delete node._temporaryRemoved;\r\n          }\r\n        }\r\n      } else if (event.type === 'resize')  {\r\n        if (x < 0) return;\r\n        width = Math.round(ui.size.width / cellWidth);\r\n        height = Math.round((ui.size.height + this.getMargin()) / cellHeight);\r\n      }\r\n      // width and height are undefined if not resizing\r\n      let _lastTriedWidth = (width || node._lastTriedWidth);\r\n      let _lastTriedHeight = (height || node._lastTriedHeight);\r\n      if (!this.engine.canMoveNode(node, x, y, width, height) ||\r\n        (node._lastTriedX === x && node._lastTriedY === y &&\r\n        node._lastTriedWidth === _lastTriedWidth && node._lastTriedHeight === _lastTriedHeight)) {\r\n        return;\r\n      }\r\n      node._lastTriedX = x;\r\n      node._lastTriedY = y;\r\n      node._lastTriedWidth = width;\r\n      node._lastTriedHeight = height;\r\n      this.engine.moveNode(node, x, y, width, height);\r\n      this._updateContainerHeight();\r\n    }\r\n\r\n    /** called when the item stops moving/resizing */\r\n    let onEndMoving = (event: Event) => {\r\n      if (this.placeholder.parentNode === this.el) {\r\n        this.placeholder.remove();\r\n      }\r\n\r\n      // if the item has moved to another grid, we're done here\r\n      let target: GridItemHTMLElement = event.target as GridItemHTMLElement;\r\n      if (!target.gridstackNode || target.gridstackNode.grid !== this) return;\r\n\r\n      node.el = target;\r\n\r\n      if (node._isAboutToRemove) {\r\n        let gridToNotify = el.gridstackNode.grid;\r\n        if (gridToNotify._gsEventHandler[event.type]) {\r\n          gridToNotify._gsEventHandler[event.type](event, target);\r\n        }\r\n        gridToNotify.engine.removedNodes.push(node);\r\n        gridToNotify.dd.remove(el);\r\n        delete el.gridstackNode; // hint we're removing it next and break circular link\r\n        gridToNotify._triggerRemoveEvent();\r\n        if (el.parentElement) {\r\n          el.remove(); // finally remove it\r\n        }\r\n      } else {\r\n        this._clearRemovingTimeout(el);\r\n        if (!node._temporaryRemoved) {\r\n          Utils.removePositioningStyles(target);\r\n          this._writeAttrs(target, node.x, node.y, node.width, node.height);\r\n        } else {\r\n          Utils.removePositioningStyles(target);\r\n          this._writeAttrs(target, node._beforeDragX, node._beforeDragY, node.width, node.height);\r\n          node.x = node._beforeDragX;\r\n          node.y = node._beforeDragY;\r\n          delete node._temporaryRemoved;\r\n          this.engine.addNode(node);\r\n        }\r\n        if (this._gsEventHandler[event.type]) {\r\n          this._gsEventHandler[event.type](event, target);\r\n        }\r\n      }\r\n\r\n      this._updateContainerHeight();\r\n      this._triggerChangeEvent();\r\n\r\n      this.engine.endUpdate();\r\n\r\n      // if we re-sized a nested grid item, let the children resize as well\r\n      if (event.type === 'resizestop') {\r\n        this._resizeNestedGrids(target);\r\n      }\r\n    }\r\n\r\n    this.dd\r\n      .draggable(el, {\r\n        start: onStartMoving,\r\n        stop: onEndMoving,\r\n        drag: dragOrResize\r\n      })\r\n      .resizable(el, {\r\n        start: onStartMoving,\r\n        stop: onEndMoving,\r\n        resize: dragOrResize\r\n      });\r\n    node._initDD = true; // we've set DD support now\r\n\r\n    if (node.noMove || this.opts.disableDrag || this.opts.staticGrid) {\r\n      this.dd.draggable(el, 'disable');\r\n    }\r\n    if (node.noResize || this.opts.disableResize || this.opts.staticGrid) {\r\n      this.dd.resizable(el, 'disable');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** called to resize children nested grids when we/item resizes */\r\n  private _resizeNestedGrids(target: HTMLElement): GridStack {\r\n    target.querySelectorAll('.grid-stack').forEach((el: GridHTMLElement) => {\r\n      if (el.gridstack) {\r\n        el.gridstack.onParentResize();\r\n      }});\r\n    return this;\r\n  }\r\n\r\n\r\n  /** @internal */\r\n  private _prepareElement(el: GridItemHTMLElement, triggerAddEvent = false): GridStack {\r\n    el.classList.add(this.opts.itemClass);\r\n    let node = this._readAttr(el, { el: el, grid: this });\r\n    node = this.engine.addNode(node, triggerAddEvent);\r\n    el.gridstackNode = node;\r\n    this._writeAttr(el, node);\r\n    this._prepareDragDropByNode(node);\r\n    return this;\r\n  }\r\n\r\n  /** @internal call to write x,y,w,h attributes back to element */\r\n  private _writeAttrs(el: HTMLElement, x?: number, y?: number, width?: number, height?: number): GridStack {\r\n    if (x !== undefined && x !== null) { el.setAttribute('data-gs-x', String(x)); }\r\n    if (y !== undefined && y !== null) { el.setAttribute('data-gs-y', String(y)); }\r\n    if (width) { el.setAttribute('data-gs-width', String(width)); }\r\n    if (height) { el.setAttribute('data-gs-height', String(height)); }\r\n    return this;\r\n  }\r\n\r\n  /** @internal call to write any default attributes back to element */\r\n  private _writeAttr(el: HTMLElement, node: GridStackWidget): GridStack {\r\n    if (!node) return this;\r\n    this._writeAttrs(el, node.x, node.y, node.width, node.height);\r\n\r\n    if (node.autoPosition) {\r\n      el.setAttribute('data-gs-auto-position', 'true');\r\n    } else {\r\n      el.removeAttribute('data-gs-auto-position');\r\n    }\r\n\r\n    if (node.minWidth) { el.setAttribute('data-gs-min-width', String(node.minWidth)); }\r\n    if (node.maxWidth) { el.setAttribute('data-gs-max-width', String(node.maxWidth)); }\r\n    if (node.minHeight) { el.setAttribute('data-gs-min-height', String(node.minHeight)); }\r\n    if (node.maxHeight) { el.setAttribute('data-gs-max-height', String(node.maxHeight)); }\r\n    if (node.noResize) {\r\n      el.setAttribute('data-gs-no-resize', 'true');\r\n    } else {\r\n      el.removeAttribute('data-gs-no-resize');\r\n    }\r\n\r\n    if (node.noMove) {\r\n      el.setAttribute('data-gs-no-move', 'true');\r\n    } else {\r\n      el.removeAttribute('data-gs-no-move');\r\n    }\r\n\r\n    if (node.locked) {\r\n      el.setAttribute('data-gs-locked', 'true');\r\n    } else {\r\n      el.removeAttribute('data-gs-locked');\r\n    }\r\n\r\n    if (node.resizeHandles) { el.setAttribute('data-gs-resize-handles', node.resizeHandles); }\r\n    if (node.id) { el.setAttribute('data-gs-id', String(node.id)); }\r\n    return this;\r\n  }\r\n\r\n  /** @internal call to read any default attributes from element */\r\n  private _readAttr(el: HTMLElement, node: GridStackNode = {}): GridStackWidget {\r\n    node.x = Utils.toNumber(el.getAttribute('data-gs-x'));\r\n    node.y = Utils.toNumber(el.getAttribute('data-gs-y'));\r\n    node.width = Utils.toNumber(el.getAttribute('data-gs-width'));\r\n    node.height = Utils.toNumber(el.getAttribute('data-gs-height'));\r\n    node.maxWidth = Utils.toNumber(el.getAttribute('data-gs-max-width'));\r\n    node.minWidth = Utils.toNumber(el.getAttribute('data-gs-min-width'));\r\n    node.maxHeight = Utils.toNumber(el.getAttribute('data-gs-max-height'));\r\n    node.minHeight = Utils.toNumber(el.getAttribute('data-gs-min-height'));\r\n    node.autoPosition = Utils.toBool(el.getAttribute('data-gs-auto-position'));\r\n    node.noResize = Utils.toBool(el.getAttribute('data-gs-no-resize'));\r\n    node.noMove = Utils.toBool(el.getAttribute('data-gs-no-move'));\r\n    node.locked = Utils.toBool(el.getAttribute('data-gs-locked'));\r\n    node.resizeHandles = el.getAttribute('data-gs-resize-handles');\r\n    node.id = el.getAttribute('data-gs-id');\r\n\r\n    return node;\r\n  }\r\n\r\n  /** @internal */\r\n  private _updateElement(els: GridStackElement, callback: (el: GridItemHTMLElement, node: GridStackNode) => void): GridStack {\r\n    let el = GridStack.getElement(els);\r\n    if (!el) { return this; }\r\n    let node = el.gridstackNode;\r\n    if (!node) { return this; }\r\n\r\n    this.engine.cleanNodes();\r\n    this.engine.beginUpdate(node);\r\n\r\n    callback.call(this, el, node);\r\n\r\n    this._updateContainerHeight();\r\n    this._triggerChangeEvent();\r\n\r\n    this.engine.endUpdate();\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  private _setStaticClass(): GridStack {\r\n    let staticClassName = 'grid-stack-static';\r\n\r\n    if (this.opts.staticGrid) {\r\n      this.el.classList.add(staticClassName);\r\n    } else {\r\n      this.el.classList.remove(staticClassName);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * called when we are being resized by the window - check if the one Column Mode needs to be turned on/off\r\n   * and remember the prev columns we used, as well as check for auto cell height (square)\r\n   */\r\n  public onParentResize(): GridStack {\r\n    // make the cells content (minus margin) square again\r\n    if (this._isAutoCellHeight) {\r\n      Utils.throttle(() => {\r\n        let marginDiff = - (this.opts.marginRight as number) - (this.opts.marginLeft as number)\r\n          + (this.opts.marginTop as number) + (this.opts.marginBottom as number);\r\n        this.cellHeight(this.cellWidth() + marginDiff);\r\n      }, 100);\r\n    }\r\n\r\n    if (!this.opts.disableOneColumnMode && this.el.clientWidth <= this.opts.minWidth) {\r\n      if (this._oneColumnMode) { return this }\r\n      this._oneColumnMode = true;\r\n      this.column(1);\r\n      this._resizeNestedGrids(this.el);\r\n    } else {\r\n      if (!this._oneColumnMode) { return this }\r\n      delete this._oneColumnMode;\r\n      this.column(this._prevColumn);\r\n      this._resizeNestedGrids(this.el);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /** add or remove the window size event handler */\r\n  private _updateWindowResizeEvent(forceRemove = false): GridStack {\r\n    const workTodo = (this._isAutoCellHeight || !this.opts.disableOneColumnMode);\r\n\r\n    // only add event if we're not nested (parent will call us) and we're auto sizing cells or supporting oneColumn (i.e. doing work)\r\n    if (workTodo && !forceRemove && !this.opts._isNested && !this._windowResizeBind) {\r\n      this._windowResizeBind = this.onParentResize.bind(this); // so we can properly remove later\r\n      window.addEventListener('resize', this._windowResizeBind);\r\n    } else if ((forceRemove || !workTodo) && this._windowResizeBind) {\r\n      window.removeEventListener('resize', this._windowResizeBind);\r\n      delete this._windowResizeBind; // remove link to us so we can free\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /** @internal call to setup dragging in from the outside (say toolbar), with options */\r\n  private _setupDragIn():  GridStack {\r\n    if (!this.opts.staticGrid && typeof this.opts.dragIn === 'string') {\r\n      if (!this.dd.isDraggable(this.opts.dragIn)) {\r\n        this.dd.dragIn(this.opts.dragIn, this.opts.dragInOptions);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** @internal called to setup a trash drop zone if the user specifies it */\r\n  private _setupRemoveDrop(): GridStack {\r\n    if (!this.opts.staticGrid && typeof this.opts.removable === 'string') {\r\n      let trashZone = document.querySelector(this.opts.removable) as HTMLElement;\r\n      if (!trashZone) return this;\r\n      if (!this.dd.isDroppable(trashZone)) {\r\n        this.dd.droppable(trashZone, this.opts.removableOptions);\r\n      }\r\n      this.dd\r\n        .on(trashZone, 'dropover', (event, el) => {\r\n          let node = el.gridstackNode;\r\n          if (!node || node.grid !== this) return;\r\n          el.dataset.inTrashZone = 'true';\r\n          this._setupRemovingTimeout(el);\r\n        })\r\n        .on(trashZone, 'dropout', (event, el) => {\r\n          let node = el.gridstackNode;\r\n          if (!node || node.grid !== this) return;\r\n          delete el.dataset.inTrashZone;\r\n          this._clearRemovingTimeout(el);\r\n        });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** @internal called to add drag over support to support widgets */\r\n  private _setupAcceptWidget(): GridStack {\r\n    if (this.opts.staticGrid || !this.opts.acceptWidgets) return this;\r\n\r\n    let onDrag = (event, el: GridItemHTMLElement) => {\r\n      let node = el.gridstackNode;\r\n      let pos = this.getCellFromPixel({left: event.pageX, top: event.pageY}, true);\r\n      let x = Math.max(0, pos.x);\r\n      let y = Math.max(0, pos.y);\r\n      if (!node._added) {\r\n        node._added = true;\r\n\r\n        node.el = el;\r\n        node.x = x;\r\n        node.y = y;\r\n        delete node.autoPosition;\r\n        this.engine.cleanNodes();\r\n        this.engine.beginUpdate(node);\r\n        this.engine.addNode(node);\r\n\r\n        this._writeAttrs(this.placeholder, node.x, node.y, node.width, node.height);\r\n        this.el.appendChild(this.placeholder);\r\n        node.el = this.placeholder; // dom we update while dragging...\r\n        node._beforeDragX = node.x;\r\n        node._beforeDragY = node.y;\r\n\r\n        this._updateContainerHeight();\r\n      } else if ((x !== node.x || y !== node.y) && this.engine.canMoveNode(node, x, y)) {\r\n        this.engine.moveNode(node, x, y);\r\n        this._updateContainerHeight();\r\n      }\r\n    };\r\n\r\n    this.dd\r\n      .droppable(this.el, {\r\n        accept: (el: GridItemHTMLElement) => {\r\n          let node: GridStackNode = el.gridstackNode;\r\n          if (node && node.grid === this) {\r\n            return false;\r\n          }\r\n          if (typeof this.opts.acceptWidgets === 'function') {\r\n            return this.opts.acceptWidgets(el);\r\n          }\r\n          let selector = (this.opts.acceptWidgets === true ? '.grid-stack-item' : this.opts.acceptWidgets as string);\r\n          return el.matches(selector);\r\n        }\r\n      })\r\n      .on(this.el, 'dropover', (event, el: GridItemHTMLElement) => {\r\n\r\n        // see if we already have a node with widget/height and check for attributes\r\n        let node = el.gridstackNode || {};\r\n        if (!node.width || !node.height) {\r\n          let w = parseInt(el.getAttribute('data-gs-width'));\r\n          if (w > 0) { node.width = w; }\r\n          let h = parseInt(el.getAttribute('data-gs-height'));\r\n          if (h > 0) { node.height = h; }\r\n        }\r\n\r\n        // if the item came from another grid, let it know it was added here to removed duplicate shadow #393\r\n        if (node.grid && node.grid !== this) {\r\n          node._added = true;\r\n        }\r\n\r\n        // if not calculate the grid size based on element outer size\r\n        let width = node.width || Math.round(el.offsetWidth / this.cellWidth()) || 1;\r\n        let height = node.height || Math.round(el.offsetHeight / this.getCellHeight(true)) || 1;\r\n\r\n        // copy the node original values (min/max/id/etc...) but override width/height/other flags which are this grid specific\r\n        let newNode = this.engine.prepareNode({...node, ...{width, height, _added: false, _temporary: true}});\r\n        newNode._isOutOfGrid = true;\r\n        el.gridstackNode = newNode;\r\n        el._gridstackNodeOrig = node;\r\n\r\n        this.dd.on(el, 'drag', onDrag);\r\n        return false; // prevent parent from receiving msg (which may be grid as well)\r\n      })\r\n      .on(this.el, 'dropout', (event, el: GridItemHTMLElement) => {\r\n        // jquery-ui bug. Must verify widget is being dropped out\r\n        // check node variable that gets set when widget is out of grid\r\n        let node = el.gridstackNode;\r\n        if (!node || !node._isOutOfGrid) {\r\n          return;\r\n        }\r\n        this.dd.off(el, 'drag');\r\n        node.el = null;\r\n        this.engine.removeNode(node);\r\n        if (this.placeholder.parentNode === this.el) {\r\n          this.placeholder.remove();\r\n        }\r\n        this._updateContainerHeight();\r\n        el.gridstackNode = el._gridstackNodeOrig;\r\n        return false; // prevent parent from receiving msg (which may be grid as well)\r\n      })\r\n      .on(this.el, 'drop', (event, el: GridItemHTMLElement, helper: GridItemHTMLElement) => {\r\n        this.placeholder.remove();\r\n\r\n        // notify previous grid of removal\r\n        let origNode = el._gridstackNodeOrig;\r\n        delete el._gridstackNodeOrig;\r\n        if (origNode && origNode.grid && origNode.grid !== this) {\r\n          let oGrid = origNode.grid;\r\n          oGrid.placeholder.remove();\r\n          origNode.el = el; // was using placeholder, have it point to node we've moved instead\r\n          oGrid.engine.removedNodes.push(origNode);\r\n          oGrid._triggerRemoveEvent();\r\n        }\r\n\r\n        let node = el.gridstackNode; // use existing placeholder node as it's already in our list with drop location\r\n        const _id = node._id;\r\n        this.engine.cleanupNode(node); // removes all internal _xyz values (including the _id so add that back)\r\n        node._id = _id;\r\n        node.grid = this;\r\n        this.dd.off(el, 'drag');\r\n        // if we made a copy ('helper' which is temp) of the original node then insert a copy, else we move the original node (#1102)\r\n        // as the helper will be nuked by jqueryui otherwise\r\n        if (helper !== el) {\r\n          helper.remove();\r\n          el.gridstackNode = origNode; // original item (left behind) is re-stored to pre dragging as the node now has drop info\r\n          el = el.cloneNode(true) as GridItemHTMLElement;\r\n        } else {\r\n          el.remove(); // reduce flicker as we change depth here, and size further down\r\n          this.dd.remove(el);\r\n        }\r\n        el.gridstackNode = node;\r\n        node.el = el;\r\n\r\n        Utils.removePositioningStyles(el);\r\n        this._writeAttr(el, node);\r\n        this.el.appendChild(el);\r\n        this._updateContainerHeight();\r\n        this.engine.addedNodes.push(node);\r\n        this._triggerAddEvent();\r\n        this._triggerChangeEvent();\r\n\r\n        this.engine.endUpdate();\r\n        if (this._gsEventHandler['dropped']) {\r\n          this._gsEventHandler['dropped']({type: 'dropped'}, origNode && origNode.grid ? origNode : undefined, node);\r\n        }\r\n\r\n        // wait till we return out of the drag callback to set the new drag&resize handler or they may get messed up\r\n        // IFF we are still there (some application will use as placeholder and insert their real widget instead)\r\n        window.setTimeout(() => {\r\n          if (node.el && node.el.parentElement) this._prepareDragDropByNode(node);\r\n        });\r\n\r\n        return false; // prevent parent from receiving msg (which may be grid as well)\r\n      });\r\n    return this;\r\n  }\r\n\r\n  /** @internal convert a potential selector into actual element */\r\n  private static getElement(els: GridStackElement = '.grid-stack-item'): GridItemHTMLElement {\r\n    if (typeof els === 'string') {\r\n      let el = document.querySelector(els);\r\n      if (!el && els[0] !== '.' && els[0] !== '#') {\r\n        el = document.querySelector('#' + els);\r\n        if (!el) { el = document.querySelector('.' + els) }\r\n      }\r\n      return el as GridItemHTMLElement;\r\n    }\r\n    return els;\r\n  }\r\n\r\n  /** @internal convert a potential selector into actual list of elements */\r\n  private static getElements(els: GridStackElement = '.grid-stack-item'): GridItemHTMLElement[] {\r\n    if (typeof els === 'string') {\r\n      let list = document.querySelectorAll(els);\r\n      if (!list.length && els[0] !== '.' && els[0] !== '#') {\r\n        list = document.querySelectorAll('.' + els);\r\n        if (!list.length) { list = document.querySelectorAll('#' + els) }\r\n      }\r\n      return Array.from(list) as GridItemHTMLElement[];\r\n    }\r\n    return [els];\r\n  }\r\n  /** @internal */\r\n  private static getGridElement(els: string | HTMLElement = '.grid-stack'): GridHTMLElement {\r\n    return GridStack.getElement(els) as GridHTMLElement;\r\n  }\r\n  /** @internal */\r\n  private static getGridElements(els: string | HTMLElement = '.grid-stack'): GridHTMLElement[] {\r\n    return GridStack.getElements(els) as GridHTMLElement[];\r\n  }\r\n\r\n  /** @internal initialize margin top/bottom/left/right and units */\r\n  private initMargin(): GridStack {\r\n    let data = Utils.parseHeight(this.opts.margin);\r\n    this.opts.marginUnit = data.unit;\r\n    let margin = this.opts.margin = data.height;\r\n\r\n    // see if top/bottom/left/right need to be set as well\r\n    if (this.opts.marginTop === undefined) {\r\n      this.opts.marginTop = margin;\r\n    } else {\r\n      data = Utils.parseHeight(this.opts.marginTop);\r\n      this.opts.marginTop = data.height;\r\n      delete this.opts.margin;\r\n    }\r\n\r\n    if (this.opts.marginBottom === undefined) {\r\n      this.opts.marginBottom = margin;\r\n    } else {\r\n      data = Utils.parseHeight(this.opts.marginBottom);\r\n      this.opts.marginBottom = data.height;\r\n      delete this.opts.margin;\r\n    }\r\n\r\n    if (this.opts.marginRight === undefined) {\r\n      this.opts.marginRight = margin;\r\n    } else {\r\n      data = Utils.parseHeight(this.opts.marginRight);\r\n      this.opts.marginRight = data.height;\r\n      delete this.opts.margin;\r\n    }\r\n\r\n    if (this.opts.marginLeft === undefined) {\r\n      this.opts.marginLeft = margin;\r\n    } else {\r\n      data = Utils.parseHeight(this.opts.marginLeft);\r\n      this.opts.marginLeft = data.height;\r\n      delete this.opts.margin;\r\n    }\r\n    this.opts.marginUnit = data.unit; // in case side were spelled out, use those units instead...\r\n    return this;\r\n  }\r\n\r\n  /** @internal called to update an element(s) attributes and node values */\r\n  private _updateAttr(els: GridStackElement, val: number, attr: string, field: string): GridStack {\r\n    GridStack.getElements(els).forEach(el => {\r\n      if (val) {\r\n        el.setAttribute(attr, String(val));\r\n      } else {\r\n        el.removeAttribute(attr);\r\n      }\r\n      if (el.gridstackNode) {\r\n        el.gridstackNode[field] = (val || undefined);\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  // legacy method renames\r\n  /** @internal */\r\n  private setGridWidth = obsolete(this, GridStack.prototype.column, 'setGridWidth', 'column', 'v0.5.3');\r\n  /** @internal */\r\n  private setColumn = obsolete(this, GridStack.prototype.column, 'setColumn', 'column', 'v0.6.4');\r\n  /** @internal */\r\n  private getGridHeight =  obsolete(this, GridStackEngine.prototype.getRow, 'getGridHeight', 'getRow', 'v1.0.0');\r\n}\r\n"],"sourceRoot":""}